{"version":3,"sources":["fluent/Localized.js","functions.js","graphql/queries.js","hooks/useUser.js","components/PopoverMenu.js","graphql/mutations.js","markdown.js","hooks/useSaveBlock.js","components/DataTransmat.js","components/view/ViewerTextCard.js","components/view/ViewerButtonCard.js","components/view/ViewerDividerLine.js","components/view/ViewerCheckboxCard.js","components/view/ViewerLine.js","hooks/useBlockTrigger.js","components/view/ViewerAuto.js","hooks/useLoadBlocks.js","hooks/useMutation.js","components/Popover.js","components/edit/AddMenu.js","components/Header.js","components/edit/LocaleSelect.js","hooks/useArchiveBlock.js","components/SubMenu.js","components/edit/BlockMenu.js","fluent/fluentBy.js","hooks/useLoadBlock.js","hooks/useBlockMatchesRoles.js","components/ErrorPages.js","components/Header.module.css","components/DataTransmat.module.css","components/view/ViewerLine.module.css","components/view/ViewerAuto.module.css","pages/Editor.module.css","components/apps/PageEditor.module.css","components/edit/SharingEditor.module.css","components/edit/HtmlInput.module.css","components/edit/TranslationEditor.module.css","components/edit/InputWithLocal.module.css","components/Repeater.module.css","components/edit/FancyInput.module.css","components/edit/PermissionsEditor.module.css","components/edit/PropertiesEditor.module.css","components/edit/CoverphotoPicker.module.css","components/edit/IconPicker.module.css","components/edit/InlineEditorBlock.module.css","components/edit/ContentEditor.module.css","components/edit/HtmlInput.js","components/edit/SharingEditor.js","components/edit/InputWithLocal.js","components/Repeater.js","components/edit/TranslationEditor.js","components/edit/FancyInput.js","components/edit/EmailInput.js","components/edit/PermissionsEditor.js","components/edit/CheckboxInput.js","components/MultiButton.js","components/edit/UrlInput.js","images/coverphotos/thumbs/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.png","images/coverphotos/thumbs/Aktion.png","images/coverphotos/thumbs/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.png","images/coverphotos/thumbs/Welcome-to-Volt.png","images/coverphotos/thumbs/portugal.jpg","components/edit/CoverphotoPicker.js","components/edit/IconPicker.js","components/edit/PathInput.js","hooks/useCheckPath.js","components/edit/TriggerInput.js","components/edit/ActionInput.js","components/edit/PropertiesEditor.js","components/edit/InlineEditorBlockText.js","components/edit/InlineEditorBlockButton.js","components/edit/InlineEditorBlockRedirect.js","components/edit/InlineEditorBlockDivider.js","components/edit/InlineEditorBlockCheckbox.js","components/edit/InlineEditorBlockPerson.js","components/edit/InlineEditorBlockPage.js","components/edit/InlineEditorBlock.js","components/edit/ContentEditor.js","components/apps/PageEditor.js","pages/Editor.js"],"names":["Localized","props","elems","br","Fragment","children","id","withLocalization","Inner","l10n","React","useContext","FluentContext","createElement","fluentByObject","object","fallback","globalSupportedLocales","supportedLocales","thisSupportedLocales","Object","keys","filter","locale","includes","currentLocales","negotiateLanguages","userLocales","defaultLocale","getString","args","translateBlock","block","properties","text","Array","isArray","translations","correct_translations","fluentBy","fluentByArray","length","useLocalization","fluentByAny","any","hexToRGBArray","color","startsWith","substring","charAt","Error","rgb","i","parseInt","substr","getContrastingColor","luma","colorToHex","rgba","cvs","ctx","document","height","width","getContext","fillStyle","fillRect","getImageData","data","colorToRGBA","map","idx","toString","slice","join","module","exports","getImageUrl","imageObj","type","url","getBlockColor","colors","colorRGB","contrastingColor","contrastingColorRGB","hasOwnProperty","newColor","parsedColor","getBlock_Query","gql","getBlocks_Query","getSelf_Query","getParentBlocks_Query","blockMatchesRoles_Query","checkPath_Query","defaultUser","userroles","useUser","forceRefetch","mountedRef","useRef","useEffect","current","useState","user","setUser","loggedIn","setLoggedIn","apollo_client","useApolloClient","window","logged_in","query","then","a","self","catch","error","console","PopoverMenu","trigger","onToogle","paperProps","closePopover","open","popoverProps","sx","paperPropsRest","maxWidth","maxHeight","overflow","background","elevation","autoFocus","style","marginTop","isOpen","close","opacity","marginBottom","className","onClick","saveBlock_Mutation","saveProperty_Mutation","archiveBlock_Mutation","unarchiveBlock_Mutation","moveBlock_Mutation","getMD","options","md","mdit","html","xhtmlOut","linkify","typographer","breaks","use","kbd","emoji","renderInlineMarkdown","replace","renderInline","twemoji","parse","folder","ext","base","removeProperty","obj","prop","JSON","stringify","useSaveBlock","useSnackbar","enqueueSnackbar","closeSnackbar","handleSaveBlock","useCallback","initialBlock","Promise","final_resolve","snackbarKey","newBlock","content","contentConfig","blockId","loadingDataPromise","resolve","mutate","mutation","variables","variant","preventDuplicate","autoHideDuration","_id","saveBlock","message","race","setTimeout","response","persist","getTransmatOptions","transmat","mimetypes","mimetype","hasType","getData","DataBothWays","onTransmit","onReceive","checkEntry","draggable","bothwayRef","unlistenTransmit","addListeners","event","Transmat","setData","unlistenReceive","isOkay","accept","preventDefault","obs","TransmatObserver","entries","entry","target","classList","toggle","classes","drag_over","isTarget","drag_active","isActive","observe","disconnect","ref","tabIndex","ViewerTextCard","locales","__html","setHtml","textWithHtml","defaultProps","dir","whiteSpace","text_style","component","dangerouslySetInnerHTML","ViewerButtonCard","actions","action","colorStyles","hasClickAction","href","rel","margin","click","disabled","ViewerDividerLine","styles","ViewerCheckboxCard","checked","Boolean","checkboxStyle","verticalAlign","paddingInlineEnd","CheckBox","CheckBoxOutlineBlank","ViewerLine","link","setLink","path","setPath","newLink","newPath","triggerProperties","triggerType","actionProperties","actionType","domains","frontend","useBlockTrigger","title","cron","isSquareIcon","icon_url","icon","coverphoto","iconComponent","square","round","backgroundImage","backend","imageFormat","encodeURIComponent","alt","cardOnClick","cardLink","root","display","cursor","alignItems","to","onClickProps","ViewerAuto","size","dragable","getPressedKeys","pressedKeysRef","Set","onKeyDown","key","toLowerCase","add","onKeyUp","delete","addEventListener","removeEventListener","usePressedKeys","mutationFunction","useMutation","json","movingBlock","block_roles","computed","roles","movingBlock_roles","pressedKeys","everything_updated","movingBlockId","newParentId","newIndex","has","value","log","handleCheckEntry","this_roles","useLoadBlocks","handleLoadBlocks","errors","blocks","option","reject","Popover","setOpenBlockMenuRef","anchorRef","setOpen","setOpenExternal","newOpen","Math","random","undefined","prevOpen","pointerEvents","position","top","right","bottom","left","zIndex","anchorEl","transition","placement","disablePortal","modifiers","name","enabled","altBoundary","rootBoundary","padding","TransitionProps","transformOrigin","blockTypeIcons","button","code","divider","checkbox","page","person","redirect","default_types","AddMenuContent","createBlock","types","AddMenu","Header","rightActions","notificationBanner","useSidebarContext","toggleSidebar","parentId","parent","parentBlocks","setParentBlocks","siblingBlocks","setSiblingBlocks","loadParentBlocks","parentBlocksSorted","sort","b","loadSiblingBlocks","roots","archived","leftActions","flexGrow","triggerProps","fontWeight","header","headerBar","_","en","de","es","pt","fr","it","nl","da","sv","nb","fi","mt","pl","ru","bg","tr","ar","el","ro","sl","localesArray","nativeName","defaultOptions","LocaleSelect","defaultValue","onChange","changedLocale","setChangedLocale","handleLocaleChange","newLocale","flexShrink","textAlign","mdiTranslate","toUpperCase","marginLeft","lineHeight","selected","useArchiveBlock","archive","SubMenu","parentMenuIsOpen","label","MenuListProps","onOpen","triggerRef","isSubMenuOpen","setIsSubMenuOpen","toggleSubmenu","closeSubmenu","MenuItem","justifyContent","ArrowRight","marginRight","Menu","anchorOrigin","vertical","horizontal","disableAutoFocus","disableEnforceFocus","onClose","ListSubheader","backgroundColor","Divider","ListItemIcon","Close","typeIcons","defaultTypeOptions","colorOptions","default","yellow","green","red","blue","colorOptionsKeys","getColor","renderedColor","setProperty","setType","typeOptions","onRemoveRow","addRowBefore","onArchivedToggle","onReloadContext","active","canEdit","setArchived","archiveBlock","navigate","useNavigate","createChildBlock","newBlockId","toggleArchiveBlock","newArchived","toggleActive","metadata","typeName","thisColor","placeholder","onBlur","e","thisStyle","Add","VisibilityOff","Visibility","ListItemText","primary","secondary","Unarchive","Archive","Link","ListItem","paddingTop","paddingBottom","modified","require","lookupedLocale","strategy","array","item","result","useLoadBlock","handleLoadBlock","loadedBlock","useBlockMatchesRoles","handleLoadRoles","blockMatchesRoles","ErrorPage","errorName","description","buttons","location","getInLineRangeLength","element","whichLine","normalize","getSelection","selection","range","rangeCount","getRangeAt","clonedRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","cloneContents","rangeLength","childNodes","nodeType","detach","getCaretPosition","cs","getComputedStyle","paddingY","parseFloat","borderY","borderTopWidth","borderBottomWidth","elementHeight","offsetHeight","offset","getOffset","caretOffset","getCaretOffset","inFirstLine","inLastLine","caretPositionFromStart","node","textContent","nodeName","getRangeLengthWithLinebreaks","textLength","innerText","caretPositionFromEnd","positionFromLineStart","positionFromStart","positionFromEnd","HtmlInput","linebreaks","onError","onInputRef","onGoToPrevInput","onGoToNextInput","onSplitText","onMergeToPrevInput","onMergeFromNextInput","inputRef","textRef","textRefValue","fakeDefaultValue","setFakeDefaultValue","updateText","newHtmlValue","temporalDivElement","innerHTML","stripHtml","handleTextChange","trim","handleTextBlur","keyDownHandler","shiftKey","execCommand","caret","start","end","texts","handlePaste","originalEvent","clipboardData","onInput","onPaste","rebuild_textarea","show_placeholder","contentEditable","copyTextToClipboard","navigator","clipboard","writeText","info","err","textArea","body","appendChild","focus","select","msg","removeChild","fallbackCopyTextToClipboard","SharingEditor","defaultBlock","initialPath","savePath","newProperties","Modal","hideBackdrop","backdrop","dialog","inputWrapper","paddingRight","linebreak","input","marginInlineStart","marginInlineEnd","InputWithLocal","reorderHandle","actionButton","dataset","changedText","setChangedText","handleBlur","changes","event_or_text","input_with_local","Row","subDefaultValue","index","render","handleRowChange","isReorderable","handleAddRow","handleRemoveRow","showReorderControls","reorderLabel","showActionButton","hasOnlyOneRow","addRowByIndex","draggableId","tmp_id","isDragDisabled","disableInteractiveElementBlocking","shouldRespectForcePress","provided","innerRef","draggableProps","row","form","inlineRowButton","dragHandleButton","dragHandleProps","newValue","addRowAfter","getIndex","eventOrIndex","isNaN","Repeater","addDefaultValue","addButtonText","hideAddButton","prependNewItems","rows","setRows","internalAddDefaultValue","tmp_defaultValue","uuidv4","new_rows","splice","rows_from_onChange","addButton","addRowButton","onDragEnd","destination","source","list","startIndex","endIndex","from","removed","reorder","droppableId","isDropDisabled","droppableProps","SimpleTranslationRepeater","onSaveProperty","isFirst","onRepeaterChange","newTranslations","translation","onBlockLocaleChange","block2display","gap","minHeight","repeater_props","other_repeater_props","InputWithLocal_props","TranslationEditor","setBlocks","loadBlocks","ids2load","loadedBlocks","ids","contentBlocks","find","loadContentBlocks","newBlocks","onSaveChildProperty","gottenBlock","blockIndex","findIndex","flatMap","attr","FancyInput","setError","split","email_regex","emails_regex","EmailInput","multiple","isSubmittable","emails","match","LocalizedRole","role","RolesMenu","changeRole","removePermission","setAnchorEl","handleClose","currentTarget","Edit","Delete","sortPermissions","permissions","owner","p","email","localeCompare","special","other","PermissionsEditor","defaultPermissions","user_data","user_email","inputRepaintKey","setInputRepaintKey","setPermissions","newEmails","setNewEmails","newRole","setNewRole","setNewPermission","newPermissions","obj_new","permission","unshift","blockPermissions","addPermissions","push","newEmail","addNewPermissionFromInput","oldInputRepaintKey","doesNotHaveVoltEuropa","doesNotHavePublic","menuButton","KeyboardArrowDown","permissionRow","ownerInfo","CheckboxInput","setChecked","publishChanges","checkBlock","uncheckBlock","MultiButton","ariaLabel","items","choosen","setChoosen","handleClick","url_regex","is_email_not_url_regex","UrlInput","setText","schema_parts","schema","shift","after_schema","coverphotoValue","iconValue","onUrlChange","newUrl","isAbsoluteUrlRegexp","RegExp","coverphotoValueUrl","coverphotoIsSet","iconIsSet","test","coverphotoIsNotSet","iconIsNotSet","button_wrapper","changeCoverphotoButton","Paper","volt_bonn_thumb","welcome_to_volt_thumb","plakatschlange_thumb","portugal_thumb","aktion_thumb","src","iconValueUrl","iconWrapper","no_image","changeIconButton","PathInput","onSubmit","allowExisting","checkPath","handleCheckPath","useCheckPath","newText","TriggerInput","setProperties","updateProperty","propertyKey","newPropertyValue","propertyTypes","morePropsInput","minWidth","flexDirection","flexWrap","ActionInput","defaultProperties","silent","imprint","privacy_policy","tags","pronouns","publishProperties","propertiesFrameContent","properties_row","main_headline","paddingLeft","propertiesFrame","InlineEditorBlockText","onSaveBlock","onAddRowAfter","publishTextChange","text_style_class","InlineEditorBlockButton","InlineEditorBlockRedirect","triggerPathRef","triggerPath","setTriggerPath","linkRef","paddingInlineStart","InlineEditorBlockDivider","InlineEditorBlockCheckbox","saveChecked","InlineEditorBlockPerson","InlineEditorBlockPage","InlineEditorBlockInbetweenComponent","InlineEditorBlock","onRemoveSelf","setBlock","saveBlockCallback","changeType","saveProperty","propertyName","handleBlockChange","callback","onArchiveToggle","newArchivedValue","BlockMenu","block_input","form_active","form_deactivated","addTmpIds","getFirstLineStartNode","getLastLineStartNode","reverse","lastLineNode","childNode","thisChildNodes","moveCursorToOffsetInLine","contentEditableElement","lastLineStartNode","lastLineStartNodeLength","createRange","setStart","collapse","sel","removeAllRanges","addRange","ContentEditor","contentConfigs_Ref","contentConfigs","inputRefs_Ref","inputRefs","updateCounter","setUpdateCounter","setAutoFocus","firstLineStartNode","newContentConfigs","old","loadMissingBlocks","saveInputRef","newInputRefs","goToPrevInput","prevInputRef","thisIndex","goToNextInput","nextInputRef","focusLastLine","lastInputRef","newContentConfig","oldContentConfig","createBlockByType","clonedContentConfigs","prev_index","prev_contentConfig","prev_tmp_id","this_block","prev_block","new_prev_block","savedPrevBlock","new_tmp_id","next_index","this_old_contentConfig","next_block","new_block","savedBlock","splitText","firstBlock","secondBlock","savedFirstBlock","savedSecondBlock","nextContentConfig","handleRemoveSelf","filteredContentConfigs","boxShadow","Tooltip","PageEditor","isSharingEditorOpen","setIsSharingEditorOpen","openSharingEditor","closeSharingEditor","isTranslationEditorOpen","setIsTranslationEditorOpen","openTranslationEditor","closeTranslationEditor","isPermissionsEditorOpen","setIsPermissionsEditorOpen","openPermissionsEditor","closePermissionsEditor","saveType","newType","saveProperties","saveContent","newContent","savePermissions","manuallySaveEverything","PermissionsIcon","mdiLockAlert","inherited_block_permissions","inherited_block_permissions_obj","reduce","acc","curr","mdiEarth","mdiAccountLockOpen","rightHeaderActions","editor","Helmet","Editor","loadBlock","loadedTheBlock","useParams","setBlockInternal","setCanEdit","matchesRoles","app","spine_aligned","contentWrapper"],"mappings":"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","file":"static/js/7.91ac69ae.chunk.js","sourcesContent":["import React from 'react'\nimport {\n  Localized as LocalizedOriginal,\n  // withLocalization,\n} from '@fluent/react'\nimport { negotiateLanguages } from '@fluent/langneg'\n\nimport { FluentContext } from '../../node_modules/@fluent/react/esm/context.js'\nimport fluentBy from './fluentBy.js'\n\nconst Localized = props => (\n  <LocalizedOriginal\n    key={props.id}\n    {...props}\n    elems={{\n      br: <br />,\n      ...props.elems,\n    }}\n  >\n    <React.Fragment>{props.children}</React.Fragment>\n  </LocalizedOriginal>\n)\n\n// A custom withLocalization to have an empty fallback.\n// It is nearly identical to the original.\nfunction withLocalization(Inner) {\n  function WithLocalization(props) {\n    const l10n = React.useContext(FluentContext)\n\n    const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n\n    const fluentByObject = (object, fallback) => {\n      if (!(!!fallback)) {\n        fallback = null\n      }\n\n      if (!!object) {\n        const globalSupportedLocales = l10n.supportedLocales || []\n        const thisSupportedLocales = Object.keys(object).filter(locale => globalSupportedLocales.includes(locale))\n\n        const currentLocales = negotiateLanguages(\n          l10n.userLocales,\n          thisSupportedLocales,\n          { defaultLocale: l10n.defaultLocale }\n        )\n\n        for (const locale of currentLocales) {\n          if (!!object[locale]) {\n            return object[locale]\n          }\n        }\n\n        return fallback\n      }\n\n      return fallback\n    }\n\n    return React.createElement(Inner, { fluentByObject, getString, ...props })\n  }\n  return WithLocalization\n}\n\n\nfunction translateBlock (block, userLocales, fallback) {\n  const {\n    properties = {}\n  } = block || {}\n  \n  let locale = properties.locale || 'en'\n  let text = properties.text || fallback || ''\n\n  if (!userLocales || !Array.isArray(userLocales)) {\n    userLocales = [locale]\n  }\n    \n  let translations = properties.translations || []\n  if (Array.isArray(translations)) {\n    translations = [\n      {\n        locale,\n        text,\n      },\n      ...translations,\n    ]\n\n    const correct_translations = fluentBy.fluentByArray(translations, userLocales, 'locale')\n    if (correct_translations.length > 0) {\n      text = correct_translations[0].text\n    }\n  }\n\n  return text\n}\n\nfunction useLocalization() {\n  const l10n = React.useContext(FluentContext)\n\n  const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n  const fluentByAny = (any = [], fallback = '') => fluentBy.fluentByAny(any, l10n.userLocales, fallback)\n\n  return {\n    ...l10n,\n    getString,\n    fluentByAny,\n    translateBlock,\n  }\n}\n\nexport {\n  negotiateLanguages,\n  withLocalization,\n  Localized,\n  Localized as default,\n  useLocalization,\n}\n\n/*\n\nimport { Localized, withLocalization } from '../Localized/'\n\n<Localized id=\"translation_id\" />\nexport default withLocalization(componentName)\n\n\nimport Localized from '../Localized/'\n<Localized id=\"translation_id\" />\n\nimport { withLocalization } from '@fluent/react'\nexport default withLocalization(componentName)\n\n*/\n","function getImageUrl(imageObj) {\n  if (\n    typeof imageObj === 'object'\n    && imageObj !== null\n    && !Array.isArray(imageObj)\n  ) {\n    if (imageObj.type === 'url') {\n      return imageObj.url || ''\n    }\n  }\n\n  return ''\n}\n\n\n\nfunction hexToRGBArray(color) {\n  if (color.startsWith('#')) {\n    color = color.substring(1)\n  }\n\n  if (color.length === 3) {\n    color = color.charAt(0) + color.charAt(0) + color.charAt(1) + color.charAt(1) + color.charAt(2) + color.charAt(2);\n  } else if (color.length !== 6) {\n    throw(new Error('Invalid hex color: ' + color));\n  }\n\n  let rgb = [];\n  for (var i = 0; i <= 2; i++) {\n    rgb[i] = parseInt(color.substr(i * 2, 2), 16);\n  }\n\n  return rgb;\n}\nfunction luma(color) { \n  // color can be a hex string or an array of RGB values 0-255\n  const rgb = (typeof color === 'string') ? hexToRGBArray(color) : color;\n  return (0.2126 * rgb[0]) + (0.7152 * rgb[1]) + (0.0722 * rgb[2]); // SMPTE C, Rec. 709 weightings\n}\nfunction getContrastingColor(color) {\n  // source: https://stackoverflow.com/questions/635022/calculating-contrasting-colours-in-javascript\n  // exact answer: https://stackoverflow.com/a/6511606/2387277\n  // example: https://jsfiddle.net/thomasrosen/9njo6t7s/20/\n  \n  return (luma(color) >= 165) ? '000' : 'fff';\n}\n\n\n\n// function randomHexColor () {\n//   let color = ''\n//   for (let i = 0; i < 6; i++){\n//     const random = Math.random()\n//     const bit = (random * 16) | 0\n//     color += (bit).toString(16)\n//   }\n//   return '#'+color\n// }\n\n\n\nfunction colorToRGBA(color) {\n  // source: https://stackoverflow.com/questions/1573053/javascript-function-to-convert-color-names-to-hex-codes\n  // source: https://stackoverflow.com/a/24390910/2387277\n\n  // Returns the color as an array of [r, g, b, a] -- all range from 0 - 255\n  // color must be a valid canvas fillStyle. This will cover most anything\n  // you'd want to use.\n  // Examples:\n  // colorToRGBA('red')  # [255, 0, 0, 255]\n  // colorToRGBA('#f00') # [255, 0, 0, 255]\n  var cvs, ctx;\n  cvs = document.createElement('canvas');\n  cvs.height = 1;\n  cvs.width = 1;\n  ctx = cvs.getContext('2d');\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.getImageData(0, 0, 1, 1).data;\n}\nfunction byteToHex(num) {\n    // Turns a number (0-255) into a 2-character hex number (00-ff)\n    return ('0'+num.toString(16)).slice(-2);\n}\nfunction colorToHex(color) {\n    // Convert any CSS color to a hex representation\n    // Examples:\n    // colorToHex('red')            # '#ff0000'\n    // colorToHex('rgb(255, 0, 0)') # '#ff0000'\n    var rgba, hex;\n    rgba = colorToRGBA(color);\n    hex = [0,1,2].map(\n        function(idx) { return byteToHex(rgba[idx]); }\n        ).join('');\n    return \"#\"+hex;\n}\n\n\n\nfunction getBlockColor(block) {\n  const colors = {\n    color: null,\n    colorRGB: null,\n    contrastingColor: null,\n    contrastingColorRGB: null,\n  }\n\n  if (block.hasOwnProperty('properties') && block.properties.hasOwnProperty('color') && !!block.properties.color) {\n    const defaultColors = ['purple', 'red', 'green', 'blue', 'yellow']\n    let newColor = block.properties.color\n\n    if (defaultColors.includes(newColor)) {\n      colors.color = `var(--${newColor})`\n      colors.colorRGB = `var(--${newColor}-rgb)`\n      colors.contrastingColor = `var(--on-${newColor})`\n      colors.contrastingColorRGB = `var(--on-${newColor}-rgb)`\n    } else {\n      if (newColor.startsWith('#')) {\n        if (newColor.length !== 4 && newColor.length !== 7) {\n          newColor = null\n        }\n      } else {\n        const parsedColor = colorToHex(newColor)\n        if (parsedColor === '#000000' && newColor !== 'black') {\n          newColor = null\n        } else {\n          newColor = parsedColor\n        }\n      }\n\n      if (newColor) {\n        colors.color = newColor\n        const colorRGB = hexToRGBArray(newColor)\n        colors.colorRGB = colorRGB.join(', ')\n        colors.contrastingColor = '#'+getContrastingColor(newColor)\n        colors.contrastingColorRGB = hexToRGBArray(colors.contrastingColor)\n      }\n    }\n  }\n\n  return colors\n}\n\nmodule.exports = {\n  getImageUrl,\n  getBlockColor,\n}\n","import { gql } from '@apollo/client'\n\nexport const getBlock_Query = gql`\n  query getBlock ($_id: ObjectID!) {\n    block (_id: $_id) {\n\t\t  _id\n\t\t  type\n\t\t  properties\n\t\t  content {\n        blockId\n        block {\n          _id\n          type\n          properties\n          content {\n            blockId\n          }\n          parent\n          metadata {\n            modified\n            modified_by\n          }\n          permissions\n          computed {\n            roles\n            inherited_block_permissions\n          }\n        }\n      }\n\t\t  parent\n\t\t  metadata {\n        modified\n        modified_by\n      }\n      permissions\n      computed {\n        roles\n        inherited_block_permissions\n      }\n    }\n  }\n`\n\nexport const getBlocks_Query = gql`\n  query getBlocks ($ids: [ObjectID], $types: [String], $archived: Boolean, $roots: [ObjectID]) {\n    blocks (ids: $ids, types: $types, archived: $archived, roots: $roots) {\n      _id\n      type\n      properties\n      content {\n        blockId\n      }\n      parent\n      metadata {\n        modified\n        modified_by\n      }\n      permissions\n      computed {\n        roles\n        inherited_block_permissions\n      }\n    }\n  }\n`\n\nexport const getSelf_Query = gql`\n  query getSelf {\n    self {\n\t\t  logged_in\n\t\t  user\n\t\t  blockId\n      userroles\n    }\n  }\n`\n\nexport const getSiblingBlocks_Query = gql`\n  query getSiblingBlocks ($_id: ObjectID!, $types: [String]) {\n    blocks: siblingBlocks (_id: $_id, types: $types) {\n      _id\n      type\n      properties\n    }\n  }\n`\n\nexport const getParentBlocks_Query = gql`\n  query getParentBlocks ($_id: ObjectID!) {\n    blocks: parentBlocks (_id: $_id) {\n      _id\n      type\n      properties\n      computed {\n        sort\n      }\n    }\n  }\n`\n\nexport const blockMatchesRoles_Query = gql`\n  query blockMatchesRoles ($_id: ObjectID!, $roles: [String]) {\n    blockMatchesRoles (_id: $_id, roles: $roles)\n  }\n`\n\nexport const checkPath_Query = gql`\n  query checkPath ($path: String!) {\n    checkPath (path: $path) {\n      isOkay\n      errors\n    }\n  }\n`\n","import { useState, useEffect, useRef } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getSelf_Query } from '../graphql/queries'\n\nconst defaultUser = {\n  userroles: [],\n}\n\nexport default function useUser(forceRefetch = false) {\n  const mountedRef = useRef(false)\n  useEffect(() => {\n    mountedRef.current = true\n    return () => {\n      mountedRef.current = false\n    }\n  }, [])\n\n  const [user, setUser] = useState(defaultUser)\n  const [loggedIn, setLoggedIn] = useState(false)\n\n  const apollo_client = useApolloClient()\n\n  useEffect(() => {\n    if (forceRefetch !== true && window.hasOwnProperty('user')) {\n      setUser({\n        ...window.user,\n        userroles: window.user.userroles || [],\n      })\n      setLoggedIn(window.user.logged_in)\n    } else {\n      apollo_client.query({\n        query: getSelf_Query,\n      })\n        .then(async ({ data }) => {\n          if (mountedRef.current === true) {\n            if (data.hasOwnProperty('self') && data.self !== null) {\n              window.user = data.self\n              setUser({\n                ...data.self,\n                userroles: data.self.userroles || [],\n              })\n              setLoggedIn(data.self.logged_in)\n            } else {\n              setUser(defaultUser)\n              setLoggedIn(false)\n            }\n          }\n        })\n        .catch(error => {\n          console.error(error)\n          if (mountedRef.current === true) {\n            setUser(defaultUser)\n            setLoggedIn(false)\n          }\n        })\n    }\n  }, [forceRefetch, setUser, setLoggedIn, apollo_client])\n\n  return {\n    ...user,\n    loggedIn,\n  }\n}\n","import {\n  Paper,\n  MenuList,\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n  Divider,\n} from '@mui/material'\n\nimport {\n  Close as CloseIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../fluent/Localized.js'\n\nimport Popover from './Popover.js'\n\nexport default function PopoverMenu ({\n  trigger,\n  children,\n  onToogle,\n  paperProps = {},\n}) {\n  return <Popover\n    trigger={trigger}\n    onToogle={onToogle}\n  >\n    {({closePopover, open, ...popoverProps}) => {\n      const {\n        sx = {},\n        ...paperPropsRest\n      } = paperProps || {}\n\n      return (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 380,\n            // height: 325,\n            maxHeight: 'calc(100vh - 32px)',\n            overflow: 'auto',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n            ...sx,\n          }}\n          elevation={8}\n          {...paperPropsRest}\n        >\n          <MenuList\n            autoFocus={true}\n            style={{\n              width: '100%',\n              maxWidth: '100%',\n              marginTop: '-8px',\n            }}\n          >\n            <div>\n\n              {typeof children === 'function' ? children({ isOpen: open, close: closePopover }) : children}\n\n              <Divider style={{opacity: 0.2, marginBottom:'8px'}}  />\n\n              <MenuItem className=\"roundMenuItem\" onClick={closePopover}>\n                <ListItemIcon>\n                  <CloseIcon />\n                </ListItemIcon>\n                <ListItemText>\n                  <Localized id=\"block_menu_close_menu\" />\n                </ListItemText>\n              </MenuItem>\n\n            </div>\n          </MenuList>\n        </Paper>\n    )}}\n  </Popover>\n}\n","import { gql } from '@apollo/client'\n\nexport const saveBlock_Mutation = gql`\n  mutation saveBlock ($block: InputBlock!) {\n    saveBlock (block: $block)\n  }\n`\n\nexport const saveProperty_Mutation = gql`\n  mutation saveProperty ($_id: ObjectID!, $key: String!, $value: JSON) {\n    saveProperty (_id: $_id, key: $key, value: $value)\n  }\n`\n\nexport const archiveBlock_Mutation = gql`\n  mutation archiveBlock ($_id: ObjectID!) {\n    archiveBlock (_id: $_id)\n  }\n`\n\nexport const unarchiveBlock_Mutation = gql`\n  mutation unarchiveBlock ($_id: ObjectID!) {\n    unarchiveBlock (_id: $_id)\n  }\n`\n\nexport const moveBlock_Mutation = gql`\n  mutation moveBlock ($movingBlockId: ObjectID!, $newParentId: ObjectID!, $newIndex: Int!) {\n    moveBlock(movingBlockId: $movingBlockId, newParentId: $newParentId, newIndex: $newIndex)\n  }\n`\n","import mdit from 'markdown-it'\nimport kbd from 'markdown-it-kbd'\nimport emoji from 'markdown-it-emoji'\nimport twemoji from 'twemoji'\n\nfunction getMD(options){\n  // var hljs = require('highlight.js') // https://highlightjs.org/\n  const md = mdit({\n    html: false,\n    xhtmlOut: false,\n    linkify: true,\n    typographer: true,\n    breaks: false,\n    // highlight: function (str, lang) {\n    //   const language_obj = hljs.getLanguage(lang)\n    //   if (lang && language_obj) {\n    //     const language = language_obj.aliases[0]\n    //     return '<pre class=\"hljs language-'+language+'\"><code>' +\n    //       hljs.highlight(str, { language, ignoreIllegals: true }).value +\n    //     '</code></pre>';\n    //   } else {\n    //     const html = hljs.highlightAuto(str, { ignoreIllegals: true })\n    //     return '<pre class=\"hljs language-'+html.language+'\"><code>' +\n    //       html.value +\n    //     '</code></pre>';\n    //   }\n\n    //   return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n    // }\n    ...options,\n  })\n\n  // md.disable([ 'heading', 'heading', 'lheading', 'paragraph', 'image' ])\n  md.use(kbd)\n  md.use(emoji)\n\n  return md\n}\n\nfunction renderInlineMarkdown(text, options = {}){\n  text = text || ''\n  // text = text.replace(/\\n/g, '<br>')\n  // text = text.replace(/\\t/g, '&emsp;')\n\n  text = text\n  .replace(/\\(TM\\)/gi, '')\n  .replace(/\\(SM\\)/gi, '')\n  .replace(/\\(C\\)/gi, '')\n  .replace(/\\(R\\)/gi, '')\n\n  const md = getMD(options)\n  text = md.renderInline(text)\n\n  text = twemoji.parse(text, {\n    folder: 'svg',\n    ext: '.svg',\n    base: '/public/twemoji/assets/',\n    // callback: function(icon, options, variant) {\n    //   switch ( icon ) {\n    //     case 'a9':      //  copyright\n    //     case 'ae':      //  registered trademark\n    //     case '2122':    //  trademark\n    //       return false\n    //     default:\n    //       return ''.concat(options.base, options.size, '/', icon, options.ext)\n    //   }\n    // }\n  })\n    \n  return text\n}\n\nexport {\n  renderInlineMarkdown,\n}\n","import { useCallback } from 'react'\n\nimport { useLocalization } from '../fluent/Localized.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { saveBlock_Mutation } from '../graphql/mutations.js'\n\nimport { useSnackbar } from 'notistack'\n\nfunction removeProperty(obj, prop) {\n  // remove property from objects, arrays and sub-objects\n\n  obj = JSON.parse(JSON.stringify(obj)) // clone object to make everything mutable\n\n  if (obj.hasOwnProperty(prop)) {\n    delete obj[prop]\n  }\n  for (const i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (typeof obj[i] == 'object' && obj[i] !== null) {\n        removeProperty(obj[i], prop)\n      }\n    }\n  }\n\n  return obj\n}\n\nfunction useSaveBlock() {\n  const { getString } = useLocalization()\n\n  const apollo_client = useApolloClient()\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar()\n\n  const handleSaveBlock = useCallback((initialBlock) => {\n    return new Promise(final_resolve => {\n      let snackbarKey = null\n\n      let newBlock = {...initialBlock}\n      newBlock = removeProperty(newBlock, '__typename')\n      if (newBlock.hasOwnProperty('content') && Array.isArray(newBlock.content)) {\n        newBlock.content = newBlock.content.map(contentConfig => ({\n          blockId: contentConfig.blockId,\n        }))\n      }\n\n      const loadingDataPromise = new Promise(resolve => {\n        apollo_client.mutate({\n          mutation: saveBlock_Mutation,\n          variables: {\n            block: newBlock\n          },\n        })\n          .then(async ({ data }) => {\n            resolve('got-data')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            if (typeof data.error === 'string') {\n              if (data.error === 'no_edit_permission') {\n                enqueueSnackbar(getString('path_editor_edit_permission_error'), {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 2000,\n                })\n              } else {\n                enqueueSnackbar('' + data.error, {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 2000,\n                })\n              }\n            } else {\n              final_resolve({\n                ...initialBlock,\n                _id: data.saveBlock,\n              })\n\n              enqueueSnackbar(getString('path_editor_status_saved'), {\n                variant: 'success',\n                preventDuplicate: false,\n                autoHideDuration: 2000,\n              })\n            }\n          })\n          .catch(async error => {\n            console.error(error)\n            resolve('got-error')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            enqueueSnackbar(getString('path_editor_status_error_while_saving', {\n              error: error.message,\n            }), {\n              variant: 'error',\n              preventDuplicate: true,\n              autoHideDuration: 2000,\n            })\n          })\n      })\n\n      // Show a loading-info-snackbar if loading the data takes too long.\n      Promise.race([\n        new Promise(resolve => {\n          setTimeout(() => {\n            resolve('show-loading')\n          }, 300)\n        }),\n        loadingDataPromise,\n      ])\n        .then(response => {\n          if (response === 'show-loading') {\n            snackbarKey = enqueueSnackbar(getString('path_editor_status_started_saving'), {\n              persist: true,\n              preventDuplicate: true,\n            })\n          }\n        })\n        .catch(error => console.error)\n\n    })\n  }, [\n    enqueueSnackbar,\n    closeSnackbar,\n    apollo_client,\n    getString,\n  ])\n\n  return handleSaveBlock\n}\n\nexport default useSaveBlock\n","import { useRef, useEffect } from 'react'\n\nimport { Transmat, addListeners, TransmatObserver } from 'transmat'\n\nimport classes from './DataTransmat.module.css'\n\nfunction getTransmatOptions(transmat, mimetypes) {\n  let data = {}\n  for (const mimetype of mimetypes) {\n    if (transmat.hasType(mimetype)) {\n      if (mimetype === 'application/json') {\n        data[mimetype] = JSON.parse(transmat.getData(mimetype))\n      } else {\n        data[mimetype] = transmat.getData(mimetype)\n      }\n    }\n  }\n\n  const options = {\n    data,\n    transmat,\n  }\n\n  return options\n}\n\nexport function DataReceiver({ onReceive, style, className, children, checkEntry, mimetypes = ['application/json'] }){\n  const receiverRef = useRef(null)\n\n  useEffect(() => {\n    const unlisten = addListeners(receiverRef.current, 'receive', event => {\n      const transmat = new Transmat(event)\n      const options = getTransmatOptions(transmat, mimetypes)\n      \n      let isOkay = false\n      if (typeof checkEntry === 'function') {\n        isOkay = checkEntry(options)\n      }\n\n      if (isOkay && transmat.accept()) {\n        if (typeof onReceive === 'function') {\n          onReceive(options)\n        }\n        event.preventDefault()\n      }\n    })\n\n    const obs = new TransmatObserver(entries => {\n      for (const entry of entries) {\n        const transmat = new Transmat(entry.event)\n\n        const options = getTransmatOptions(transmat, mimetypes)\n      \n        let isOkay = false\n        if (typeof checkEntry === 'function') {\n          isOkay = checkEntry(options)\n        }\n\n        if (isOkay) {\n          entry.target.classList.toggle(classes.drag_over, entry.isTarget)\n          entry.target.classList.toggle(classes.drag_active, entry.isActive)\n        }\n      }\n    })\n    obs.observe(receiverRef.current)\n\n    return () => {\n      unlisten()\n      obs.disconnect()\n    }\n  }, [ onReceive, checkEntry, mimetypes ])\n\n  return <div ref={receiverRef} style={style} className={className}>\n    {children}\n  </div>\n}\n\nexport function DataTransmiter({ onTransmit, draggable, style, className, children }){\n  const transmiterRef = useRef(null)\n\n  useEffect(() => {\n    return addListeners(transmiterRef.current, 'transmit', async event => {\n      const transmat = new Transmat(event)\n      if (typeof onTransmit === 'function') {\n        const options = await onTransmit(transmat)\n        if (\n          typeof options === 'object'\n          && options !== null\n          && !Array.isArray(options.data)\n          && typeof options.data === 'object'\n          && options.data !== null\n        ) {\n          transmat.setData(options.data)\n          // transmat.setData({\n          //   'text/plain': 'Hello world!',\n          //   'text/html': '<h1>Hello world!</h1>',\n          //   'text/uri-list': 'http://example.com',\n          //   'application/json': {foo:'bar'},\n          // })\n        }\n      }\n    })\n  }, [ onTransmit ])\n\n  return <div ref={transmiterRef} style={style} className={className} draggable={draggable ? 'true' : 'false'} tabIndex=\"0\">\n    {children}\n  </div>\n}\n\nexport function DataBothWays({ onTransmit, onReceive, checkEntry, draggable, style, className, children, mimetypes = ['application/json'] }){\n  const bothwayRef = useRef(null)\n\n  useEffect(() => {\n    const unlistenTransmit = addListeners(bothwayRef.current, 'transmit', async event => {\n      const transmat = new Transmat(event)\n\n      if (typeof onTransmit === 'function') {\n        const options = await onTransmit(transmat)\n        if (\n          typeof options === 'object'\n          && options !== null\n          && !Array.isArray(options.data)\n          && typeof options.data === 'object'\n          && options.data !== null\n        ) {\n          transmat.setData(options.data)\n          // transmat.setData({\n          //   'text/plain': 'Hello world!',\n          //   'text/html': '<h1>Hello world!</h1>',\n          //   'text/uri-list': 'http://example.com',\n          //   'application/json': {foo:'bar'},\n          // })\n        }\n      }\n    })\n\n    const unlistenReceive = addListeners(bothwayRef.current, 'receive', event => {\n      const transmat = new Transmat(event)\n      const options = getTransmatOptions(transmat, mimetypes)\n      \n      let isOkay = false\n      if (typeof checkEntry === 'function') {\n        isOkay = checkEntry(options)\n      }\n\n      if (true && transmat.accept()) { // accept everything so wrong stuff like images does not get displayed in the browser\n        if (isOkay) {\n          if (typeof onReceive === 'function') {\n            onReceive(options)\n          }\n        }\n        event.preventDefault()\n      }\n    })\n\n    const obs = new TransmatObserver(entries => {\n      for (const entry of entries) {\n        const transmat = new Transmat(entry.event)\n        const options = getTransmatOptions(transmat, mimetypes)\n\n        let isOkay = false\n        if (typeof checkEntry === 'function') {\n          isOkay = checkEntry(options)\n        }\n\n        if (isOkay) {\n          entry.target.classList.toggle(classes.drag_over, entry.isTarget)\n          entry.target.classList.toggle(classes.drag_active, entry.isActive)\n        }\n      }\n    })\n    obs.observe(bothwayRef.current)\n\n    return () => {\n      unlistenTransmit()\n      unlistenReceive()\n      obs.disconnect()\n    }\n  }, [ onTransmit, onReceive, checkEntry, mimetypes ])\n\n  return <div\n    ref={bothwayRef}\n    style={style}\n    className={className}\n    draggable={draggable ? 'true' : 'false'}\n    tabIndex=\"0\"\n  >\n    {children}\n  </div>\n}\n\n// Examples:\n//\n// <DataTransmiter\n//   draggable={true}\n//   style={{\n//     width: '100%',\n//     height: '200px',\n//     backgroundColor: 'blue',\n//   }}\n//   onTransmit={() => ({\n//     'text/plain': 'Hello world!',\n//     'text/html': '<h1>Hello world!</h1>',\n//     'text/uri-list': 'http://example.com',\n//     'application/json': {foo:'bar'},\n//   })}\n// >\n//   DataTransmiter\n// </DataTransmiter>\n//\n// <DataReceiver\n//   style={{\n//     width: '100%',\n//     height: '200px',\n//     backgroundColor: 'red',\n//   }}\n//   onReceive={data => console.info('received', data)}\n// >\n//   DataReceiver\n// </DataReceiver>\n","import { useState, useEffect } from 'react'\n\nimport { renderInlineMarkdown } from '../../markdown.js'\nimport { useLocalization } from '../../fluent/Localized.js'\n\nimport { getBlockColor } from '../../functions.js'\n\nfunction ViewerTextCard ({ block, style, locales }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  const { translateBlock } = useLocalization()\n  const text = translateBlock(block, locales, '')\n\n  useEffect(() => {\n    const textWithHtml = renderInlineMarkdown(text)\n    setHtml({ __html: textWithHtml })\n  }, [text, setHtml])\n  \n  const defaultProps = {\n    dir: 'auto',\n    style: {\n      whiteSpace: 'pre-wrap',\n      ...style,\n    },\n  }\n\n  const {\n    color,\n  } = getBlockColor(block)\n  if (color) {\n    defaultProps.style.color = color\n  }\n\n  let text_style = 'body'\n  if (block.properties.hasOwnProperty('text_style')) {\n    text_style = block.properties.text_style\n  }\n\n  let component = null\n  switch (text_style) {\n    case 'h1':\n      component = <h1\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'h2':\n      component = <h2\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'h3':\n      component = <h3\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'caption':\n      component = <caption\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    default: // body\n      component = <p\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n  }\n\n  return component\n}\n\nexport default ViewerTextCard\n","import { useState, useEffect } from 'react'\n\nimport { renderInlineMarkdown } from '../../markdown.js'\nimport { useLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nfunction ViewerButtonCard ({ block, actions = {}, locales }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  const { getString, translateBlock } = useLocalization()\n  const text = translateBlock(block, locales, getString('placeholder_main_headline'))\n\n  useEffect(() => {\n    const textWithHtml = renderInlineMarkdown(text, { linkify: false })\n    setHtml({ __html: textWithHtml })\n  }, [text, setHtml])\n\n  let url = ''\n  if (\n    block\n    && block.properties\n    && block.properties.trigger\n    && block.properties.action\n    && block.properties.action.url\n    && block.properties.trigger.type === 'click'\n    && block.properties.action.type === 'open_url'\n  ) {\n    url = block.properties.action.url\n  }\n\n  const {\n    color,\n    contrastingColor,\n  } = getBlockColor(block)\n\n  const colorStyles = {}\n  if (color) {\n    colorStyles['--button-background'] = color\n    colorStyles['--button-color'] = contrastingColor\n  }\n\n  const hasClickAction = actions.hasOwnProperty('click')\n\n  if (hasClickAction === false && url !== '') {\n    return <a\n        href={url}\n        target=\"_blank\" rel=\"noreferrer\"\n      >\n      <button\n        dir=\"auto\"\n        dangerouslySetInnerHTML={html}\n        className=\"default square\"\n        style={{\n          margin: '0',\n          whiteSpace: 'pre-wrap',\n          ...colorStyles,\n        }}\n      ></button>\n    </a>\n  }\n\n  if (hasClickAction === true && typeof actions.click === 'function') {\n    return <button\n      dir=\"auto\"\n      dangerouslySetInnerHTML={html}\n      className=\"default square\"\n      style={{\n        margin: '0',\n        whiteSpace: 'pre-wrap',\n        ...colorStyles,\n      }}\n      onClick={actions.click}\n    ></button>\n  }\n\n  return <button\n    dir=\"auto\"\n    dangerouslySetInnerHTML={html}\n    disabled=\"disabled\"\n    className=\"default square\"\n    style={{\n      margin: '0',\n      whiteSpace: 'pre-wrap',\n      ...colorStyles,\n    }}\n  ></button>\n}\n\nexport default ViewerButtonCard\n","import { getBlockColor } from '../../functions.js'\n\nexport default function ViewerDividerLine ({ block }) {\n  const {\n    color,\n  } = getBlockColor(block)\n\n  const styles = {}\n  if (color) {\n    styles['--on-background'] = color\n  }\n\n  return <hr style={styles} />\n}\n","import {\n  CheckBox as CheckBoxIcon,\n  CheckBoxOutlineBlank as CheckBoxOutlineBlankIcon,\n} from '@mui/icons-material'\n\nfunction ViewerCheckboxCard ({ block }) {\n  const text = block.properties.text || ''\n\n  const checked = Boolean(block.properties.checked)\n\n  const checkboxStyle = {\n    verticalAlign: 'middle',\n    paddingInlineEnd: 'var(--basis)',\n    height: 'calc(var(--font-add) + var(--basis))',\n    width: 'auto',\n  }\n\n  return <p dir=\"auto\">\n    {\n      checked\n      ? <CheckBoxIcon style={checkboxStyle} />\n      : <CheckBoxOutlineBlankIcon style={checkboxStyle} />\n    }\n    {text}\n  </p>\n}\n\nexport default ViewerCheckboxCard\n","import { useLocalization } from '../../fluent/Localized.js'\n\nimport { getImageUrl, getBlockColor } from '../../functions.js'\nimport useBlockTrigger from '../../hooks/useBlockTrigger.js'\n\nimport {\n  InsertDriveFile as PageIcon,\n  Face as PersonIcon,\n  LinkSharp as RedirectIcon,\n} from '@mui/icons-material'\n\nimport { Link } from 'react-router-dom'\n\nimport classes from './ViewerLine.module.css'\n\nfunction ViewerLine ({ block, actions = {}, locales }) {\n  const { getString, translateBlock, userLocales } = useLocalization()\n\n  const { link, path } = useBlockTrigger({ block })\n\n  let title = translateBlock(block, locales || userLocales, '')\n  if (title === '') {\n    const triggerProperties = ((block.properties || {}).trigger || {})\n    const triggerType = triggerProperties.type\n\n    if (triggerType === 'path') {\n      title = '/'+triggerProperties.path\n    } else if (block.type === 'redirect') {\n      if (triggerType === 'click') {\n        title = triggerProperties.blockId\n      } else if (triggerType === 'cron') {\n        title = triggerProperties.cron\n      } else if (triggerType === 'block_change') {\n        title = triggerProperties.blockId\n      } else if (Object.keys(triggerProperties).length > 0) {\n        title = JSON.stringify(triggerProperties)\n      } else {\n        title = getString('placeholder_main_headline')\n      }\n    } else {\n      title = getString('placeholder_main_headline')\n    }\n  }\n  \n  let isSquareIcon = false\n  let icon_url = getImageUrl(block.properties.icon)\n  if (!icon_url) {\n    isSquareIcon = true\n    icon_url = getImageUrl(block.properties.coverphoto)\n  }\n\n  let iconComponent = null\n  if (icon_url === '') {\n    switch (block.type) {\n      case 'person':\n        iconComponent = <PersonIcon className={classes.icon} />\n        break\n      case 'redirect':\n        iconComponent = <RedirectIcon className={classes.icon} />\n        break\n      default:\n      iconComponent = <PageIcon className={classes.icon} />\n    }\n  } else {\n    iconComponent = <div className={`${classes.icon} ${isSquareIcon ? classes.square : classes.round}`} style={{ backgroundImage: `url(${window.domains.backend}download_url?f=${window.imageFormat || 'jpg'}&w=40&h=40&url=${encodeURIComponent(icon_url)})` }} alt={title}></div>\n  }\n\n\n\n  let cardOnClick = null\n  let cardLink = path || link\n\n  if (actions.hasOwnProperty('link')) {\n    if (typeof actions.link === 'string') {\n      cardLink = actions.link\n    }\n  } else if (actions.hasOwnProperty('click')) {\n    if (typeof actions.click === 'function') {\n      cardOnClick = actions.click\n    }\n  }\n\n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  if (typeof cardLink === 'string' && cardLink.length > 0) {\n    if (cardLink.includes(':')) {\n      return <a\n        href={cardLink}\n        target=\"_blank\" rel=\"noreferrer\"\n        title={title}\n        className={`clickable_card ${classes.root}`}\n        style={{\n          display: 'block',\n          cursor: 'pointer',\n          color,\n          '--on-background-rgb': colorRGB,\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center' }}>\n          {iconComponent}\n          <span dir=\"auto\" className={classes.title}>{title}</span>\n        </div>\n      </a>\n    } else {\n      return <Link\n      to={cardLink}\n      title={title}\n      className={`clickable_card ${classes.root}`}\n      style={{\n        display: 'block',\n        cursor: 'pointer',\n        color,\n        '--on-background-rgb': colorRGB,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        {iconComponent}\n        <span dir=\"auto\" className={classes.title}>{title}</span>\n      </div>\n    </Link>\n    }\n  } else {\n    const onClickProps = {}\n    if (typeof cardOnClick === 'function') {\n      onClickProps.onClick = cardOnClick\n    }\n\n    return <div\n      {...onClickProps}\n      title={title}\n      className={`clickable_card ${classes.root}`}\n      style={{\n        cursor: typeof cardOnClick === 'function' ? 'pointer' : 'auto',\n        color,\n        '--on-background-rgb': colorRGB,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        {iconComponent}\n        <span dir=\"auto\" className={classes.title}>{title}</span>\n      </div>\n    </div>\n  }\n}\n\nexport default ViewerLine\n","import { useState, useEffect } from 'react' // useCallback\n// import { useNavigate } from 'react-router-dom'\n\nexport default function useBlockTrigger({ block = null }) {\n  const [link, setLink] = useState(null)\n  const [path, setPath] = useState(null)\n  // const [onClick, setOnClick] = useState(null)\n\n  // let navigate = useNavigate()\n\n  useEffect(() => {\n    let newLink = null\n    let newPath = null\n    // let newOnClick = null\n\n    if (block !== null) {\n      const blockId = block._id\n\n      const triggerProperties = ((block.properties || {}).trigger || {})\n      const triggerType = triggerProperties.type\n\n      const actionProperties = ((block.properties || {}).action || {})\n      const actionType = actionProperties.type\n\n      if (\n        triggerType === 'path'\n        || triggerType === 'click'\n      ) {\n        if (\n          actionType === 'open_url'\n          && typeof actionProperties.url === 'string'\n          && actionProperties.url.length > 0\n        ) {\n          const url = actionProperties.url || ''\n          newLink = url\n          newPath = null // `/${triggerProperties.path}`\n          // newOnClick = () => window.open(newLink, '_blank')\n        } else if (\n          actionType === 'render_block'\n          && typeof triggerProperties.path === 'string'\n          && triggerProperties.path.length > 0\n        ) {\n          if (\n            typeof actionProperties.blockId === 'string'\n            && actionProperties.blockId.length > 0\n          ) {\n            newLink = `${window.domains.frontend}${triggerProperties.path}=${actionProperties.blockId}`\n            newPath = `/${triggerProperties.path}=${actionProperties.blockId}`\n            // newOnClick = () => navigate(newLink)\n          } else {\n            newLink = `${window.domains.frontend}${triggerProperties.path}=${blockId}`\n            newPath = `/${triggerProperties.path}=${blockId}`\n            // newOnClick = () => navigate(newLink)\n          }\n        } else {\n          newLink = `/${blockId}/view`\n          newPath = `/${blockId}`\n          // newOnClick = () => navigate(newLink)\n        }\n        // TODO: add support for other trigger types (run_script, ...)\n      } else {\n        newLink = `${window.domains.frontend}${blockId}/view`\n        newPath = `/${blockId}`\n        // newOnClick = () => navigate(newLink)\n      }\n    }\n\n    setLink(newLink)\n    setPath(newPath)\n    // setOnClick(newOnClick)\n  }, [block, setLink, setPath]) // setOnClick, navigate\n\n  return { link, path } // onClick\n}\n","import React, { useEffect, useRef, useCallback } from 'react'\n\nimport { DataBothWays } from '../DataTransmat.js'\n\nimport ViewerTextCard from './ViewerTextCard.js'\nimport ViewerButtonCard from './ViewerButtonCard.js'\nimport ViewerDividerLine from './ViewerDividerLine.js'\nimport ViewerCheckboxCard from './ViewerCheckboxCard.js'\nimport ViewerLine from './ViewerLine.js'\n\nimport classes from './ViewerAuto.module.css'\n\n// saveBlock_Mutation\nimport { moveBlock_Mutation, saveProperty_Mutation } from '../../graphql/mutations.js'\nimport useMutation from '../../hooks/useMutation.js'\nimport useUser from '../../hooks/useUser.js'\n\nfunction usePressedKeys({ keys = [] }) { // keys needs to lowercase\n  const pressedKeysRef = useRef(new Set())\n\n  useEffect(() => {\n    function onKeyDown(event) {\n      const key = event.key.toLowerCase()\n      if (keys.includes(key)) {\n        pressedKeysRef.current.add(key)\n      }\n    }\n    function onKeyUp(event) {\n      const key = event.key.toLowerCase()\n      pressedKeysRef.current.delete(key)\n    }\n\n    window.addEventListener('keydown', onKeyDown)\n    window.addEventListener('keyup', onKeyUp)\n\n    return () => {\n      window.removeEventListener('keydown', onKeyDown)\n      window.removeEventListener('keyup', onKeyUp)\n    }\n  }, [keys])\n\n  const getPressedKeys = () => pressedKeysRef.current // returns a Set !!!\n\n  return { getPressedKeys }\n}\n\nfunction removeProperty(obj, prop) {\n  // remove property from objects, arrays and sub-objects\n\n  obj = JSON.parse(JSON.stringify(obj)) // clone object to make everything mutable\n\n  if (obj.hasOwnProperty(prop)) {\n    delete obj[prop]\n  }\n  for (const i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (typeof obj[i] == 'object' && obj[i] !== null) {\n        removeProperty(obj[i], prop)\n      }\n    }\n  }\n\n  return obj\n}\n\nfunction ViewerAuto ({ block = {}, actions = {}, size = 'card', dragable = false, ...props }) {\n  let component = null\n\n  const { userroles } = useUser()\n  const { getPressedKeys } = usePressedKeys({ keys: ['shift'] }) // returns a Set !!!\n\n  const type = block.type || null\n\n  switch (type) {\n    case 'text':\n      component = <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'button':\n      component = <ViewerButtonCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'divider':\n      component = <ViewerDividerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'checkbox':\n      component = <ViewerCheckboxCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'page':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'person':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'redirect':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    default:\n      component = JSON.stringify(block) // <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n  }\n\n  const mutationFunction = useMutation()\n\n  const onReceive = useCallback(async ({ data = {} }) => {\n    const {\n      'application/json': json\n    } = data || {}\n\n    if (typeof json === 'object' && json !== null) {\n      let movingBlock = json\n\n      movingBlock = removeProperty(movingBlock, '__typename')\n\n      const block_roles = block.computed.roles || []\n      const movingBlock_roles = movingBlock.computed.roles || []\n\n      if (\n        movingBlock._id !== block._id\n        && (\n          userroles.includes('admin')\n          || (\n            ( block_roles.includes('editor') || block_roles.includes('owner') )\n            && ( movingBlock_roles.includes('editor') || movingBlock_roles.includes('owner') )\n          )\n        )\n      ) {\n        const pressedKeys = getPressedKeys()\n        // TODO: handle alt-key to duplicate block (child-blocks also need to be duplicated)\n        // if (pressedKeys.has('alt')) {\n        //   // duplicate block\n        //   delete movingBlock._id\n        //   const save_result = await mutationFunction({\n        //     mutation: saveBlock_Mutation,\n        //     variables: {\n        //       block: movingBlock,\n        //     },\n        //   })\n        //\n        //   movingBlock._id = save_result.saveBlock\n        // }\n\n        let everything_updated = false\n\n        try {\n          await mutationFunction({\n            mutation: moveBlock_Mutation,\n            variables: {\n              movingBlockId: movingBlock._id,\n              newParentId: block._id,\n              newIndex: 0,\n            },\n          })\n        \n          if (pressedKeys.has('shift')) {\n            // auto hide the block        \n            await mutationFunction({\n              mutation: saveProperty_Mutation,\n              variables: {\n                _id: movingBlock._id,\n                key: 'active',\n                value: false,\n              },\n            })\n          }\n        \n          everything_updated = true\n        } catch (error) {\n          console.error(error)\n        }\n      \n        if (everything_updated) {\n          console.log('TODO reload sidebar')\n          // TODO: reload sidebar\n        }\n      }\n    } \n  }, [mutationFunction, block, getPressedKeys, userroles])\n\n  const handleCheckEntry = useCallback(({ data = {} }) => {\n    const {\n      'application/json': json\n    } = data || {}\n\n    let isOkay = false\n\n    if (\n      typeof json === 'object'\n      && json !== null\n      && json.hasOwnProperty('computed')\n      && json.computed.hasOwnProperty('roles')\n    ) {\n      const this_roles = json.computed.roles || []\n      if (userroles.includes('admin') || this_roles.includes('editor') || this_roles.includes('owner')) {\n        isOkay = true\n      }\n    }\n\n    return isOkay\n  }, [userroles])\n\n  return <DataBothWays\n    key={block._id}\n    draggable={dragable}\n    className={classes.root}\n    onTransmit={() => ({\n      data: {\n        'text/plain': block.properties.text || '',\n        // 'text/html': '<h1>Hello world!</h1>',\n        // 'text/uri-list': 'http://example.com',\n        'application/json': block,\n      }\n    })}\n    onReceive={onReceive}\n    checkEntry={handleCheckEntry}\n  >\n    {component}\n  </DataBothWays>\n}\n\nexport default ViewerAuto\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlocks_Query } from '../graphql/queries'\n\nfunction useLoadBlocks() {\n  const apollo_client = useApolloClient()\n\n  const handleLoadBlocks = useCallback(variables => {\n    return new Promise(resolve => {\n      apollo_client.query({\n        query: getBlocks_Query,\n        variables,\n      })\n        .then(async ({ errors, data }) => {\n          if (Array.isArray(errors) && errors.length > 0) {\n            throw errors\n          } else if (Array.isArray(data.blocks)) {\n            resolve(data.blocks)\n          }else{\n            throw new Error('Unknown error while loading blocks.')\n          }\n        })\n        .catch(async error => {\n          console.error('error', error)\n          resolve([])\n        })\n    })\n  }, [apollo_client])\n\n  return handleLoadBlocks\n}\n\nexport default useLoadBlocks\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\n\nfunction useMutation() {\n  const apollo_client = useApolloClient()\n\n  const handleMutation = useCallback(option => {\n    return new Promise((resolve,reject) => {\n      apollo_client.mutate(option)\n        .then(({ data }) => {\n          if (typeof data.error === 'string') {\n            reject(data.error)\n          } else {\n            resolve(data)\n          }\n        })\n        .catch(reject)\n    })\n  }, [ apollo_client ])\n\n  return handleMutation\n}\n\nexport default useMutation\n","import { useState, useRef, useEffect, useCallback } from 'react'\n\nimport {\n  Portal,\n  Fade,\n  Popper,\n} from '@mui/material'\n\nconst randomString = () => (Math.random() + 1).toString(36).substring(7)\n\nfunction Popover ({\n  trigger,\n  children = () => {},\n  onToogle = () => {},\n  setOpenBlockMenuRef,\n}) {\n  const anchorRef = useRef(null)\n  const [open, setOpen] = useState(false)\n\n  const setOpenExternal = useCallback((newOpen) => {\n    setOpen(newOpen)\n  }, [ setOpen ])\n\n  useEffect(() => {\n    if (!!setOpenBlockMenuRef) {\n      setOpenBlockMenuRef.current = setOpenExternal\n    }\n  }, [ setOpenExternal, setOpenBlockMenuRef ])\n\n  const handlePopoverToggleClick = () => {\n    setOpen((prevOpen) => {\n      onToogle(!prevOpen)\n      return !prevOpen\n    })\n  }\n\n  const closePopover = () => {\n    onToogle(false)\n    setOpen(false)\n  }\n\n  const id = open ? 'popover-'+randomString() : undefined\n\n  return <>\n\n    {trigger(\n      {\n        ref: anchorRef,\n        'aria-describedby': id,\n        onClick: handlePopoverToggleClick,\n        style: {\n          pointerEvents: open ? 'none' : 'all',\n        },\n      }, {\n        isOpen: open,\n      }\n    )}\n\n  <Portal>\n    <div\n      onClick={closePopover}\n      style={{\n        display: (open ? 'block' : 'none'),\n        position: 'fixed',\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n        zIndex: 1299,\n        cursor: 'pointer',\n      }}\n    />\n\n    <Popper\n      id={id}\n      open={open}\n      anchorEl={anchorRef.current}\n      transition\n      placement=\"bottom-start\"\n      disablePortal={true}\n      modifiers={[\n        {\n          name: 'flip',\n          enabled: true,\n          options: {\n            altBoundary: true,\n            rootBoundary: 'viewport',\n            padding: 8,\n          },\n        },\n      ]}\n      style={{\n        zIndex: 1300,\n      }}\n    >\n      {({ TransitionProps }) => (\n        <Fade {...TransitionProps}>\n          <div>\n          {\n            !!children && typeof children === 'function'\n            ? children({\n              open,\n              style: {\n                transformOrigin: 'top left',\n              },\n              closePopover,\n            })\n            : null\n          }\n          </div>\n        </Fade>\n      )}\n    </Popper>\n\n    </Portal>\n  </>\n}\n\nexport default Popover\n","\nimport {\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n} from '@mui/material'\n\nimport {\n  InsertDriveFileSharp as PageIcon,\n  LinkSharp as RedirectIcon,\n  PersonSharp as PersonIcon,\n  Crop75Sharp as ButtonIcon,\n  NotesSharp as TextIcon,\n  Remove as DividerIcon,\n  CodeSharp as CodeIcon,\n  CheckBox as CheckboxIcon,\n  // EditSharp as EditIcon,\n} from '@mui/icons-material'\n\nimport useUser from '../../hooks/useUser.js'\nimport PopoverMenu from '../PopoverMenu.js'\nimport { Localized } from '../../fluent/Localized.js'\n\nconst blockTypeIcons = {\n  button: <ButtonIcon />,\n  text: <TextIcon />,\n  code: <CodeIcon />,\n  divider: <DividerIcon />,\n  checkbox: <CheckboxIcon />,\n  page: <PageIcon />,\n  person: <PersonIcon />,\n  redirect: <RedirectIcon />,\n}\n\nconst default_types = [\n  'page',\n  'redirect',\n]\n\nfunction AddMenuContent({ createBlock, types, close = null }) {\n  if (!types || !Array.isArray(types)) {\n    types = default_types\n  }\n\n  return <>\n    {\n      types\n        .map(type => (\n          <MenuItem className=\"roundMenuItem\" key={type} onClick={() => createBlock({ type, close })}>\n            <ListItemIcon>\n              {blockTypeIcons[type]}\n            </ListItemIcon>\n            <ListItemText>\n              <Localized id={'block_menu_type_label_'+type} />\n            </ListItemText>\n          </MenuItem>\n        ))\n    }\n  </>\n}\n\nfunction AddMenu ({ trigger, createBlock, types }) {\n  const { loggedIn } = useUser()\n\n  if (loggedIn) {\n    return <PopoverMenu trigger={trigger}>\n      {\n        ({ close }) => <>\n          <div style={{ marginTop: '8px' }}></div>\n          <AddMenuContent createBlock={createBlock} types={types} close={close} />\n        </>\n      }\n    </PopoverMenu>\n  }\n\n  return null\n}\n\nexport {\n  AddMenuContent,\n  AddMenu as default,\n}\n","import { useState, useCallback, useEffect } from 'react'\n\nimport classes from './Header.module.css'\n\nimport {\n  Menu as MenuIcon,\n  MoreHoriz as MoreHorizIcon,\n  Home as HomeIcon,\n} from '@mui/icons-material'\n\nimport { Link } from 'react-router-dom'\n\nimport { useSidebarContext } from './Sidebar.js'\nimport ViewerAuto from './view/ViewerAuto.js'\nimport PopoverMenu from './PopoverMenu.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlocks_Query, getParentBlocks_Query } from '../graphql/queries'\n\nexport default function Header({ title, block = {}, rightActions, notificationBanner }) {\n  const { open, toggleSidebar } = useSidebarContext()\n  const apollo_client = useApolloClient()\n\n  const blockId = block ? block._id : null\n  const parentId = block ? block.parent : null\n\n  const [parentBlocks, setParentBlocks] = useState([])\n  const [siblingBlocks, setSiblingBlocks] = useState([])\n\n  const loadParentBlocks = useCallback(blockId => {\n    apollo_client.query({\n      query: getParentBlocks_Query,\n      variables: {\n        _id: blockId,\n      },\n    })\n      .then(async ({ data }) => {\n        if (typeof data.error === 'string' || !data.blocks) {\n          console.error(data.error)\n          setParentBlocks([])\n        }else{\n          const parentBlocksSorted = (data.blocks || [])\n            .sort((a, b) => b.computed.sort - a.computed.sort)\n\n          setParentBlocks(parentBlocksSorted)\n        }\n      })\n      .catch(async error => {\n        console.error('error', error)\n        setParentBlocks([])\n      })\n  }, [apollo_client, setParentBlocks])\n\n  const loadSiblingBlocks = useCallback((parentId, blockId) => {\n    apollo_client.query({\n      query: getBlocks_Query,\n      variables: {\n        roots: [parentId || blockId],\n        types: ['page', 'person', 'redirect'],\n        archived: false,\n      },\n    })\n      .then(async ({ data }) => {\n        if (typeof data.error === 'string' || !data.blocks) {\n          console.error(data.error)\n          setSiblingBlocks([])\n        }else{\n          setSiblingBlocks(\n            (data.blocks || [])\n              .filter(block => block._id !== blockId)\n          )\n        }\n      })\n      .catch(async error => {\n        console.error('error', error)\n        setSiblingBlocks([])\n      })\n  }, [apollo_client, setSiblingBlocks])\n\n  useEffect(() => {\n    if (blockId) {\n      loadParentBlocks(blockId)\n      loadSiblingBlocks(parentId, blockId)\n    }\n  }, [blockId, parentId, loadParentBlocks, loadSiblingBlocks])\n\n  const leftActions = <>\n    {\n      !open\n      ? <button onClick={toggleSidebar} className=\"text hasIcon\" style={{ margin: '0' }}>\n          <MenuIcon className=\"icon\" />\n        </button>\n      : null\n    }\n\n    <div style={{ flexGrow: '1' }}>\n      <Link to=\"/\">\n        <button className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n          <HomeIcon style={{ verticalAlign: 'middle' }} />\n        </button>\n      </Link>\n      <span style={{ margin: 'var(--basis_x2)', opacity: 'var(--alpha)' }}>/</span>\n\n    {\n      blockId\n      && parentBlocks.length > 0\n        ? <>\n          <PopoverMenu\n            trigger={triggerProps => (\n              <button {...triggerProps} className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n                <MoreHorizIcon style={{ verticalAlign: 'middle' }} />\n              </button>\n            )}\n          >\n            <div style={{\n              padding: 'var(--basis_x2)',\n            }}>\n              {\n                parentBlocks\n                .map((block) => {\n                  return <ViewerAuto\n                    key={block._id}\n                    block={block}\n                    size=\"line\"\n                  />\n                })\n              }\n            </div>\n          </PopoverMenu>\n          <span style={{ margin: 'var(--basis_x2)', opacity: 'var(--alpha)' }}>/</span>\n        </>\n        : null\n    }\n\n    {\n      siblingBlocks.length > 0\n        ? <PopoverMenu\n            trigger={triggerProps => (\n              <button {...triggerProps} className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n                <span style={{ fontWeight: 'bold' }}>\n                  {title}\n                </span>\n              </button>\n            )}\n          >\n            <div style={{\n              padding: 'var(--basis_x2)',\n            }}>\n              {\n                siblingBlocks\n                .map((block) => {\n                  return <ViewerAuto\n                    key={block._id}\n                    block={block}\n                    size=\"line\"\n                  />\n                })\n              }\n            </div>\n          </PopoverMenu>\n        : <span style={{ fontWeight: 'bold' }}>\n            {title}\n          </span>\n    }\n    </div>\n  </>\n\n  return <header className={classes.header}>\n    <div className={classes.headerBar}>\n      {leftActions}\n      {rightActions}\n    </div>\n    {\n      !!notificationBanner\n        ? <div className={classes.notificationBanner}>{notificationBanner}</div>\n        : null\n    }\n  </header>\n}\n","import { useState, useCallback } from 'react'\n\nimport {\n  MenuItem,\n} from '@mui/material'\n\nimport PopoverMenu from '../PopoverMenu.js'\n\nimport MdiIcon from '@mdi/react'\nimport {\n  mdiTranslate,\n} from '@mdi/js'\n\nconst locales = {\n  _: '??',\n  en: 'English',\n  de: 'Deutsch',\n  es: 'Espaol',\n  pt: 'Portugus',\n  fr: 'Franais',\n  it: 'Italiano',\n  nl: 'Nederlands', // Dutch\n  da: 'Dansk', // Danish\n  sv: 'Svenska', // Swedish\n  nb: 'Norsk bokml', // Norwegian\n  fi: 'Suomi', // Finish\n  mt: 'Malti', // Maltese\n  pl: 'Jzyk polski', // Polish\n  ru: ' ', // Russian\n  bg: ' ', // Bulgarian\n  tr: 'Trke',\n  ar: '', // Arabic\n  el: '', // Greek\n  ro: 'limba romn', // Romanian\n  sl: 'slovenina', // Slovenian\n  // uk: ' ', // Ukrainian\n  // cy: 'Cymraeg', // Welsh\n}\n\nconst localesArray = Object.entries(locales)\n.map(([code, nativeName]) => ({code, nativeName}))\n\nconst defaultOptions = Object.keys(locales)\n\nfunction LocaleSelect({\n  defaultValue,\n  onChange,\n  options = defaultOptions,\n}) {\n  if (\n    defaultValue === null\n    || defaultValue === undefined\n    || defaultValue === ''\n    || locales.hasOwnProperty(defaultValue) === false\n  ) {\n    defaultValue = '_'\n  }\n\n  const [changedLocale, setChangedLocale] = useState(defaultValue)\n\n  const handleLocaleChange = useCallback(newLocale => {\n    setChangedLocale(newLocale)\n    \n    if (newLocale === '_') {\n      newLocale = null\n    }\n\n    if (onChange) {\n      onChange(newLocale)\n    }\n  }, [ setChangedLocale, onChange ])\n  \n  return (\n    <PopoverMenu\n      trigger={(triggerProps, { isOpen }) => (\n        <button\n          {...triggerProps}\n          className=\"default hasIcon\"\n          style={{\n            margin: '0',\n            flexShrink: '0',\n          }}\n        >\n          <span style={{ width: '100%', textAlign: 'start' }}>\n          {\n            changedLocale === '_'\n            ? <MdiIcon\n              path={mdiTranslate}\n              className=\"icon\"\n            />\n            : changedLocale.toUpperCase()\n          }\n          </span>\n          <span style={{\n            marginLeft: 'var(--basis)',\n            lineHeight: '1',\n            verticalAlign: 'text-top',\n          }}>\n            { isOpen ? '' : '' }\n          </span>\n        </button>\n      )}\n      paperProps={{\n        sx: {\n          maxHeight: '300px',\n        }\n      }}\n    >\n      {({ close }) => (\n        <div style={{\n          padding: 'var(--basis_x2) 0',\n        }}>\n          {\n            localesArray\n            .filter(({ code }) => options.includes(code))\n            .map(({ code, nativeName }) => (\n              <MenuItem\n                key={code}\n                onClick={() => {\n                  handleLocaleChange(code)\n                  close()\n                }}\n                className=\"roundMenuItem\"\n                selected={code === changedLocale}\n              >\n                {code === '_' ? nativeName : `${code.toUpperCase()}  ${nativeName}`}\n              </MenuItem>\n            ))\n          }\n        </div>\n      )}\n    </PopoverMenu>    \n  )\n}\n\nexport default LocaleSelect\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { archiveBlock_Mutation, unarchiveBlock_Mutation } from '../graphql/mutations.js'\n\nfunction useArchiveBlock() {\n  const apollo_client = useApolloClient()\n\n  const handleArchiveBlock = useCallback(({ _id, archive }) => {\n    return apollo_client.mutate({\n      mutation: archive ? archiveBlock_Mutation : unarchiveBlock_Mutation,\n      variables: { _id }\n    })\n  }, [ apollo_client ])\n\n  return handleArchiveBlock\n}\n\nexport default useArchiveBlock\n","import { useRef, useState, useCallback } from 'react'\n\nimport {\n  Divider,\n  Menu,\n  MenuItem,\n  ListItemIcon,\n  ListSubheader,\n} from '@mui/material'\n\nimport {\n  Close as CloseIcon,\n  ArrowRight as ArrowRightIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../fluent/Localized.js'\n\n// INFO: Some code is copied from: https://github.com/azmenak/material-ui-nested-menu-item/blob/master/src/index.tsx\n\nexport default function SubMenu ({\n  disabled = false,\n  parentMenuIsOpen = true,\n  label = '',\n  triggerProps = {},\n  header = null,\n  MenuListProps = {},\n  position = 'right',\n  onOpen = () => {},\n  children,\n}) {\n  const triggerRef = useRef(null)\n  const [isSubMenuOpen, setIsSubMenuOpen] = useState(false)\n  const open = isSubMenuOpen && parentMenuIsOpen\n\n  const toggleSubmenu = useCallback(() => {\n    if (disabled !== true) {\n      const newOpen = !open\n      setIsSubMenuOpen(newOpen)\n      if (newOpen === true) {\n        onOpen()\n      }\n    }\n  }, [ setIsSubMenuOpen, open, onOpen, disabled ])\n\n  const closeSubmenu = useCallback(() => {\n    setIsSubMenuOpen(false)\n  }, [ setIsSubMenuOpen ])\n\n  return <>\n    <MenuItem\n      {...triggerProps}\n\n      disabled={disabled}\n\n      ref={triggerRef}\n      onClick={toggleSubmenu}\n      className=\"roundMenuItem\"\n      style={{\n        display: 'flex',\n        justifyContent: 'space-between',\n        ...triggerProps.style,\n      }}\n    >\n      <div style={{ display: 'flex' }}>\n        {label}\n      </div>\n      <ArrowRightIcon style={{ marginRight: '-10px' }} />\n    </MenuItem>\n    <Menu\n      // Set pointer events to 'none' to prevent the invisible Popover div from capturing events for clicks and hovers\n      style={{ pointerEvents: 'none' }}\n      anchorEl={triggerRef.current}\n      anchorOrigin={{\n        vertical: 'top',\n        horizontal: (position === 'right' ? 'right' : 'left'),\n      }}\n      transformOrigin={{\n        vertical: 'top',\n        horizontal: (position === 'right' ? 'left' : 'right'),\n      }}\n      open={open}\n      autoFocus={false}\n      disableAutoFocus\n      disableEnforceFocus\n      onClose={closeSubmenu}\n      sx={{\n        marginTop: '-8px', // align with parent menu\n      }}\n      MenuListProps={{\n        ...MenuListProps,\n        sx: {\n          maxWidth: 380,\n          maxHeight: 'calc(100vh - 32px)',\n          overflow: 'auto',\n          background: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n          ...MenuListProps.sx,\n        },\n      }}\n    >\n      <div style={{pointerEvents: 'auto'}}>\n        {\n          header !== null\n            ? <ListSubheader\n                style={{\n                  whiteSpace: 'nowrap',\n                  lineHeight: '1',\n                  margin: '0',\n                  padding: '4px 16px 12px',\n                  backgroundColor: 'var(--background-contrast)',\n                  color: 'var(--on-background)',\n                }}\n              >\n                {header}\n              </ListSubheader>\n            : null\n        }\n\n        {children}\n\n        <Divider style={{opacity: 0.2}} />\n\n        <MenuItem className=\"roundMenuItem\" style={{marginTop:'8px'}} onClick={closeSubmenu}>\n          <ListItemIcon>\n            <CloseIcon />\n          </ListItemIcon>\n          <Localized id=\"block_menu_close_menu\" />\n        </MenuItem>\n      </div>\n    </Menu>\n  </>\n}\n","import { useCallback, useState } from 'react'\n\nimport {\n  Link,\n  useNavigate,\n} from 'react-router-dom'\n\nimport {\n  MenuItem,\n  Divider,\n  ListItemIcon,\n  ListItemText,\n  ListItem,\n} from '@mui/material'\n\nimport {\n  Archive as ArchiveIcon,\n  Unarchive as UnarchiveIcon,\n\n  Visibility as VisibilityIcon,\n  VisibilityOff as VisibilityOffIcon,\n  // Delete as DeleteIcon,\n  // VerticalAlignTop as VerticalAlignTopIcon,\n  // VerticalAlignBottom as VerticalAlignBottomIcon,\n  Add as AddIcon,\n  RepeatSharp as RepeatIcon,\n  // RemoveCircleSharp as RemoveCircleIcon,\n\n  InsertDriveFileSharp as PageIcon,\n  LinkSharp as RedirectIcon,\n  // PersonSharp as PersonIcon,\n  Crop75Sharp as ButtonIcon,\n  NotesSharp as TextIcon,\n  // CodeSharp as CodeIcon,\n  Remove as DividerIcon,\n  // CheckBox as CheckboxIcon,\n\n  PreviewSharp as ViewIcon,\n  EditSharp as EditIcon,\n\n  FormatSizeSharp as TextStyleIcon,\n  PaletteSharp as ColorIcon,\n  CircleSharp as ColorSwatchIcon,\n} from '@mui/icons-material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport useArchiveBlock from '../../hooks/useArchiveBlock.js'\nimport useUser from '../../hooks/useUser.js'\n\nimport PopoverMenu from '../PopoverMenu.js'\nimport SubMenu from '../SubMenu.js'\nimport { AddMenuContent } from './AddMenu.js'\n\nimport { saveBlock_Mutation, moveBlock_Mutation } from '../../graphql/mutations.js'\nimport useMutation from '../../hooks/useMutation.js'\n\nconst typeIcons = {\n  button: <ButtonIcon />,\n  text: <TextIcon />,\n  // checkbox: <CheckboxIcon />,\n  // code: <CodeIcon />,\n  divider: <DividerIcon />,\n  page: <PageIcon />,\n  redirect: <RedirectIcon />,\n}\n\nconst defaultTypeOptions = [\n  'button',\n  'text',\n  // 'checkbox',\n  // 'code',\n  'divider',\n  'page',\n  'redirect',\n]\n\nconst colorOptions = {\n  default: 'var(--on-background)',\n  yellow: 'var(--yellow)',\n  green: 'var(--green)',\n  red: 'var(--red)',\n  blue: 'var(--blue)',\n}\nconst colorOptionsKeys = Object.keys(colorOptions)\nfunction getColor (color) {\n  if (colorOptions.hasOwnProperty(color)) {\n    return colorOptions[color]\n  } else {\n    const {\n      color: renderedColor\n    } = getBlockColor({\n      properties: {\n        color,\n      },\n    })\n\n    if (renderedColor) {\n      return renderedColor\n    }\n  }\n  \n  return color\n}\n\nfunction BlockMenu ({\n  block = {},\n  getString,\n\n  trigger,\n  onToogle,\n\n  setProperty,\n  setType,\n  typeOptions = defaultTypeOptions,\n\n  onRemoveRow = null,\n  addRowBefore = null,\n  // addRowAfter = null,\n  onArchivedToggle = null,\n  onReloadContext = null,\n}) {\n  const { loggedIn, userroles } = useUser()\n\n  const { _id = '', type = '', properties = {}, computed = {} } = block\n  const {\n    active = true,\n    text_style = null,\n    color = null,\n  } = properties\n  const {\n    roles = [],\n  } = (computed === null ? {} : computed)\n  const canEdit = loggedIn && (userroles.includes('admin') || roles.includes('owner') || roles.includes('editor'))\n\n  const [archived, setArchived] = useState(properties.archived === true)\n  const archiveBlock = useArchiveBlock()\n\n  // const handleAddRowBefore = useCallback(() => {\n  //\n  //   // const newBlock = {\n  //   //   type,\n  //   // }\n  //\n  //   const newBlockId = ''\n  //\n  //   addRowBefore({\n  //     blockId: newBlockId,\n  //   })\n  // }, [ addRowBefore ])\n\n\n  const mutationFunction = useMutation()\n  const navigate = useNavigate()\n  const createChildBlock = useCallback(async newBlock => {\n    try {\n      if (newBlock) {\n        const { saveBlock: newBlockId } = await mutationFunction({\n          mutation: saveBlock_Mutation,\n          variables: {\n            block: newBlock,\n          },\n        })\n        if (newBlockId !== null) {\n          await mutationFunction({\n            mutation: moveBlock_Mutation,\n            variables: {\n              movingBlockId: newBlockId,\n              newParentId: _id,\n              newIndex: 0,\n            },\n          })\n          if (typeof onReloadContext === 'function') {\n            onReloadContext()\n          }\n          navigate(`/${newBlockId}/edit`)\n        }\n      }\n    } catch (error) {\n      console.error(error)\n    }\n  }, [ mutationFunction, _id, onReloadContext, navigate ])\n\n  const toggleArchiveBlock = useCallback(() => {\n    const newArchived = !archived\n    archiveBlock({ _id: block._id, archive: newArchived })\n      .then(() => {\n        setArchived(newArchived)\n        if (typeof onArchivedToggle === 'function') {\n          onArchivedToggle(newArchived)\n        }\n        if (typeof onReloadContext === 'function') {\n          onReloadContext()\n        }\n      })\n      .catch(console.error)\n  }, [archiveBlock, setArchived, archived, block, onArchivedToggle, onReloadContext])\n\n  const toggleActive = useCallback(() => {\n    if (typeof setProperty === 'function') {\n      setProperty('active', !active)\n    }\n  }, [ active, setProperty ])\n\n  const metadata = block.metadata || {}\n\n  let {\n    color: renderedColor\n  } = getBlockColor(block)\n\n  if (!renderedColor) {\n    renderedColor = 'transparent'\n  }\n\n  return <PopoverMenu\n    trigger={trigger}\n    onToogle={onToogle}\n  >\n    {({ open }) => (<div>\n\n      <div style={{ height: '8px' }}></div>\n\n      {\n        (\n          canEdit\n          && typeof setType === 'function'\n          && Array.isArray(typeOptions)\n          && typeOptions.length > 0\n        )\n        && <>\n          <SubMenu\n            disabled={type === 'person'}\n            parentMenuIsOpen={open}\n            label={<>\n              <ListItemIcon>\n                <RepeatIcon />\n              </ListItemIcon>\n              <Localized id=\"block_menu_choose_type_label\" />\n            </>}\n            header={<Localized id=\"block_menu_choose_type_label\" />}\n          >\n            {\n              typeOptions\n              .map(typeName => (\n                <MenuItem\n                  key={typeName}\n                  selected={typeName === type}\n                  onClick={() => setType(typeName)}\n                  className=\"roundMenuItem\"\n                >\n                  <ListItemIcon>\n                    {typeIcons[typeName]}\n                  </ListItemIcon>\n                  {getString(`block_menu_type_label_${typeName}`, typeName)}\n                </MenuItem>\n              ))\n            }\n          </SubMenu>\n          <Divider style={{ opacity: 0.2, marginTop: '8px', marginBottom: '8px' }} />\n        </>\n      }\n\n      {\n        (\n          canEdit\n          && typeof setProperty === 'function'\n        )\n        && <SubMenu\n          parentMenuIsOpen={open}\n          label={<>\n            <ListItemIcon>\n              <ColorIcon\n                style={{\n                  color: getColor(color),\n                }}\n              />\n            </ListItemIcon>\n            <Localized id=\"block_menu_choose_color_label\" />\n          </>}\n          header={<Localized id=\"block_menu_choose_color_label\" />}\n        >\n          {\n            colorOptionsKeys\n            .map(thisColor => (\n              <MenuItem\n                key={thisColor}\n                selected={thisColor === 'default' ? color === null : color === thisColor}\n                onClick={() => setProperty('color', thisColor === 'default' ? null : thisColor)}\n                className=\"roundMenuItem\"\n              >\n                <ListItemIcon>\n                  <ColorSwatchIcon\n                    style={{\n                      color: getColor(thisColor),\n                    }}\n                  />\n                </ListItemIcon>\n                {thisColor}\n              </MenuItem>\n            ))\n          }\n\n          <MenuItem\n            className=\"roundMenuItem\"\n            selected={color !== null && !colorOptionsKeys.includes(color)}\n          >\n            <ListItemIcon>\n              <ColorSwatchIcon\n                style={{\n                  color: renderedColor,\n                }}\n              />\n            </ListItemIcon>\n            <input\n              key={colorOptionsKeys.includes(color) ? color : 'custom'}\n              type=\"text\"\n              placeholder=\"#FFFFFF\"\n              defaultValue={color}\n              onBlur={e => setProperty('color', e.target.value)}\n              style={{\n                width: '160px',\n                margin: '0 calc(-1 * var(--basis)) 0 0',\n              }}\n            />\n          </MenuItem>\n        </SubMenu>\n      }\n\n      {\n        (\n          canEdit\n          && typeof setProperty === 'function'\n          && type === 'text'\n        )\n        && <SubMenu\n          parentMenuIsOpen={open}\n          label={<>\n            <ListItemIcon>\n              <TextStyleIcon />\n            </ListItemIcon>\n            <Localized id=\"block_menu_choose_text_style_label\" />\n          </>}\n          header={<Localized id=\"block_menu_choose_text_style_label\" />}\n        >\n          {\n            [\n              // 'h1', // title\n              'h2', // heading\n              'h3', // subheading\n              'body', // body text. This is saved as null.\n              // 'caption',\n            ]\n            .map(thisStyle => (\n              <MenuItem\n                key={thisStyle}\n                selected={thisStyle === 'body' ? text_style === null : text_style === thisStyle}\n                onClick={() => setProperty('text_style', thisStyle === 'body' ? null : thisStyle)}\n                className=\"roundMenuItem\"\n              >\n                {getString(`block_menu_text_style_label_${thisStyle}`, thisStyle)}\n              </MenuItem>\n            ))\n          }\n        </SubMenu>\n      }\n\n      {\n        (\n          canEdit\n          && typeof setProperty === 'function'\n        )\n        && <Divider style={{opacity: 0.2, marginTop:'8px', marginBottom:'8px'}} />\n      }\n\n      {/*\n        addRowBefore\n        && <MenuItem onClick={handleAddRowBefore}>\n          <ListItemIcon>\n            <VerticalAlignTopIcon />\n          </ListItemIcon>\n          <Localized id=\"block_menu_add_before\" />\n        </MenuItem>\n      */}\n\n      {/*\n        addRowAfter\n        && <MenuItem onClick={addRowAfter}>\n          <ListItemIcon>\n            <VerticalAlignBottomIcon />\n          </ListItemIcon>\n          <Localized id=\"block_menu_add_after\" />\n        </MenuItem>\n      */}\n\n      {\n        canEdit\n        && <SubMenu\n          parentMenuIsOpen={open}\n          label={<>\n            <ListItemIcon>\n              <AddIcon />\n            </ListItemIcon>\n            <Localized id=\"block_menu_create_child_block\" />\n          </>}\n        >\n          <AddMenuContent createBlock={createChildBlock} />\n        </SubMenu>\n      }\n\n      {\n        (\n          canEdit\n          && typeof setProperty === 'function'\n        )\n        && <MenuItem className=\"roundMenuItem\" onClick={toggleActive}>\n          <ListItemIcon>\n            {\n              active\n              ? <VisibilityOffIcon />\n              : <VisibilityIcon />\n            }\n          </ListItemIcon>\n\n          <ListItemText\n            primary={<span>{\n              active\n              ? <Localized id=\"block_menu_hide\" />\n              : <Localized id=\"block_menu_show\" />\n            }</span>}\n            secondary={<span style={{ whiteSpace: 'normal' }}><Localized id=\"block_menu_hide_show_description\" /></span>}\n          />\n          \n        </MenuItem>\n      }\n\n      {\n        (\n          canEdit\n          && typeof onArchivedToggle === 'function'\n        )\n        && <MenuItem className=\"roundMenuItem\" onClick={toggleArchiveBlock}>\n          <ListItemIcon>\n            {\n              archived === true\n              ? <UnarchiveIcon />\n              : <ArchiveIcon />\n            }\n          </ListItemIcon>\n          {\n            archived === true\n            ? <Localized id=\"block_menu_unarchive\" />\n            : <Localized id=\"block_menu_archive\" />\n          }\n        </MenuItem>\n      }\n            \n      {\n        canEdit\n        && <Divider style={{ opacity: 0.2, marginTop: '8px', marginBottom: '8px' }} />\n      }\n\n      {\n        (typeof _id === 'string' && _id !== '')\n        && <>\n          <MenuItem component={Link} to={`/${_id}/view`} className=\"roundMenuItem\" style={{ marginTop: '8px' }}>\n            <ListItemIcon>\n              <EditIcon />\n            </ListItemIcon>\n            <Localized id=\"view_block\" />\n          </MenuItem>\n\n          {\n            canEdit\n            && <MenuItem component={Link} to={`/${_id}/edit`} className=\"roundMenuItem\">\n              <ListItemIcon>\n                <ViewIcon />\n              </ListItemIcon>\n              <Localized id=\"edit_block\" />\n            </MenuItem>\n          }\n\n          <Divider style={{opacity: 0.2, marginTop:'8px', marginBottom:'8px' }} />\n        </>\n      }\n\n      {/*\n      <ListItem sx={{ paddingTop: '0', paddingBottom: '0' }}>\n        <ListItemText\n          primary={<Localized id=\"block_menu_info_created\" />}\n          secondary={(metadata.created || '').replace(/[TZ]/g, ' ')}\n        />\n      </ListItem>\n      */}\n      <ListItem sx={{ paddingTop: '0', paddingBottom: '0' }}>\n        <ListItemText\n          primary={<span><Localized id=\"block_menu_info_modified\" /></span>}\n          secondary={<span>{(metadata.modified || '').replace(/[TZ]/g, ' ')}</span>}\n        />\n      </ListItem>\n      <ListItem sx={{ paddingTop: '0', paddingBottom: '0' }}>\n        <ListItemText\n          primary={<span><Localized id=\"block_menu_info_id\" /></span>}\n          secondary={<span>{_id}</span>}\n        />\n      </ListItem>\n\n    </div>)}\n  </PopoverMenu>\n}\n\nexport default withLocalization(BlockMenu)\n","const { negotiateLanguages } = require('@fluent/langneg')\n\nfunction fluentByObject(object = {}, userLocales = ['en']){\n  const supportedLocales = Object.keys(object)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return object[lookupedLocale[0]]\n}\n\nfunction fluentByArray(array = [], userLocales = ['en'], key = 'locale') {\n  const supportedLocales = array.map(item => item[key]).filter(Boolean)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return array.filter(item => item[key] === lookupedLocale[0])\n}\n\nfunction fluentByAny(any = '', userLocales = ['en'], fallback = '') {\n  if (Array.isArray(any)) {\n    const result = fluentByArray(any, userLocales)\n    if (Array.isArray(result) && result.length > 0) {\n      any = result[0].value\n    }\n  } else if (typeof any === 'object') {\n    any = fluentByObject(any, userLocales)\n  }\n  if (typeof any !== 'string') {\n    any = fallback\n  }\n  return any\n}\n\nmodule.exports = {\n  fluentByObject,\n  fluentByArray,\n  fluentByAny,\n}\n","import { useCallback } from 'react'\n\nimport { useLocalization } from '../fluent/Localized.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlock_Query } from '../graphql/queries'\n\nimport { useSnackbar } from 'notistack'\n\nfunction useLoadBlock() {\n  const { getString } = useLocalization()\n\n  const apollo_client = useApolloClient()\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar()\n\n  const handleLoadBlock = useCallback(_id => {\n    return new Promise(final_resolve => {\n    let snackbarKey = null\n\n    if (!_id || _id === '') {\n      final_resolve({\n        type: 'text',\n      })\n    } else {\n      const loadingDataPromise = new Promise(resolve => {\n        apollo_client.query({\n          query: getBlock_Query,\n          variables: {\n            _id,\n          },\n        })\n          .then(async ({ data }) => {\n            resolve('got-data')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            if (typeof data.error === 'string' || !data.block) {\n              if (data.error === 'no_edit_permission') {\n                enqueueSnackbar(getString('path_editor_edit_permission_error'), {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 5000,\n                })\n              } else {\n                enqueueSnackbar('' + data.error, {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 5000,\n                })\n              }\n            }else{\n              const loadedBlock = data.block\n              final_resolve(loadedBlock)\n            }\n          })\n          .catch(async error => {\n            console.error('error', error)\n            resolve('got-error')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            enqueueSnackbar('[could not load data] '+error.message, {\n              variant: 'error',\n              preventDuplicate: true,\n              autoHideDuration: 2000,\n            })\n          })\n      })\n\n      // Show a loading-info-snackbar if loading the data takes too long.\n      Promise.race([\n        new Promise(resolve => {\n          setTimeout(() => {\n            resolve('show-loading')\n          }, 300)\n        }),\n        loadingDataPromise,\n      ])\n        .then(response => {\n          if (response === 'show-loading') {\n            snackbarKey = enqueueSnackbar(getString('path_editor_status_started_loading'), {\n              persist: true,\n              preventDuplicate: true,\n            })\n          }\n        })\n        .catch(error => console.error)\n    }\n    })\n  }, [\n    enqueueSnackbar,\n    closeSnackbar,\n    apollo_client,\n    getString,\n  ])\n\n  return handleLoadBlock\n}\n\nexport default useLoadBlock\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { blockMatchesRoles_Query } from '../graphql/queries'\n\nexport default function useBlockMatchesRoles() {\n  const apollo_client = useApolloClient()\n\n  const handleLoadRoles = useCallback((_id, roles = []) => {\n    return new Promise(resolve => {\n      if (!_id || _id === '') {\n        resolve(false)\n      } else {\n        apollo_client.query({\n          query: blockMatchesRoles_Query,\n          variables: {\n            _id,\n            roles,\n          },\n        })\n          .then(async ({ data }) => {\n            if (data.hasOwnProperty('blockMatchesRoles')) {\n              resolve(data.blockMatchesRoles)\n            }else{\n              resolve(false)\n            }\n          })\n          .catch(async error => {\n            console.error('error', error)\n            resolve(false)\n          })\n      }\n    })\n  }, [ apollo_client ])\n\n  return handleLoadRoles\n}\n","\nimport {\n  Login as LoginIcon,\n} from '@mui/icons-material'\n\nimport Localized from '../fluent/Localized.js'\n\nexport default function LoginScreen () {\n  return <>\n    <h1>Login to view content</h1>\n    <a href={`${window.domains.backend}login?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n      <button className=\"text hasIcon\" style={{ margin: 'var(--basis_x4) 0 0 0' }}>\n        <LoginIcon className=\"icon\" />\n        <span>\n          <Localized id=\"login\" />\n        </span>\n      </button>\n    </a>\n  </>\n}\n\nexport function ErrorPage ({ errorName }) {\n  let title = 'Unknown Error'\n  let description = ''\n  let buttons = ''\n\n  if (errorName === 'no_access') {\n    title = `You don't have access to this page!`\n    \n    description = <>\n      <h2>If you are not logged in:</h2>\n      You propably need to login with a Volt Europa account to view this page. Contact your local community lead if you are unsure about your Volt Europa account.<br/>\n\n      <h2>If you are logged in:</h2>\n        You propably don't have access to this page.\n    </>\n\n    buttons = <a href={`${window.domains.backend}login?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n      <button className=\"text hasIcon\" style={{ margin: 'var(--basis_x4) 0 0 0' }}>\n        <LoginIcon className=\"icon\" />\n        <span>\n          <Localized id=\"login\" />\n        </span>\n      </button>\n    </a>\n  } else if (errorName === 'not_found') {\n    title = 'We could not find the requested URL'\n    description = \"The URL you requested does currently not exist. Did you type the URL correctly?\"\n\n    buttons = <a href={`${window.domains.backend}login?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n      <button className=\"text hasIcon\" style={{ margin: 'var(--basis_x4) 0 0 0' }}>\n        <LoginIcon className=\"icon\" />\n        <span>\n          <Localized id=\"login\" />\n        </span>\n      </button>\n    </a>\n  }\n\n  \n  return <>\n    <h1>{title}</h1>\n    <p>{description}</p>\n    {buttons}\n\n    <br/> {/* Spacing */}\n    <br/>\n    <br/>\n    <br/>\n\n    <p>\n      Please contact <a href=\"mailto:thomas.rosen@volteuropa.org\">thomas.rosen@volteuropa.org</a> if you think this is a bug.<br/>\n      Go to <a href=\"https://volteuropa.org\">volteuropa.org</a> for information about the Pan-European Political Movement.\n    </p>\n  </>\n\n  // <hr/>\n  // <p>\n  //   <a href=\"https://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_client_errors\">HTTP Error Code</a>: {errorCode}\n  // </p>\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__3mObx\",\"headerBar\":\"Header_headerBar__2YU41\",\"notificationBanner\":\"Header_notificationBanner__104SP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"drag_over\":\"DataTransmat_drag_over__3XVzh\",\"drag_active\":\"DataTransmat_drag_active__2nwCM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"ViewerLine_icon__DvsyX\",\"square\":\"ViewerLine_square__3knjg\",\"round\":\"ViewerLine_round__1pnCx\",\"title\":\"ViewerLine_title__35XNW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"ViewerAuto_root__1p6KG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"Editor_app__3WzMm\",\"spine_aligned\":\"Editor_spine_aligned__1h8Ra\",\"contentWrapper\":\"Editor_contentWrapper__1cY6-\",\"editor\":\"Editor_editor__2hX0g\",\"loadingContent\":\"Editor_loadingContent__2fqdK\",\"editor_form_row\":\"Editor_editor_form_row__17Pul\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"PageEditor_app__26Zo3\",\"spine_aligned\":\"PageEditor_spine_aligned__2i6Wu\",\"contentWrapper\":\"PageEditor_contentWrapper__WlUIr\",\"editor\":\"PageEditor_editor__U1pPN\",\"type_redirect\":\"PageEditor_type_redirect__2KPht\",\"loadingContent\":\"PageEditor_loadingContent__1YK7g\",\"editor_form_row\":\"PageEditor_editor_form_row__j4vjp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog\":\"SharingEditor_dialog__22jfY\",\"backdrop\":\"SharingEditor_backdrop__1Gra9\",\"inputWrapper\":\"SharingEditor_inputWrapper__1UyBD\",\"input\":\"SharingEditor_input__brkXK\",\"actions\":\"SharingEditor_actions__2zz6x\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"rebuild_textarea\":\"HtmlInput_rebuild_textarea__ZfRzZ\",\"show_placeholder\":\"HtmlInput_show_placeholder__hM8g2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog\":\"TranslationEditor_dialog__YL0sv\",\"backdrop\":\"TranslationEditor_backdrop__hfIzh\",\"inputWrapper\":\"TranslationEditor_inputWrapper__3aVMH\",\"input\":\"TranslationEditor_input__3U2bK\",\"actions\":\"TranslationEditor_actions__3dTaz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input_with_local\":\"InputWithLocal_input_with_local__3qqYa\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"Repeater_row__1ODoF\",\"middleActions\":\"Repeater_middleActions__3nRoT\",\"trigger\":\"Repeater_trigger__1VtG5\",\"content\":\"Repeater_content__110R9\",\"form\":\"Repeater_form__2N6kw\",\"item\":\"Repeater_item__2OI78\",\"inlineRowButton\":\"Repeater_inlineRowButton__uqk8Y\",\"dragHandleButton\":\"Repeater_dragHandleButton__2eLww\",\"addRowButton\":\"Repeater_addRowButton__3huSP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"error\":\"FancyInput_error__2DFWE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog\":\"PermissionsEditor_dialog__2rpyk\",\"backdrop\":\"PermissionsEditor_backdrop__1dRPN\",\"inputWrapper\":\"PermissionsEditor_inputWrapper__4DGsr\",\"input\":\"PermissionsEditor_input__1HyOC\",\"actions\":\"PermissionsEditor_actions__k4oBn\",\"permissionRow\":\"PermissionsEditor_permissionRow__2HaWO\",\"menuButton\":\"PermissionsEditor_menuButton__2jIMI\",\"ownerInfo\":\"PermissionsEditor_ownerInfo__EEKXP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main_headline\":\"PropertiesEditor_main_headline__3wy7R\",\"propertiesFrame\":\"PropertiesEditor_propertiesFrame__1uBEz\",\"properties_row\":\"PropertiesEditor_properties_row__2tX7M\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"coverphoto\":\"CoverphotoPicker_coverphoto__1mWB4\",\"root\":\"CoverphotoPicker_root__3T8t9\",\"coverphotoIsNotSet\":\"CoverphotoPicker_coverphotoIsNotSet__1O3-S\",\"button_wrapper\":\"CoverphotoPicker_button_wrapper__2oEjh\",\"coverphotoIsSet\":\"CoverphotoPicker_coverphotoIsSet__2o24A\",\"iconIsSet\":\"CoverphotoPicker_iconIsSet__D_4uA\",\"changeCoverphotoButton\":\"CoverphotoPicker_changeCoverphotoButton__2GnZD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"IconPicker_root__2okyv\",\"iconIsSet\":\"IconPicker_iconIsSet__SnQwA\",\"coverphotoIsSet\":\"IconPicker_coverphotoIsSet__3m9Dw\",\"icon\":\"IconPicker_icon__JWgfX\",\"iconWrapper\":\"IconPicker_iconWrapper__1zo6g\",\"sizing_pixel\":\"IconPicker_sizing_pixel__3TeE0\",\"iconIsNotSet\":\"IconPicker_iconIsNotSet__1T0Zd\",\"changeIconButton\":\"IconPicker_changeIconButton__TxsdG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"InlineEditorBlock_block__14-zd\",\"block_input\":\"InlineEditorBlock_block_input__2I1iu\",\"form_deactivated\":\"InlineEditorBlock_form_deactivated__2oktp\",\"form_active\":\"InlineEditorBlock_form_active__hi5HC\",\"reorderHandle\":\"InlineEditorBlock_reorderHandle__2_s23\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"ContentEditor_row__JonRI\",\"form\":\"ContentEditor_form__wtoB9\",\"item\":\"ContentEditor_item__3U0XE\",\"inlineRowButton\":\"ContentEditor_inlineRowButton__2pw6r\",\"dragHandleButton\":\"ContentEditor_dragHandleButton__1Y_RP\"};","import React, { useCallback, useRef, useState, useEffect } from 'react'\n\n// import hljs from 'highlight.js/lib/core'\n// import javascript from 'highlight.js/lib/languages/javascript'\n// // import 'highlight.js/styles/github.css'\n// import '../../highlightjs-volt-theme.css'\n\nimport {\n  offset as getCaretOffset,\n  getOffset,\n} from 'caret-pos'\n\nimport classes from './HtmlInput.module.css'\n\n// hljs.registerLanguage('javascript', javascript)\n\nfunction stripHtml(html){\n  // source: https://ourcodeworld.com/articles/read/376/how-to-strip-html-from-a-string-extract-only-text-content-in-javascript\n  // Create a new div element\n  var temporalDivElement = document.createElement(\"div\");\n  // Set the HTML content with the providen\n  temporalDivElement.innerHTML = html;\n  // Retrieve the text property of the element (cross-browser support)\n  return temporalDivElement.textContent || temporalDivElement.innerText || \"\";\n}\n\nfunction getRangeLengthWithLinebreaks(element){\n  element.normalize()\n\n  if (!window.getSelection) {\n    return 0;\n  }\n\n  const selection = window.getSelection()\n  const range = selection.rangeCount > 0 ? selection.getRangeAt(0) : null;\n\n  if (!range) {\n    return 0;\n  }\n\n  const clonedRange = range.cloneRange()\n  clonedRange.selectNodeContents(element)\n  clonedRange.setEnd(range.endContainer, range.endOffset)\n  const content = clonedRange.cloneContents()\n\n  let rangeLength = 0\n  for (const node of content.childNodes) {\n    if (node.nodeType === 3) { // node type = 3 is a text node\n      rangeLength += node.textContent.length\n    } else if (node.nodeType === 1 && node.nodeName === 'BR') { // node type = 1 is an element node\n      rangeLength += 1\n    }\n  }\n\n  clonedRange.detach()\n\n  return rangeLength\n}\n\nfunction getInLineRangeLength(element, whichLine){\n  element.normalize()\n\n  if (!window.getSelection) {\n    return 0;\n  }\n\n  const selection = window.getSelection()\n  const range = selection.rangeCount > 0 ? selection.getRangeAt(0) : null;\n\n  if (!range) {\n    return 0;\n  }\n\n  const clonedRange = range.cloneRange()\n  clonedRange.selectNodeContents(element)\n  clonedRange.setEnd(range.endContainer, range.endOffset)\n  const content = clonedRange.cloneContents()\n\n  let rangeLength = 0\n  if (content.childNodes.length > 0) {\n    if (whichLine === 'first') {\n      if (content.childNodes[0].nodeType === 3) {\n        rangeLength = content.childNodes[0].length\n      } else {\n        rangeLength = 0\n      }\n    } else if (whichLine === 'last') {\n      if (content.childNodes[content.childNodes.length-1].nodeType === 3) {\n        rangeLength = content.childNodes[content.childNodes.length-1].length\n      } else {\n        if (content.childNodes.length > 1) {\n          if (content.childNodes[content.childNodes.length-2].nodeType === 3) {\n            rangeLength = content.childNodes[content.childNodes.length-2].length\n          } else {\n            rangeLength = 0\n          }\n        } else {\n          rangeLength = 0\n        }\n      }\n    }\n  }\n\n  clonedRange.detach()\n\n  return rangeLength\n}\n\nfunction getCaretPosition(element){\n  // get element height without padding and border\n  const cs = getComputedStyle(element)\n  const paddingY = parseFloat(cs.paddingTop) + parseFloat(cs.paddingBottom)\n  const borderY = parseFloat(cs.borderTopWidth) + parseFloat(cs.borderBottomWidth)\n  const elementHeight = element.offsetHeight - paddingY - borderY\n\n  // get caret position\n  const offset = getOffset(element)\n  const caretOffset = getCaretOffset(element)\n  caretOffset.top = caretOffset.top - offset.top\n  caretOffset.left = caretOffset.left - offset.left\n\n  // check if caret is in the first line\n  let inFirstLine = caretOffset.top < caretOffset.height\n\n  // check if caret is in the last line\n  let inLastLine = elementHeight - caretOffset.top < caretOffset.height\n\n  // define caret position from start of text\n  const caretPositionFromStart = getRangeLengthWithLinebreaks(element)\n\n  // calc caret position from end of text\n  let textLength = element.innerText.length ||0\n  if (textLength < 0) {\n    textLength = 0\n  }\n  const caretPositionFromEnd = textLength - caretPositionFromStart\n\n  return {\n    inFirstLine,\n    inLastLine,\n    left: caretOffset.left,\n    top: caretOffset.top,\n    height: caretOffset.height,\n    positionFromLineStart: getInLineRangeLength(element, (inFirstLine ? 'first' : 'last')),\n    positionFromStart: caretPositionFromStart,\n    positionFromEnd: caretPositionFromEnd,\n  }\n}\n\nfunction HtmlInput({\n  type = 'text',\n  defaultValue = '',\n  children,\n  className,\n  onChange,\n  onBlur,\n  onError,\n  linebreaks,\n  style,\n  placeholder = '',\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  ...props\n}) {\n  const inputRef = useRef(null)\n\n  const textRef = useRef('')\n  const textRefValue = textRef.current\n  \n  const [fakeDefaultValue, setFakeDefaultValue] = useState({ __html: '' })\n\n  const updateText = useCallback(defaultValue => {\n\n    let newHtmlValue = stripHtml(defaultValue)\n\n    // if (type === 'code') {\n    //   // const html = hljs.highlightAuto(newHtmlValue, { ignoreIllegals: false })\n    //   const html = hljs.highlight(newHtmlValue, { language: 'javascript', ignoreIllegals: false })\n    //   newHtmlValue = html.value\n    // // } else {\n    // //   newHtmlValue = newHtmlValue\n    // //     // .replace(/\\t/g, '&emsp;')\n    // //     .replace(/</g, '&lt;')\n    // //     .replace(/>/g, '&gt;')\n    // //     // .replace(/\\n/g, '<br />')\n    // }\n\n    textRef.current = defaultValue\n\n    if (fakeDefaultValue.__html !== newHtmlValue) {\n      return setFakeDefaultValue({__html: newHtmlValue})\n    }\n  }, [\n    // type,\n    fakeDefaultValue,\n    setFakeDefaultValue,\n  ])\n\n  useEffect(() => {\n    if (textRefValue !== defaultValue) {\n      updateText(defaultValue)\n    }\n  }, [\n    textRefValue,\n    defaultValue,\n    updateText,\n  ])\n\n  const handleTextChange = useCallback((event) => {\n    let value = event.target.innerHTML || ''\n    // .replace(/&emsp;/g, '\\t')\n    // .replace(/&lt;/g, '<')\n    // .replace(/&gt;/g, '>')\n\n    if (linebreaks === false) {\n      value = value.replace(/<\\/? ?br ?\\/?>/g, ' ')\n    } else {\n      value = value.replace(/<\\/? ?br ?\\/?>/g, '\\n')\n    }\n\n    value = value.trim()\n    textRef.current = value\n\n    if (onChange) {\n      onChange(value)\n    }\n  }, [onChange, linebreaks])\n\n  const handleTextBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur(textRefValue)\n    }\n  }, [onBlur, textRefValue])\n\n  const keyDownHandler = useCallback(event => {\n    if (event.key === 'Enter' && event.shiftKey === true) {\n      // source: StackOverflow (https://stackoverflow.com/a/61237402)\n      if (linebreaks !== false) {\n        document.execCommand('insertLineBreak')\n      }\n      event.preventDefault()\n    } else if (event.key === 'Tab') {\n      document.execCommand('insertText', false, '\\t')\n      event.preventDefault()\n    } else if (event.key === 'ArrowUp') {\n      if (onGoToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inFirstLine) {\n          onGoToPrevInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowLeft') {\n      if (onGoToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inFirstLine && caret.positionFromStart <= 0) {\n          caret.positionFromLineStart = -1\n          onGoToPrevInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowDown') {\n      if (onGoToNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inLastLine) {\n          onGoToNextInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowRight') {\n      if (onGoToNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inLastLine && caret.positionFromEnd <= 1) {\n          caret.positionFromLineStart = 0\n          onGoToNextInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Enter') {\n      if (type === 'code') {\n        if (linebreaks !== false) {\n          document.execCommand('insertLineBreak')\n        }\n        event.preventDefault()\n      } else {\n        if (onSplitText) {\n          const caret = getCaretPosition(inputRef.current)\n\n          const innerText = inputRef.current.innerText\n          const start = innerText.slice(0, caret.positionFromStart)\n          const end = innerText.slice(caret.positionFromStart)\n\n          onSplitText({\n            texts: [start, end],\n          })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Backspace') {\n      if (onMergeToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.positionFromStart === 0 && caret.inFirstLine) {\n          onMergeToPrevInput({\n            caret,\n            text: inputRef.current.innerText,\n          })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Delete') {\n      if (onMergeFromNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.positionFromEnd === 0 && caret.inLastLine) {\n          onMergeFromNextInput({\n            caret,\n            text: inputRef.current.innerText,\n          })\n          event.preventDefault()\n        }\n      }\n    }\n  }, [\n    inputRef,\n    linebreaks,\n    onGoToPrevInput,\n    onGoToNextInput,\n    onSplitText,\n    onMergeToPrevInput,\n    onMergeFromNextInput,\n    type,\n  ])\n\n  useEffect(() => {\n    if (onInputRef) {\n      onInputRef(inputRef)\n    }\n  }, [onInputRef, inputRef])\n\n  const handlePaste = useCallback(event => {\n    // only accept plain text\n\n    // cancel paste\n    event.preventDefault()\n\n    // get text representation of clipboard\n    let text = (event.originalEvent || event).clipboardData.getData('text/plain')\n\n    if (linebreaks === false) {\n      text = text.replace(/\\n/g, ' ')\n    }\n\n    // insert text manually\n    document.execCommand('insertText', false, text)\n  }, [linebreaks])\n\n  // const highlighted = hljs.highlightAuto(text, { ignoreIllegals: true })\n  // language\n  //   ? hljs.highlight(language, content)\n  //   : hljs.highlightAuto(content)\n\n  return <>\n  <div\n    ref={inputRef}\n    onKeyDown={keyDownHandler}\n    onInput={handleTextChange}\n    onBlur={handleTextBlur}\n    onPaste={handlePaste}\n    className={`${classes.rebuild_textarea} ${textRefValue.length === 0 ? classes.show_placeholder : ''} ${className}`}\n    contentEditable={true}\n    dangerouslySetInnerHTML={fakeDefaultValue}\n    style={style}\n    placeholder={placeholder}\n  />\n    {/* <pre className=\"hljs\">\n      <code dangerouslySetInnerHTML={{ __html: highlighted.value }} />\n    </pre> */}\n  </>\n}\n\nexport default HtmlInput\n","import React, { useEffect, useState, useCallback }from 'react'\n\nimport {\n  Modal,\n} from '@mui/material'\nimport {\n  QrCodeSharp as QrCodeIcon,\n  AssessmentSharp as AssessmentIcon,\n  ContentCopySharp as CopyIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../../fluent/Localized.js' // useLocalization\n\nimport classes from './SharingEditor.module.css'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction fallbackCopyTextToClipboard(text) {\n  // Source: https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\n  var textArea = document.createElement(\"textarea\");\n  textArea.value = text;\n\n  // Avoid scrolling to bottom\n  textArea.style.top = \"0\";\n  textArea.style.left = \"0\";\n  textArea.style.position = \"fixed\";\n\n  document.body.appendChild(textArea);\n  textArea.focus();\n  textArea.select();\n\n  try {\n    var successful = document.execCommand('copy');\n    var msg = successful ? 'successful' : 'unsuccessful';\n    console.info('Fallback: Copying text command was ' + msg);\n  } catch (err) {\n    console.error('Fallback: Oops, unable to copy', err);\n  }\n\n  document.body.removeChild(textArea);\n}\n\nfunction copyTextToClipboard(text) {\n  // Source: https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\n  if (!navigator.clipboard) {\n    fallbackCopyTextToClipboard(text);\n    return;\n  }\n  navigator.clipboard.writeText(text).then(function() {\n    console.info('Async: Copying to clipboard was successful!');\n  }, function(err) {\n    console.error('Async: Could not copy text: ', err);\n  });\n}\n\nfunction SharingEditor({\n  defaultBlock = {},\n  open = false,\n  onChange,\n  onClose,\n}) {\n  const [ path, setPath ] = useState('')\n\n  useEffect(() => {\n    const properties = defaultBlock.properties || {}\n    const initialPath = (properties.trigger || {}).path || ''\n\n    setPath(initialPath)\n  }, [ defaultBlock, setPath ])\n\n  const savePath = useCallback(newPath => {\n    const newProperties = {...(defaultBlock.properties || {})}\n\n    if (newPath === '') {\n      if (newProperties.hasOwnProperty('trigger')) {\n        delete newProperties.trigger\n      }\n      if (newProperties.hasOwnProperty('action')) {\n        delete newProperties.action\n      }\n    } else {\n      newProperties.trigger = {\n\t\t  \ttype: 'path',\n\t\t  \tpath: newPath,\n\t\t  }\n\t\t  newProperties.action = {\n\t\t  \ttype: 'render_block',\n\t\t  }\n    }\n\n    setPath(newPath)\n    onChange(newProperties)\n  }, [\n    defaultBlock,\n    onChange,\n    setPath,\n  ])\n\n  const viewStatistics = () => {\n    const a = document.createElement('a')\n    a.href = `https://umami.qiekub.org/share/s0ZHBZbb/volt.link?url=%2F${path}`\n    a.target = '_blank'\n    a.rel = 'noreferrer'\n    a.click()\n  }\n\n  const gotoQrcodePage = () => {\n    const a = document.createElement('a')\n    a.href = `https://qrcode.volt.link/?c=volt.link/${path}`\n    a.target = '_blank'\n    a.rel = 'noreferrer'\n    a.click()\n  }\n\n  const copyUrl = () => {\n    copyTextToClipboard(`https://volt.link/${path}`)\n  }\n\n  if (!open) {\n    return null\n  }\n\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      hideBackdrop={true}\n    >\n      <>\n        <div className={classes.backdrop} onClick={onClose}></div>\n\n        <div className={classes.dialog}>\n\n            <h1 style={{ margin: '0 0 var(--basis_x4) 0' }}>Share the link</h1>\n            {/* <p>Enter @volteuropa.org addresses to give editing rights.<br/>Groups addresses are not supported.</p> */}\n\n            {/* <hr style={{ opacity: 0.2 }} /> */}\n\n            <div className={classes.inputWrapper}>\n             <span style={{ paddingRight: 'var(--basis)' }}>volt.link/</span>\n             <HtmlInput\n                defaultValue={path}\n                onBlur={savePath}\n                linebreak={false}\n                className={classes.input}\n                style={{ margin: '0' }}\n              />\n            </div>\n\n            <hr style={{ opacity: 0.2 }} />\n\n            <div className={classes.actions}>\n              {\n                path !== ''\n                ? <div>\n                    <button className=\"text hasIcon\" onClick={gotoQrcodePage} style={{ marginInlineStart: '0' }}>\n                      <QrCodeIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_qrcode\" /></span>\n                    </button>\n                    <button className=\"text hasIcon\" onClick={viewStatistics}>\n                      <AssessmentIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_statistics\" /></span>\n                    </button>\n                    <button className=\"text hasIcon\" onClick={copyUrl}>\n                      <CopyIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_copy_url\" /></span>\n                    </button>\n                  </div>\n                : <div></div>\n              }\n\n              <button onClick={onClose} className=\"green\" style={{ marginInlineEnd: '0' }}>\n                <Localized id=\"dialog_done\" />\n              </button>\n            </div>\n        </div>\n      </>\n    </Modal>\n  )\n}\n\nexport default SharingEditor\n","import { useState, useCallback } from 'react'\n\nimport classes from './InputWithLocal.module.css'\nimport LocaleSelect from './LocaleSelect.js'\n\nfunction InputWithLocal({ reorderHandle, actionButton, locale, defaultValue, children, style, onChange, onBlur, className, dataset = {}, ...props }) {\n  const [changedLocale, setChangedLocale] = useState(locale)\n  const [changedText, setChangedText] = useState(defaultValue)\n\n  const handleBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur({\n        value: {\n          locale: changedLocale,\n          text: changedText,\n        },\n        dataset,\n      })\n    }\n  }, [ onBlur, changedLocale, changedText, dataset ])\n\n  const handleLocaleChange = useCallback(newLocale => {\n    setChangedLocale(newLocale)\n\n    const changes = {\n      value: {\n        locale: newLocale,\n        text: changedText,\n      },\n      dataset,\n    }\n\n    if (onChange) {\n      onChange(changes)\n    }\n    if (onBlur) {\n      onBlur(changes)\n    }\n  }, [setChangedLocale, onChange, changedText, dataset, onBlur])\n\n  const handleTextChange = useCallback((event_or_text) => {\n    let text = event_or_text\n    if (\n      !!event_or_text\n      && !!event_or_text.target\n      && !!event_or_text.target.value\n    ) {\n      text = event_or_text.target.value\n    }\n\n    setChangedText(text)\n    if (onChange) {\n      onChange({\n        value: {\n          locale: changedLocale,\n          text,\n        },\n        dataset,\n      })\n    }\n  }, [setChangedText, onChange, changedLocale, dataset])\n\n  return <div\n    className={classes.input_with_local+' '+className}\n    style={style}\n  >\n    <LocaleSelect\n      onChange={handleLocaleChange}\n      defaultValue={locale}\n    />\n    {\n      !!children\n        ? children({\n          onChange: handleTextChange,\n          onBlur: handleBlur,\n          defaultValue,\n          style: {\n            flexGrow: '1',\n          }\n        })\n        : null\n    }\n  </div>\n}\n\nexport default InputWithLocal\n","import { useState, useCallback, useEffect } from 'react'\n\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\n\nimport { v4 as uuidv4 } from 'uuid'\n\nimport classes from './Repeater.module.css'\n\nimport DragIndicatorIcon from '@mui/icons-material/DragIndicator'\n\nfunction reorder(list, startIndex, endIndex) {\n  const result = Array.from(list)\n  const [removed] = result.splice(startIndex, 1)\n  result.splice(endIndex, 0, removed)\n\n  return result\n}\n\nfunction Row({\n  subDefaultValue,\n  index,\n  render,\n  handleRowChange,\n  isReorderable,\n  handleAddRow,\n  handleRemoveRow,\n  showReorderControls,\n  reorderLabel,\n  showActionButton,\n  hasOnlyOneRow,\n  addRowByIndex,\n}) {\n  return <Draggable\n      key={subDefaultValue.tmp_id}\n      draggableId={subDefaultValue.tmp_id}\n      index={index}\n      isDragDisabled={isReorderable === true ? false : true}\n      disableInteractiveElementBlocking={true}\n      shouldRespectForcePress={true}\n    >\n      {provided => (\n        <div\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n\n          key={subDefaultValue.tmp_id}\n          className={classes.row}\n        >\n          {/*\n            index !== 0\n            ? <div className={classes.middleActions}>\n              <div className={classes.trigger}></div>\n              <div className={classes.content}>\n                <button className={`green ${classes.inlineRowButton}`} data-index={index} onClick={handleAddRow}>+</button>\n              </div>\n            </div>\n            : null\n          */}\n\n        <div className={classes.form}>\n          {\n            isReorderable === true && showReorderControls === true\n              ? <button\n                  aria-label={reorderLabel}\n                  className={`text ${classes.inlineRowButton} ${classes.dragHandleButton}`}\n                  {...provided.dragHandleProps}\n                >\n                  <DragIndicatorIcon />\n                </button>\n              : null\n          }\n          {\n            render({\n              key: subDefaultValue.tmp_id,\n              defaultValue: subDefaultValue,\n              className: classes.item,\n              dataset: {\n                'data-index': index,\n                'data-id': subDefaultValue.tmp_id,\n              },\n              onChange: handleRowChange,\n              onRemoveRow: () => handleRemoveRow(index),\n              addRowBefore: (newValue) => addRowByIndex(index, 0, newValue),\n              addRowAfter: (newValue) => addRowByIndex(index, 1, newValue),\n              reorderHandle: <button\n                  aria-label={reorderLabel}\n                  className={`text ${classes.inlineRowButton} ${classes.dragHandleButton}`}\n                  {...provided.dragHandleProps}\n                >\n                  <DragIndicatorIcon />\n                </button>,\n              actionButton: (\n                hasOnlyOneRow\n                  ? <button className={`green ${classes.inlineRowButton}`} onClick={handleAddRow}>+</button>\n                  : <button className={`red ${classes.inlineRowButton}`} data-index={index} onClick={handleRemoveRow}></button>\n              ),\n            })\n          }\n          {\n            showActionButton === true\n            ? (\n            hasOnlyOneRow\n              ? <button className={`green ${classes.inlineRowButton}`} onClick={handleAddRow}>+</button>\n              : <button className={`red ${classes.inlineRowButton}`} data-index={index} onClick={handleRemoveRow}></button>\n            )\n            : null\n          }\n        </div>\n      </div>\n    )}\n  </Draggable>\n}\n\nfunction getIndex(eventOrIndex) {\n  let index = eventOrIndex // for if it is a number/index\n\n  if (typeof eventOrIndex === 'object') {\n    if (!!eventOrIndex.target) { // is event\n      eventOrIndex = eventOrIndex.target\n    }\n    if (!!eventOrIndex.dataset) { // is only the dataset\n      if (!!eventOrIndex.dataset.index) {\n        index = parseInt(eventOrIndex.dataset.index)\n        if (isNaN(index)) {\n          index = null\n        }\n      }\n    }\n  }\n\n  return index\n}\n\nfunction Repeater({\n  defaultValue,\n  addDefaultValue,\n  addButtonText,\n  hideAddButton = false,\n  reorderLabel = 'Reorder',\n  render,\n  style,\n  onChange,\n  prependNewItems,\n  showReorderControls = false,\n  showActionButton = true,\n  isReorderable = false\n}) {\n  if (!(!!addButtonText)) {\n    addButtonText = 'Add Row'\n  }\n\n  const [rows, setRows] = useState([])\n\n  const internalAddDefaultValue = useCallback(() => {\n    let tmp_defaultValue = {}\n    if (typeof addDefaultValue === 'function') {\n      const defaultValue = addDefaultValue()\n      if (typeof defaultValue === 'object' && defaultValue !== null) {\n        tmp_defaultValue = defaultValue\n        if (\n          typeof tmp_defaultValue.tmp_id !== 'string'\n          || tmp_defaultValue.tmp_id === ''\n        ) {\n          tmp_defaultValue.tmp_id = uuidv4()\n        }\n      }\n    }\n    return tmp_defaultValue\n  }, [addDefaultValue])\n\n  useEffect(() => {\n    let tmp_defaultValue = defaultValue\n    if (!Array.isArray(defaultValue) || defaultValue.length === 0) {\n      tmp_defaultValue = [internalAddDefaultValue()]\n    }\n    tmp_defaultValue = tmp_defaultValue.map(item => {\n      if (!item.tmp_id) {\n        return { ...item, tmp_id: uuidv4() }\n      }\n      return item\n    })\n    setRows(tmp_defaultValue)\n  }, [defaultValue, internalAddDefaultValue, setRows])\n\n  const handleRemoveRow = useCallback(eventOrIndex => {\n    const index = getIndex(eventOrIndex)\n\n    let new_rows = [...rows]\n    new_rows.splice(index, 1)\n    const rows_from_onChange = onChange(new_rows)\n    if (Array.isArray(rows_from_onChange)) {\n      new_rows = rows_from_onChange\n    }\n    setRows(new_rows)\n  }, [rows, setRows, onChange])\n\n  const handleRowChange = useCallback(event => {\n    const index = event.dataset.index || event.dataset['data-index']\n    const tmp_id = event.dataset.id || event.dataset['data-id']\n    const newValue = event.value\n\n    const new_rows = [...rows]\n    if (typeof newValue !== 'object' || newValue === null || Array.isArray(newValue)) {\n      new_rows[index] = {\n        tmp_id,\n        value: newValue\n      }\n    } else if (typeof newValue === 'object') {\n      new_rows[index] = {\n        tmp_id,\n        ...newValue\n      }\n    }\n    setRows(new_rows)\n    onChange(new_rows)\n  }, [rows, setRows, onChange])\n\n  const addRowByIndex = useCallback((index, offset = 0, newValue) => {\n    if (typeof newValue === 'object') {\n      newValue = {\n        ...(internalAddDefaultValue()),\n        ...newValue,\n      }\n    } else {\n      newValue = newValue || internalAddDefaultValue()\n    }\n\n    let new_rows = null\n    if (index !== null && index >= 0) {\n      new_rows = [...rows]\n      new_rows.splice(index + offset, 0, newValue)\n    }\n\n    setRows(new_rows)\n    onChange(new_rows)\n  }, [rows, internalAddDefaultValue, setRows, onChange])\n\n  const handleAddRow = useCallback(eventOrIndex => {\n    const newValue = internalAddDefaultValue()\n\n    const index = getIndex(eventOrIndex)\n\n    let new_rows = null\n    if (index !== null && index >= 0) {\n      new_rows = [...rows]\n      new_rows.splice(index, 0, newValue)\n    } else {\n      if (prependNewItems === true) {\n        new_rows = [newValue, ...rows]\n      } else {\n        new_rows = [...rows, newValue]\n      }\n    }\n\n    setRows(new_rows)\n    onChange(new_rows)\n  }, [rows, internalAddDefaultValue, setRows, onChange, prependNewItems])\n\n  function onDragEnd(result) {\n    if (!result.destination) {\n      return\n    }\n\n    if (result.destination.index === result.source.index) {\n      return\n    }\n\n    const new_rows = reorder(\n      rows,\n      result.source.index,\n      result.destination.index\n    )\n    setRows(new_rows)\n    onChange(new_rows)\n  }\n\n  const hasOnlyOneRow = rows.length === 1\n\n  const addButton = <div style={{ textAlign: 'right' }}>\n    <button className={`green ${classes.addRowButton}`} onClick={handleAddRow}>{addButtonText}</button>\n  </div>\n\n  return <div style={style}>\n    {hideAddButton === false && (!hasOnlyOneRow && prependNewItems) ? <div style={{ marginBottom: 'var(--basis)' }}>{addButton}</div> : null}\n\n    <DragDropContext onDragEnd={onDragEnd}>\n      <Droppable\n        droppableId=\"list\"\n        isDropDisabled={isReorderable === true ? false : true}\n      >\n        {provided => (\n          <div ref={provided.innerRef} {...provided.droppableProps}>\n            {\n              rows\n              .filter(subDefaultValue => subDefaultValue.tmp_id)\n              .map(\n                (subDefaultValue, index) => <Row\n                  key={subDefaultValue.tmp_id}\n                  {...{\n                    subDefaultValue,\n                    index,\n                    render,\n                    handleRowChange,\n                    isReorderable,\n                    handleAddRow,\n                    handleRemoveRow,\n                    showReorderControls,\n                    reorderLabel,\n                    showActionButton,\n                    hasOnlyOneRow,\n                    addRowByIndex,\n                  }}\n                />\n              )\n            }\n            {provided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    </DragDropContext>\n\n    {hideAddButton === false && (!hasOnlyOneRow && !prependNewItems) ? addButton : null}\n  </div>\n}\n\nexport default Repeater\n","import React, { useEffect, useState, useCallback } from 'react'\n\nimport {\n  Modal,\n} from '@mui/material'\n\nimport { Localized } from '../../fluent/Localized.js' // useLocalization\n\nimport classes from './TranslationEditor.module.css'\n\nimport HtmlInput from './HtmlInput.js'\nimport InputWithLocal from './InputWithLocal.js'\nimport ViewerAuto from '../view/ViewerAuto.js'\nimport LocaleSelect from './LocaleSelect.js'\nimport Repeater from '../Repeater.js'\n\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\nimport useLoadBlocks from '../../hooks/useLoadBlocks.js'\n\nfunction SimpleTranslationRepeater({ onSaveProperty, block, isFirst }) {\n\n  const addDefaultValue = () => ({\n    locale: null,\n    text: '',\n  })\n\n  let translations = block.properties.translations || []\n  if (translations.length === 0) {\n    translations = [addDefaultValue]\n  }\n\n  const onRepeaterChange = useCallback(newTranslations => {\n    newTranslations = newTranslations\n      .map(translation => ({\n        locale: translation.locale || null,\n        text: translation.text || '',\n      }))\n\n    onSaveProperty('translations', newTranslations)\n  }, [ onSaveProperty ])\n\n  const onBlockLocaleChange = useCallback(newLocale => {\n    onSaveProperty('locale', newLocale)\n  }, [ onSaveProperty ])\n\n  const block2display = { ...block }\n  if (isFirst === true && block2display.type === 'page') {\n    block2display.type = 'text'\n    block2display.properties.text_style = 'h1'\n  }\n\n  return <div style={{\n    width: '100%',\n  }}>\n\n    <div style={{\n      display: 'flex',\n      alignItems: 'flex-end',\n      marginBottom: 'var(--basis)',\n      gap: 'var(--basis)',\n    }}>\n      <LocaleSelect\n        onChange={onBlockLocaleChange}\n        defaultValue={block.properties.locale || null}\n      />\n\n      <ViewerAuto\n        block={block2display}\n        style={{\n          margin: '0',\n          minHeight: '30px',\n        }}\n        actions={{\n          click: false,\n        }}\n      />\n    </div>\n\n    <Repeater\n      onChange={onRepeaterChange}\n      defaultValue={translations}\n      addDefaultValue={addDefaultValue}\n      addButtonText=\"+\"\n      render={\n        ({ defaultValue, ...repeater_props }) => {\n          const {\n            onChange,\n            ...other_repeater_props\n          } = repeater_props\n\n          const locale = defaultValue.locale\n          const text = defaultValue.text\n          return <InputWithLocal\n            onBlur={onChange}\n            locale={locale}\n            defaultValue={text}\n            style={{\n              marginBottom: 'var(--basis)',\n            }}\n            {...other_repeater_props}\n          >\n            {InputWithLocal_props => <HtmlInput\n              {...InputWithLocal_props}\n              style={{\n                ...InputWithLocal_props.style,\n                margin: '0',\n              }}\n            />}\n          </InputWithLocal>\n        }\n      }\n    />\n  </div>\n}\n\nfunction TranslationEditor({\n  defaultBlock = {},\n  open = false,\n  onSaveProperty, // to not overwrite the translatins by the PageEditor\n  onClose,\n}) {\n\n  const [blocks, setBlocks] = useState([])\n\n  const loadBlocks = useLoadBlocks()\n  useEffect(() => {\n    async function loadContentBlocks () {\n      const ids2load = [\n        ...defaultBlock.content\n          .filter(contentConfig =>\n            contentConfig.hasOwnProperty('blockId')\n            && contentConfig.hasOwnProperty('block')\n          )\n          .map(contentConfig => contentConfig.blockId || contentConfig.block._id),\n      ]\n\n      let loadedBlocks = []\n      if (ids2load.length > 0) {\n        loadedBlocks = await loadBlocks({ ids: ids2load })\n      }\n\n      let contentBlocks = ids2load.map(id => { // map to the ids to keep the order\n        const block = loadedBlocks.find(block => block._id === id)\n        if (\n          block\n          && block.type !== 'divider'\n          && !!block.properties.text\n        ) {\n          return block\n        } else {\n          return null\n        }\n      })\n      .filter(Boolean) // remove null values\n\n      return contentBlocks\n    }\n\n    if (blocks.length === 0) {\n      loadContentBlocks()\n        .then(contentBlocks => {\n          const newBlocks = [\n            defaultBlock,\n            ...contentBlocks,\n          ]\n\n          setBlocks(newBlocks)\n        })\n    } else if (JSON.stringify(defaultBlock) !== JSON.stringify(blocks[0])) {\n      // replace the first block of blocks with defaultBlock\n      setBlocks([\n        defaultBlock,\n        ...blocks.slice(1),\n      ])\n    }\n  }, [ defaultBlock, loadBlocks, setBlocks, blocks ])\n\n  const saveBlock = useSaveBlock()\n  const onSaveChildProperty = useCallback((block, key, value) => {\n    const newBlock = {\n      ...block,\n      properties: {\n        ...block.properties,\n        [key]: value,\n      },\n    }\n\n    saveBlock(newBlock)\n      .then(gottenBlock => { // only the id changed in gottenBlock      \n        const blockId = newBlock._id\n\n        // find the block in the blocks array by _id\n        const blockIndex = blocks.findIndex(block => block._id === blockId)\n        \n        // replace the block at blockIndex in the blocks array by newBlock\n        const newBlocks = [\n          ...blocks.slice(0, blockIndex),\n          newBlock,\n          ...blocks.slice(blockIndex + 1),\n        ]\n\n        setBlocks(newBlocks)\n      })\n  }, [ saveBlock, blocks, setBlocks ])\n\n  if (!open) {\n    return null\n  }\n\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      hideBackdrop={true}\n      style={{\n        zIndex: '1000',\n      }}\n    >\n      <>\n        <div className={classes.backdrop} onClick={onClose}></div>\n\n        <div className={classes.dialog}>\n\n          \n          <div className={classes.actions}>\n            <h1 style={{ margin: '0 0 var(--basis_x4) 0' }}>\n              <Localized id=\"translate_dialog_title\" />\n            </h1>\n            <button onClick={onClose} className=\"green\" style={{ marginInlineEnd: '0' }}>\n              <Localized id=\"dialog_done\" />\n            </button>\n          </div>\n          <p>\n            <Localized id=\"translate_dialog_description\" />\n          </p>\n\n          <hr style={{ opacity: 0.2 }} />\n\n          {\n            blocks\n            .flatMap((block, index) => ([\n              <hr key={'hr-'+index} style={{ opacity: 0 }} />,\n              <div key={'div-'+index} style={{ margin: 'var(--basis_x4) 0' }}>\n                <SimpleTranslationRepeater\n                  onSaveProperty={\n                    block._id === defaultBlock._id\n                    ? onSaveProperty\n                    : (...attr) => onSaveChildProperty(block, ...attr)\n                  }\n                  block={block}\n                  isFirst={index === 0}\n                />\n              </div>\n            ]))\n          }\n\n          <hr style={{ opacity: 0.2 }} />\n\n          <div className={classes.actions}>\n            <div></div>\n            <button onClick={onClose} className=\"green\" style={{ marginInlineEnd: '0' }}>\n              <Localized id=\"dialog_done\" />\n            </button>\n          </div>\n        </div>\n      </>\n    </Modal>\n  )\n}\n\nexport default TranslationEditor\n","import { useState } from 'react'\n\nimport classes from './FancyInput.module.css'\n\nfunction FancyInput({ children, className, style, ...props }) {\n  const [error, setError] = useState('')\n\n  return <div\n    className={className}\n    style={style}\n  >\n    {children({ setError })}\n    {\n      error\n      ? <div className={classes.error}>\n          {error.split('\\n').map(error => <p key={error}>{error}</p>)}\n        </div>\n      : null\n    }\n  </div>\n}\n\nexport default FancyInput\n","import { useCallback } from 'react'\n\nconst email_regex = /^(?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?)$/gui // is surrounded by start and end tags\nconst emails_regex = /((?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?))/gui // is surrounded by a group\n\nfunction EmailInput({ multiple = false, onChange, onError, ...props }) {\n  const handleTextChange = useCallback((event) => {\n    if (onChange ||onError) {\n      let value = event.target.value ||''\n      let isSubmittable = false\n      let error = ''\n\n      if (value !== '') {\n        if (multiple === true) {\n          const emails = value.match(emails_regex)\n          if (emails) {\n            value = emails\n            isSubmittable = true\n          } else {\n            error = 'Invalid email(s) format'\n          }\n        } else {\n          if (value.match(email_regex)) {\n            isSubmittable = true\n          } else {\n            error = 'invalid_email'\n          }\n        }\n      }\n\n      if (onChange) {\n        if (isSubmittable) {\n          onChange(value)\n        } else {\n          if (multiple === true) {\n            onChange([])\n          } else {\n            onChange('')\n          }\n        }\n      }\n\n      if (onError) {\n        onError(error)\n      }\n    }\n  }, [multiple, onChange, onError])\n\n  return <input\n    type=\"email\"\n    onChange={handleTextChange}\n    {...props}\n  />\n}\n\nexport default EmailInput\n","import React, { useState, useCallback, useEffect } from 'react'\n\nimport {\n  Modal,\n  Menu,\n  MenuItem,\n  Divider,\n  ListItemIcon,\n  ListItemText,\n} from '@mui/material'\nimport {\n  KeyboardArrowDown as KeyboardArrowDownIcon,\n  Delete as DeleteIcon,\n  Close as CloseIcon,\n  Visibility as ViewerIcon,\n  Edit as EditorIcon,\n  Lock as NoAccessIcon,\n} from '@mui/icons-material'\nimport { v4 as uuidv4 } from 'uuid'\n\nimport { Localized, useLocalization } from '../../fluent/Localized.js'\n\nimport useUser from '../../hooks/useUser.js'\n\nimport FancyInput from './FancyInput.js'\nimport EmailInput from './EmailInput.js'\n\nimport classes from './PermissionsEditor.module.css'\n\nfunction addTmpIds(array) {\n  return [...array].map(obj => {\n    const obj_new = { ...obj }\n    obj_new.tmp_id = uuidv4()\n    return obj_new\n  })\n}\n\nfunction LocalizedRole({ role }) {\n  return <Localized id={'role_'+role} />\n}\n\nfunction RolesMenu({\n  role,\n  trigger,\n  changeRole,\n  removePermission,\n}){\n  const [anchorEl, setAnchorEl] = React.useState(null)\n  const open = Boolean(anchorEl)\n  const handleOpen = event => {\n    setAnchorEl(event.currentTarget)\n  }\n  const handleClose = () => {\n    setAnchorEl(null)\n  }\n\n  return <>\n    {trigger({\n      onClick: handleOpen,\n    })}\n\n    <Menu\n      anchorEl={anchorEl}\n      open={open}\n      onClose={handleClose}\n      MenuListProps={{\n        style: {\n          maxWidth: '100%',\n          background: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n        },\n      }}\n    >\n      <MenuItem\n        disabled={role === 'viewer'}\n        onClick={() => changeRole('viewer')}\n        className=\"roundMenuItem\"\n      >\n        <ListItemIcon>\n          <ViewerIcon />\n        </ListItemIcon>\n        <ListItemText>\n          <LocalizedRole role=\"viewer\" />\n        </ListItemText>\n      </MenuItem>\n      <MenuItem\n        disabled={role === 'editor'}\n        onClick={() => changeRole('editor')}\n        className=\"roundMenuItem\"\n      >\n        <ListItemIcon>\n          <EditorIcon />\n        </ListItemIcon>\n        <ListItemText>\n          <LocalizedRole role=\"editor\" />\n        </ListItemText>\n      </MenuItem>\n      <MenuItem\n        disabled={role === 'no_access'}\n        onClick={() => changeRole('no_access')}\n        className=\"roundMenuItem\"\n      >\n        <ListItemIcon>\n          <NoAccessIcon />\n        </ListItemIcon>\n        <ListItemText>\n          <LocalizedRole role=\"no_access\" />\n        </ListItemText>\n      </MenuItem>\n      \n        {\n          typeof removePermission === 'function'\n          ? <>\n            <Divider style={{ opacity: 0.2 }} />\n            <MenuItem\n              onClick={removePermission}\n              className=\"roundMenuItem\"\n            >\n              <ListItemIcon>\n                <DeleteIcon />\n              </ListItemIcon>\n              <ListItemText>\n                Remove\n              </ListItemText>\n            </MenuItem>\n          </>\n          : null\n        }\n\n        <Divider style={{opacity: 0.2}} />\n\n        <MenuItem\n          onClick={handleClose}\n          className=\"roundMenuItem\"\n        >\n          <ListItemIcon>\n            <CloseIcon />\n          </ListItemIcon>\n          <ListItemText>\n            Close\n          </ListItemText>\n        </MenuItem>\n    </Menu>\n  </>\n}\n\nfunction sortPermissions(permissions) {\n  const owner = permissions\n    .filter(p => p.role === 'owner')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  const special = permissions\n    .filter(p => p.email === '@volteuropa.org' || p.email === '@public')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  const other = permissions\n    .filter(p => p.role !== 'owner' && p.email !== '@volteuropa.org' && p.email !== '@public')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  return [\n    ...owner,\n    ...special,\n    ...other,\n  ]\n}\n\nfunction PermissionsEditor({\n  defaultPermissions,\n  open = false,\n  onChange,\n  onClose,\n}) {\n  const { getString } = useLocalization()\n\n  const user_data = useUser()\n  let user_email = ''\n  if (!!user_data) {\n    if (!!user_data.user) {\n      if (!!user_data.user.email) {\n        user_email = user_data.user.email\n      }\n    }\n  }\n\n  const [inputRepaintKey, setInputRepaintKey] = useState(0)\n  const [permissions, setPermissions] = useState([])\n  const [newEmails, setNewEmails] = useState([])\n  const [newRole, setNewRole] = useState('editor')\n\n  const setNewPermission = useCallback(newPermissions => {\n    newPermissions = addTmpIds(newPermissions || [])\n\n    if (user_email !== '') {\n      const doesNotHaveOwner = newPermissions.filter(permission => permission.role === 'owner').length === 0\n      if (doesNotHaveOwner) {\n        newPermissions.unshift({ tmp_id: uuidv4(), email: user_email, role: 'owner' })\n      }\n    }\n    \n    setPermissions(newPermissions)\n  }, [ user_email, setPermissions ])\n\n  useEffect(() => {\n    const blockPermissions = defaultPermissions['/']\n    if (Array.isArray(blockPermissions)) {\n      setNewPermission(blockPermissions)\n    } else {\n      setNewPermission([])\n    }\n  }, [ setNewPermission, defaultPermissions ])\n\n  const removePermission = useCallback(email => {\n    let newPermissions = permissions.filter(p => p.email !== email)\n    if (email === '@volteuropa.org') {\n      newPermissions = newPermissions.filter(p => p.email !== '@public')\n    }\n\n    const doesNotHaveOwner = newPermissions.filter(p => p.role === 'owner').length === 0\n    if (doesNotHaveOwner) {\n      newPermissions = newPermissions.filter(p => p.email !== user_email)\n      newPermissions.unshift({ tmp_id: uuidv4(), email: user_email, role: 'owner' })\n    }\n\n    setPermissions(newPermissions)\n    onChange({ '/': newPermissions })\n  }, [permissions, user_email, setPermissions, onChange])\n\n  const changeRole = useCallback((email, newRole) => {\n    const newPermissions = permissions.map(permission => {\n      if (permission.email === email) {\n        return {\n          ...permission,\n          role: newRole,\n        }\n      }\n      return permission\n    })\n\n    setPermissions(newPermissions)\n    onChange({ '/': newPermissions })\n  }, [permissions, setPermissions, onChange])\n\n  const addPermissions = useCallback((newEmails, newRole) => {\n    if (newEmails.includes('@public')) {\n      newEmails.push('@volteuropa.org')\n    }\n    let newPermissions = permissions.filter(permission => !newEmails.includes(permission.email))\n    for (const newEmail of newEmails) {\n      newPermissions.unshift({ tmp_id: uuidv4(), email: newEmail, role: newRole })\n    }\n\n    const doesNotHaveOwner = newPermissions.filter(p => p.role === 'owner').length === 0\n    if (doesNotHaveOwner) {\n      newPermissions = newPermissions.filter(p => p.email !== user_email)\n      newPermissions.unshift({ tmp_id: uuidv4(), email: user_email, role: 'owner' })\n    }\n\n    setPermissions(newPermissions)\n    onChange({ '/': newPermissions })\n  }, [permissions, user_email, setPermissions, onChange])\n\n  const addNewPermissionFromInput = useCallback(() => {\n    addPermissions(newEmails, newRole)\n    setNewEmails([]) // reset the email-input | don't reset the role-input so it can be reused when entering multiple emails after each other // setNewRole('editor')\n    setInputRepaintKey(oldInputRepaintKey => oldInputRepaintKey + 1) // redraw the email-input\n  }, [ newEmails, newRole, addPermissions ])\n\n  if (!open) {\n    return null\n  }\n\n  const doesNotHaveVoltEuropa = permissions.filter(permission => permission.email === '@volteuropa.org').length === 0\n  const doesNotHavePublic = permissions.filter(permission => permission.email === '@public').length === 0\n\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      hideBackdrop={true}\n    >\n      <>\n        <div className={classes.backdrop} onClick={onClose}></div>\n\n        <div className={classes.dialog}>\n          <h1 style={{ margin: '0 0 var(--basis_x4) 0' }}>Give viewing and editing rights</h1>\n          <p>Enter @volteuropa.org addresses to give editing rights.<br/>Groups addresses are not supported.</p>\n          <div className={classes.inputWrapper} key={inputRepaintKey}>\n            <FancyInput className={classes.input}>\n              {({ setError }) => (\n                <EmailInput\n                  multiple={true}\n                  onError={setError}\n                  defaultValue=\"\"\n                  onChange={setNewEmails}\n                  aria-label={getString('path_editor_permissions_edit_label')}\n                  placeholder={getString('path_editor_permissions_edit_placeholder')}\n                  style={{\n                    flexGrow: '1',\n                    // margin: '0',\n                    margin: 'var(--basis) 0',\n                    width: 'calc(100% - var(--basis_x2))',\n                  }}\n                />\n              )}\n            </FancyInput>\n            <RolesMenu\n              role={newRole}\n              changeRole={setNewRole}\n              trigger={triggerProps => <button className={classes.menuButton} {...triggerProps}><LocalizedRole role={newRole} /> <KeyboardArrowDownIcon/></button>}\n            />\n          </div>\n\n          {\n            newEmails.length > 0 && newEmails[0].length > 0\n            ? <>\n                <hr />\n\n                <div className={classes.actions}>\n                  <div></div>\n                  <button onClick={addNewPermissionFromInput} className=\"green\" style={{margin: '0'}}>\n                    {\n                      newEmails.length > 1\n                      ? \"Add People\"\n                      : \"Add Person\"\n                    }\n                  </button>\n                </div>\n              </>\n            : <>\n                {\n                  doesNotHaveVoltEuropa || doesNotHavePublic\n                  ? <div style={{ marginTop: 'var(--basis_x2)' }}>\n                    Make visible for\n                    {\n                      doesNotHaveVoltEuropa\n                      ? <button onClick={() => addPermissions(['@volteuropa.org'], 'viewer')}>Volt Europa</button>\n                      : null\n                    }\n                    {\n                      doesNotHavePublic\n                      ? <button onClick={() => addPermissions(['@public'], 'viewer')}>Public</button>\n                      : null\n                    }\n                  </div>\n                  : null\n                }\n\n                {\n                  permissions.length === 0\n                   ? null\n                   : <hr style={{ opacity: 0.2 }} />\n                }\n\n                {\n                  sortPermissions(permissions)\n                  .map(p => <div key={p.tmp_id} className={classes.permissionRow}>\n                    {\n                      p.email === '@public'\n                        ? <strong>Public</strong>\n                        : (\n                          p.email === '@volteuropa.org'\n                            ? <strong>Volt Europa</strong>\n                            : <span>{p.email}</span>\n                        )\n                    }\n\n                    {\n                      p.role === 'owner'\n                      ? <strong className={`type_button ${classes.ownerInfo}`}><LocalizedRole role={p.role} /></strong>\n                      : <RolesMenu\n                          role={p.role}\n                          removePermission={() => removePermission(p.email)}\n                          changeRole={(newRole) => changeRole(p.email, newRole)}\n                          trigger={triggerProps => <button className={classes.menuButton} {...triggerProps}><LocalizedRole role={p.role} /> <KeyboardArrowDownIcon/></button>}\n                        />\n                    }\n                  </div>)\n                }\n\n                <hr style={{ opacity: 0.2 }} />\n\n                <div className={classes.actions}>\n                  <div></div>\n                  <button onClick={onClose} className=\"green\" style={{margin: '0'}}>\n                    <Localized id=\"dialog_done\" />\n                  </button>\n                </div>\n              </>\n          }\n        </div>\n      </>\n    </Modal>\n  )\n}\n\nexport default PermissionsEditor\n","import { useCallback, useState } from 'react'\n\nimport {\n  CheckBox as CheckBoxIcon,\n  CheckBoxOutlineBlank as CheckBoxOutlineBlankIcon,\n} from '@mui/icons-material'\n\nfunction CheckboxInput({\n  defaultValue = '',\n  onChange,\n  onBlur,\n  style,\n  className,\n  disabled = false,\n}) {\n  // TODO: make ARIA compatible\n\n  const [ checked, setChecked ] = useState(Boolean(defaultValue))\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange(checked)\n    }\n    if (onBlur) {\n      onBlur(checked)\n    }\n  }, [ onChange, onBlur, checked ])\n\n  const checkBlock = useCallback(() => {\n    if (disabled === true) {\n      return\n    }\n    publishChanges()\n    setChecked(true)\n  }, [ disabled, publishChanges, setChecked ])\n\n  const uncheckBlock = useCallback(() => {\n    if (disabled === true) {\n      return\n    }\n    publishChanges()\n    setChecked(false)\n  }, [ disabled, publishChanges, setChecked ])\n\n  return <div\n    style={{\n      display: 'inline-block',\n      padding: 'var(--basis)',\n      cursor: disabled === true ? 'default' : 'pointer',\n      verticalAlign: 'middle',\n      ...style,\n    }}\n    className={className}\n  >\n    {\n      checked\n      ? <CheckBoxIcon onClick={uncheckBlock} />\n      : <CheckBoxOutlineBlankIcon onClick={checkBlock} />\n    }\n  </div>\n}\n\nexport default CheckboxInput\n","import { useState, useCallback, useEffect } from 'react'\n\nfunction MultiButton({ ariaLabel, items, defaultValue, onChange, style, className }) {\n  const [choosen, setChoosen] = useState()\n\n  useEffect(() => setChoosen(defaultValue), [defaultValue, setChoosen])\n\n  const handleClick = useCallback(event => {\n    const newValue = event.target.dataset.value\n    setChoosen(newValue)\n    if (onChange) {\n      onChange(newValue)\n    }\n  }, [setChoosen, onChange])\n\n  return <div\n    aria-label={ariaLabel}\n    className={'buttonRow ' + (className ||'')}\n    style={{\n      display: 'inline-block',\n      ...style\n    }}\n  >\n    {\n      items.map(item => {\n        const value = item.value\n        const title = item.title\n        const icon = item.icon || null\n        return <button\n          key={value+'_'+title}\n          className={`default ${choosen === value ? 'choosen' : ''} ${!!icon ? 'hasIcon' : ''}`}\n          onClick={handleClick}\n          data-value={value}\n        >\n          <span style={{pointerEvents: 'none'}}>\n            {!!icon ? icon : null}\n            {!!title ? <span style={{verticalAlign: 'middle'}}>{title}</span> : null}\n          </span>\n        </button>\n      })\n    }\n  </div>\n}\n\nexport default MultiButton\n","import { useCallback, useState } from 'react'\n\nconst url_regex = /^([A-Z0-9+-.]+:(?:\\/\\/)?)[\\w\\u00C0-\\u00FF_.-]+(?:\\.[\\w\\u00C0-\\u00FF_.-]+)+[\\w\\u00C0-\\u00FF_~:/?#[\\]!%$&'()@*+,;=.-]+$/gui\nconst email_regex = /^(?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?)$/gui\nconst is_email_not_url_regex = /^[^:/]+@.+$/gui\n\nfunction UrlInput({\n  defaultValue = '',\n  onChange,\n  onBlur,\n  onError,\n  placeholder = 'https://',\n  style,\n  className\n}) {\n  const [text, setText] = useState(defaultValue)\n\n  const handleTextChange = useCallback((event) => {\n    const value = event.target.value ||''\n    // let isSubmittable = false\n    let error = ''\n\n    if (value !== '') {\n      const schema_parts = value.split(':')\n      const schema = schema_parts.shift()\n      const after_schema = schema_parts.join(':')\n\n      if (schema === 'tel') {\n        // isSubmittable = true\n      } else if (schema === 'mailto' || value.match(is_email_not_url_regex)) {\n        if (after_schema.match(email_regex)) {\n          // isSubmittable = true\n        } else {\n          error = 'invalid_mailto_url'\n        }\n      } else {\n        if (value.match(url_regex)) {\n          // isSubmittable = true\n        } else {\n          error = 'invalid_url'\n        }\n      }\n    }\n\n    if (onChange) {\n      onChange(value)\n    }\n\n    if (onError) {\n      onError(error)\n    }\n\n    setText(value)\n  }, [onChange, onError])\n\n  const handleBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur(text)\n    }\n  }, [onBlur, text])\n\n  return <input\n    type=\"url\"\n    onChange={handleTextChange}\n    onBlur={handleBlur}\n    defaultValue={defaultValue}\n    placeholder={placeholder}\n    style={style}\n    className={className}\n  />\n}\n\nexport default UrlInput\n","export default __webpack_public_path__ + \"static/media/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.3f9289d0.png\";","export default __webpack_public_path__ + \"static/media/Aktion.89c1bcdf.png\";","export default __webpack_public_path__ + \"static/media/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.6824f6ef.png\";","export default __webpack_public_path__ + \"static/media/Welcome-to-Volt.39e04eca.png\";","export default __webpack_public_path__ + \"static/media/portugal.682fc2e3.jpg\";","\nimport classes from './CoverphotoPicker.module.css'\n\n// import { getImageUrl } from '../../functions.js'\n\nimport Popover from '../Popover.js'\n\nimport { Paper } from '@mui/material'\nimport {\n  RectangleSharp as CoverphotoIcon,\n} from '@mui/icons-material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n\nimport MultiButton from '../MultiButton.js'\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\n\nimport plakatschlange_thumb from '../../images/coverphotos/thumbs/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.png'\nimport aktion_thumb from '../../images/coverphotos/thumbs/Aktion.png'\nimport volt_bonn_thumb from '../../images/coverphotos/thumbs/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.png'\nimport welcome_to_volt_thumb from '../../images/coverphotos/thumbs/Welcome-to-Volt.png'\nimport portugal_thumb from '../../images/coverphotos/thumbs/portugal.jpg'\n\n\nfunction CoverphotoPicker({ getString, coverphotoValue, iconValue, onChange, className = '', style = {} }) {\n  \n  const onUrlChange = newUrl => {\n    onChange({\n      type: 'url',\n      url: newUrl,\n    })\n  }\n\n  const isAbsoluteUrlRegexp = new RegExp('^(?:[a-z]+:)?//', 'i')\n\n  // if (\n  //   typeof coverphotoValue === 'object'\n  //   && coverphotoValue !== null\n  //   && !Array.isArray(coverphotoValue)\n  // ) {\n  //   if (coverphotoValue.type === 'url') {\n  //     return coverphotoValue.url || ''\n  //   }\n  // }\n\n  let coverphotoValueUrl = ''\n  let coverphotoIsSet = false\n  let iconIsSet = false\n\n  if (\n    typeof coverphotoValue === 'object'\n    && coverphotoValue !== null\n    && !Array.isArray(coverphotoValue)\n  ) {\n    if (\n      coverphotoValue.type === 'url'\n      && typeof coverphotoValue.url === 'string'\n      && isAbsoluteUrlRegexp.test(coverphotoValue.url)\n    ) {\n      coverphotoIsSet = true\n      coverphotoValueUrl = coverphotoValue.url || ''\n    }\n  }\n\n  if (\n    typeof iconValue === 'object'\n    && iconValue !== null\n    && !Array.isArray(iconValue)\n  ) {\n    if (\n      iconValue.type === 'url'\n      && typeof iconValue.url === 'string'\n      && isAbsoluteUrlRegexp.test(iconValue.url)\n    ) {\n      iconIsSet = true\n    }\n  }\n\n  return <div\n    className={`\n      ${classes.root}\n      ${coverphotoIsSet ? classes.coverphotoIsSet : classes.coverphotoIsNotSet}\n      ${iconIsSet ? classes.iconIsSet : classes.iconIsNotSet}\n      ${className}\n    `}\n    style={style}\n  >\n    <Popover\n      trigger={(triggerProps) => (\n        <div\n          className={classes.coverphoto}\n          style={{\n            backgroundImage: coverphotoIsSet ? `url(${window.domains.backend}download_url?f=jpg&w=1400&h=400&url=${encodeURIComponent(coverphotoValue.url)})` : '',\n          }}\n        >\n          <div className={classes.button_wrapper}>\n            <button {...triggerProps} className={`text hasIcon ${classes.changeCoverphotoButton}`}>\n              <CoverphotoIcon className=\"icon\" />\n              <span style={{ marginInlineStart: 'var(--basis_x2)', verticalAlign: 'middle'}}>Set Coverphoto</span>\n            </button>\n          </div>\n        </div>\n      )}\n    >\n      {({closePopover, ...popoverProps}) => (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 'calc(calc(100vw - 32px) - var(--basis_x8))',\n            maxHeight: 'calc(calc(100vh - 32px) - var(--basis_x8))',\n            overflow: 'auto',\n            padding: 'var(--basis_x4)',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }}\n          elevation={8}\n        >\n          <h3 style={{ marginTop: '0' }}><Localized id=\"path_editor_coverphoto_label\" /></h3>\n\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}>\n            <Localized id=\"path_editor_coverphoto_info\" />\n          </em>\n\n          <FancyInput>\n            {({ setError }) => (\n              <UrlInput\n                onError={setError}\n                onChange={onUrlChange}\n                defaultValue={coverphotoValueUrl}\n                style={{\n                  marginRight: '0',\n                  marginLeft: '0',\n                  width: '100%'\n                }}\n              />\n            )}\n          </FancyInput>\n\n          <MultiButton\n            onChange={onUrlChange}\n            ariaLabel={getString('path_editor_coverphoto_label')}\n            defaultValue={coverphotoValueUrl}\n            items={[\n              {\n                value: '',\n                title: getString('path_editor_no_coverphoto'),\n              },\n              ...[\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_2880x/public/inline-images/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.jpg',\n                  icon: volt_bonn_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2020-11/Welcome-to-Volt.jpg',\n                  icon: welcome_to_volt_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-07/20200912_Plakatschlange_Ko%CC%88ln_Matteo%20Sant_Unione_011.jpeg',\n                  icon: plakatschlange_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/2021-11/portugal.jpg',\n                  icon: portugal_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-05/Aktion.jpeg',\n                  icon: aktion_thumb,\n                },\n                // 'https://www.volteuropa.org/stripes/hero-desktop-green.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-red.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-blue.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-yellow.jpg',\n                // 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-05/Colours-Background-Big.jpeg',\n                // 'https://www.volteuropa.org/stripes/intermediate-green.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-red.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-blue.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-yellow.jpg',\n                // 'https://www.volteuropa.org/og-default.png',\n                // 'https://www.volteuropa.org/hero-default.jpg',\n              ]\n              .map(({value = '', icon = ''}) => ({\n                value,\n                icon: <img alt=\"\" src={icon} className=\"icon image\" />\n              }))\n            ]}\n          />\n\n          <hr />\n\n          <button className=\"text\" onClick={closePopover} style={{ margin: 0 }}>\n            Close\n          </button>\n        </Paper>\n      )}\n    </Popover>\n  </div>\n}\n\nexport default withLocalization(CoverphotoPicker)\n","\nimport classes from './IconPicker.module.css'\n\nimport Popover from '../Popover.js'\n\nimport { Paper } from '@mui/material'\nimport {\n  CircleSharp as IconIcon,\n} from '@mui/icons-material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\n\nfunction IconPicker({ coverphotoValue, iconValue, onChange, className, style }) {\n\n  const onUrlChange = newUrl => {\n    onChange({\n      type: 'url',\n      url: newUrl,\n    })\n  }\n\n  const isAbsoluteUrlRegexp = new RegExp('^(?:[a-z]+:)?//', 'i')\n\n  let iconValueUrl = ''\n  let coverphotoIsSet = false\n  let iconIsSet = false\n\n  if (\n    typeof coverphotoValue === 'object'\n    && coverphotoValue !== null\n    && !Array.isArray(coverphotoValue)\n  ) {\n    if (\n      coverphotoValue.type === 'url'\n      && typeof coverphotoValue.url === 'string'\n      && isAbsoluteUrlRegexp.test(coverphotoValue.url)\n    ) {\n      coverphotoIsSet = true\n    }\n  }\n\n  if (\n    typeof iconValue === 'object'\n    && iconValue !== null\n    && !Array.isArray(iconValue)\n  ) {\n    if (\n      iconValue.type === 'url'\n      && typeof iconValue.url === 'string'\n      && isAbsoluteUrlRegexp.test(iconValue.url)\n    ) {\n      iconIsSet = true\n      iconValueUrl = iconValue.url || ''\n    }\n  }\n\n  return <div\n    className={`\n      ${classes.root}\n      ${iconIsSet ? classes.iconIsSet : classes.iconIsNotSet}\n      ${coverphotoIsSet ? classes.coverphotoIsSet : classes.coverphotoIsNotSet}\n      ${className}\n    `}\n    style={style}\n  >\n    <Popover\n      trigger={(triggerProps) => (<div className={classes.iconWrapper}>\n        <div\n          className={`${classes.icon} ${!iconIsSet ? classes.no_image : ''}`}\n          style={{\n            backgroundImage: iconIsSet ? `url(${window.domains.backend}download_url?f=${window.imageFormat || 'jpg'}&w=400&h=400&url=${encodeURIComponent(iconValueUrl)})` : '',\n          }}\n        ></div>\n        <button {...triggerProps} className={`text hasIcon ${classes.changeIconButton}`}>\n          <IconIcon className=\"icon\" />\n          <span style={{ marginInlineStart: 'var(--basis_x2)', verticalAlign: 'middle'}}>Set Icon</span>\n        </button>\n      </div>)}\n    >\n      {({closePopover, ...popoverProps}) => (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 'calc(calc(100vw - 32px) - var(--basis_x8))',\n            maxHeight: 'calc(calc(100vh - 32px) - var(--basis_x8))',\n            overflow: 'auto',\n            padding: 'var(--basis_x4)',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }}\n          elevation={8}\n        >\n          <h3 style={{ marginTop: '0' }}><Localized id=\"path_editor_icon_label\" /></h3>\n\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}>\n            <Localized id=\"path_editor_icon_info\" />\n          </em>\n\n          <FancyInput>\n            {({ setError }) => (\n              <UrlInput\n                onError={setError}\n                onBlur={onUrlChange}\n                defaultValue={iconValueUrl}\n                style={{\n                  marginRight: '0',\n                  marginLeft: '0',\n                  width: '100%'\n                }}\n              />\n            )}\n          </FancyInput>\n\n          <hr />\n\n          <button className=\"text\" onClick={closePopover} style={{ margin: 0 }}>\n            Close\n          </button>\n        </Paper>\n      )}\n    </Popover>\n  </div>\n}\n\nexport default withLocalization(IconPicker)\n","import { useRef, useCallback, useState, useEffect } from 'react'\n\nimport HtmlInput from './HtmlInput.js'\nimport useCheckPath from '../../hooks/useCheckPath.js'\n\nfunction PathInput({\n  defaultValue = '',\n  onChange,\n  onBlur,\n  onSubmit,\n  onError,\n  allowExisting = false,\n  placeholder = 'de-bonn',\n  ...props\n}) {\n  const mountedRef = useRef(false)\n  useEffect(() => {\n    mountedRef.current = true\n    return () => {\n      mountedRef.current = false\n    }\n  }, [])\n\n  const checkPath = useCheckPath()\n\n  const [text, setText] = useState(defaultValue)\n\n  const handleTextChange = useCallback(async newText => {\n    newText = newText.toLowerCase()\n    setText(newText)\n\n    let isSubmittable = true\n    let error = ''\n    if (newText !== '') {\n      const {\n        isOkay,\n        errors\n      } = (await checkPath(newText)) || {}\n      \n      isSubmittable = isOkay\n      error = errors.join('\\n')\n    }\n\n    if (isSubmittable && onChange) {\n      onChange(newText)\n    }\n\n    if (onError) {\n      onError(error)\n    }\n  }, [\n    setText,\n    checkPath,\n    onChange,\n    onError,\n  ])\n\n  const handleBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur(text)\n    }\n  }, [onBlur, text])\n\n  return <HtmlInput\n    onChange={handleTextChange}\n    onBlur={handleBlur}\n    defaultValue={defaultValue}\n    placeholder={placeholder}\n    linebreaks={false}\n    {...props}\n  />\n}\n\nexport default PathInput\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { checkPath_Query } from '../graphql/queries'\n\nexport default function useCheckPath() {\n  const apollo_client = useApolloClient()\n\n  const handleCheckPath = useCallback((path = '') => {\n    return new Promise(resolve => {\n      apollo_client.query({\n        query: checkPath_Query,\n        variables: {\n          path,\n        },\n      })\n        .then(async ({ data }) => {\n          if (data.hasOwnProperty('checkPath')) {\n            resolve(data.checkPath)\n          } else {\n            resolve(null)\n          }\n        })\n        .catch(async error => {\n          console.error('error', error)\n          resolve(null)\n        })\n    })\n  }, [apollo_client])\n\n  return handleCheckPath\n}\n","import { useState, useCallback, useEffect } from 'react'\n\nimport FancyInput from './FancyInput.js'\nimport PathInput from './PathInput.js'\n// import HtmlInput from './HtmlInput.js'\n\nimport { useLocalization } from '../../fluent/Localized.js'\n\nfunction TriggerInput({\n  defaultValue,\n  className,\n  style,\n  onChange,\n}) {\n  const { getString } = useLocalization()\n\n  const [properties, setProperties] = useState({})\n\n  useEffect(() => {\n    defaultValue.type = 'path'\n    setProperties(defaultValue)\n  }, [\n    defaultValue,\n    setProperties,\n  ])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue) => {\n    const propertyTypes = {\n      type: 'string',\n      path: 'string',\n      url: 'string',\n      cron: 'string',\n      blockId: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n\n      if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n        setProperties(newProperties)\n        if (onChange) {\n          onChange(newProperties)\n        }\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const type = properties.type || ''\n\n  let morePropsInput = null\n  if (type === 'click') {\n    morePropsInput = null\n  } else if (type === 'path') {\n    morePropsInput = <>\n      <FancyInput\n        style={{\n          flexGrow: '1',\n        }}\n      >\n        {({ setError }) => (\n          <PathInput\n            onError={setError}\n            placeholder={getString('trigger_input_path_placeholder')}\n            defaultValue={properties.path}\n            onBlur={newValue => updateProperty('path', newValue)}\n            style={{\n              flexGrow: '1',\n              margin: '0',\n              minWidth: '300px',\n            }}\n            // className=\"show_border_on_active\"\n          />\n        )}\n      </FancyInput>\n    </>\n  // } else if (type === 'cron') {\n  //   morePropsInput = <>cron: String</>\n  // } else if (type === 'block_change') {\n  //   morePropsInput = <>blockId: ID</>\n  }\n\n  return <div\n    className={className}\n    style={{\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'flex-start',\n      maxWidth: '100%',\n      flexWrap: 'wrap',\n      gap: 'var(--basis)',\n      ...style\n    }}\n  >\n    {/*\n    <select\n      key={properties.type}\n      onChange={event => updateProperty('type', event.target.value)}\n      defaultValue={properties.type || ''}\n      style={{\n        margin: '0',\n      }}\n    >\n      <option value=\"\">No Trigger</option>\n      <option value=\"path\">Path</option>\n      <option value=\"click\">Click</option>\n      <option value=\"cron\">Cron</option>\n      <option value=\"block_change\">Block Change</option>\n    </select>\n    */}\n\n    {morePropsInput}\n  </div>\n}\n\nexport default TriggerInput\n","import { useState, useCallback, useEffect } from 'react'\n\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\nimport HtmlInput from './HtmlInput.js'\n\nimport { useLocalization } from '../../fluent/Localized.js'\n\nfunction ActionInput({\n  defaultValue,\n  className,\n  style,\n  onChange,\n}) {\n  const { getString } = useLocalization()\n\n  const [properties, setProperties] = useState({})\n\n  useEffect(() => {\n    defaultValue.type = 'open_url'\n    setProperties(defaultValue)\n  }, [\n    defaultValue,\n    setProperties,\n  ])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue) => {\n    const propertyTypes = {\n      type: 'string',\n      path: 'string',\n      url: 'string',\n      cron: 'string',\n      blockId: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n\n      if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n        setProperties(newProperties)\n        if (onChange) {\n          onChange(newProperties)\n        }\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const type = properties.type || ''\n\n  let morePropsInput = null\n  if (\n    type === 'open_url'\n    || type === 'send_payload'\n  ) {\n    morePropsInput = <>\n      <FancyInput\n        style={{\n          flexGrow: '1',\n          margin: '0',\n          minWidth: '300px',\n        }}\n      >\n        {({ setError }) => (\n          <UrlInput\n            onError={setError}\n            onBlur={newValue => updateProperty('url', newValue)}\n            defaultValue={properties.url}\n            placeholder={getString('action_input_url_placeholder')}\n            type=\"text\"\n            style={{\n              flexGrow: 1,\n              margin: '0',\n              width: '100%'\n            }}\n            // className=\"show_border_on_active\"\n          />\n        )}\n      </FancyInput>\n    </>\n  } else if (\n    type === 'render_block'\n    || type === 'run_block'\n  ) {\n    morePropsInput = <HtmlInput\n        placeholder=\"blockId\"\n        defaultValue={properties.blockId}\n        onBlur={newValue => updateProperty('blockId', newValue)}\n        linebreak={false}\n        style={{\n          flexGrow: '1',\n          margin: '0',\n          minWidth: '300px',\n        }}\n        // className=\"show_border_on_active\"\n      />\n  }\n\n  return <div\n    className={className}\n    style={{\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'flex-start',\n      maxWidth: '100%',\n      flexWrap: 'wrap',\n      gap: 'var(--basis)',\n      ...style\n    }}\n  >\n    {/*\n    <select\n      key={properties.type}\n      onChange={event => updateProperty('type', event.target.value)}\n      defaultValue={properties.type || ''}\n      style={{\n        margin: '0',\n      }}\n    >\n      <option value=\"\">No Action</option>\n      <option value=\"open_url\">Open URL</option>\n      <option value=\"render_block\">Render Block</option>\n      <option value=\"run_block\">Run Block</option>\n      <option value=\"send_payload\">Send Payload</option>\n    </select>\n    */}\n\n    {morePropsInput}\n  </div>\n}\n\nexport default ActionInput\n\n\n/*\n\n  let morePropsInput = null\n  if (\n    type === 'open_url'\n    || type === 'send_payload'\n  ) {\n    morePropsInput = <>\n      <UrlInput />\n    </>\n  } else if (\n    type === 'render_block'\n    || type === 'run_block'\n  ) {\n    morePropsInput = <>blockId: ID</>\n  }\n\n\n      <option key=\"editor\" value=\"\"></option>\n      <option key=\"editor\" value=\"open_url\">Open URL</option>\n      <option key=\"viewer\" value=\"render_block\">Render Block</option>\n      <option key=\"viewer\" value=\"run_block\">Run Block</option>\n      <option key=\"viewer\" value=\"send_payload\">Send Payload</option>\n      */\n","import { useState, useCallback, useEffect } from 'react'\n\n// import { v4 as uuidv4 } from 'uuid'\n\nimport classes from './PropertiesEditor.module.css'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n// import UrlInput from './UrlInput.js'\nimport CheckboxInput from './CheckboxInput.js'\nimport HtmlInput from './HtmlInput.js'\n// import FancyInput from './FancyInput.js'\nimport CoverphotoPicker from './CoverphotoPicker.js'\nimport IconPicker from './IconPicker.js'\nimport TriggerInput from './TriggerInput.js'\nimport ActionInput from './ActionInput.js'\n\n// function stripTmpIds(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\n// function addTmpIds(array) {\n//   return [...(array || [])].map(obj => {\n//     if (!obj.tmp_id) {\n//       const obj_new = { ...obj }\n//       obj_new.tmp_id = uuidv4()\n//       return obj_new\n//     }\n//\n//     return obj\n//   })\n// }\n\nfunction PropertiesEditor({ getString, type, defaultProperties = {}, onChange }) {\n  const [properties, setProperties] = useState({})\n\n  // const [coverphoto, setCoverphoto] = useState('')\n  // const [imprint, setImprint] = useState('')\n  // const [privacy_policy, setPrivacyPolicy] = useState('')\n  // const [link, setLink] = useState('')\n\n  // let [voltTeams, setVoltTeams] = useState([])\n  // voltTeams = voltTeams.map(({ id, name }) => ({ value: id, label: name }))\n\n  // const [voltTeamInfos, setVoltTeamInfos] = useState({\n  //   id: null,\n  //   name: ''\n  // })\n  // const setVoltTeamInfosFromSelect = useCallback((data) => {\n  //   setVoltTeamInfos({\n  //     id: data.value,\n  //     name: data.label,\n  //   })\n  // }, [setVoltTeamInfos])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue, silent = false) => {\n    const propertyTypes = {\n      text: 'string',\n      coverphoto: 'string',\n      icon: 'string',\n      imprint: 'string',\n      privacy_policy: 'string',\n      tags: 'string',\n      checked: 'boolean',\n      trigger: 'object',\n      action: 'object',\n      pronouns: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n    }\n\n    if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n      setProperties(newProperties)\n      if (silent === false && onChange) {\n        onChange(newProperties)\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const publishProperties = useCallback(() => {\n    if (onChange) {\n      onChange(properties)\n    }\n  }, [properties, onChange])\n\n  useEffect(() => {\n    setProperties({\n      ...defaultProperties,\n      text: defaultProperties.text || '',\n    })\n  }, [\n    defaultProperties,\n    setProperties,\n  ])\n\n\n  // useEffect(() => {\n  //   fetch(`${window.domains.backend}teams_simple.json`, {\n  //     mode: 'cors',\n  //     credentials: 'include',\n  //   })\n  //     .then(response => response.json())\n  //     .then(data => {\n  //       if (typeof data.error === 'string') {\n  //         setVoltTeams([])\n  //       } else {\n  //         setVoltTeams(data)\n  //       }\n  //     })\n  //     .catch(error => {\n  //       console.error(error)\n  //       setVoltTeams([])\n  //     })\n  // }, [ setVoltTeams ])\n\n  let propertiesFrameContent = null\n  // if (type === 'page') {\n  //   propertiesFrameContent = <>\n  //     <div className={classes.properties_row}>\n  //     <h3><Localized id=\"properties_editor_imprint_label\" /></h3>\n  //     <div>\n  //     <FancyInput>\n  //       {({ setError }) => (\n  //         <UrlInput\n  //           onError={setError}\n  //           onBlur={newValue => updateProperty('imprint', newValue)}\n  //           defaultValue={properties.imprint}\n  //           type=\"text\"\n  //           style={{\n  //             margin: '0',\n  //             width: '100%'\n  //           }}\n  //           // className=\"show_border_on_active\"\n  //         />\n  //       )}\n  //     </FancyInput>\n  //     </div>\n  //     </div>\n  //\n  //     <div className={classes.properties_row}>\n  //     <h3><Localized id=\"properties_editor_privacy_policy_label\" /></h3>\n  //     <div>\n  //     <FancyInput>\n  //       {({ setError }) => (\n  //         <UrlInput\n  //           onError={setError}\n  //           onBlur={newValue => updateProperty('privacy_policy', newValue)}\n  //           defaultValue={properties.privacy_policy}\n  //           type=\"text\"\n  //           style={{\n  //             margin: '0',\n  //             width: '100%'\n  //           }}\n  //           // className=\"show_border_on_active\"\n  //         />\n  //       )}\n  //     </FancyInput>\n  //     </div>\n  //     </div>\n  //   </>\n  // // } else if (type === 'redirect') {\n  // //   propertiesFrameContent = <>\n  // //     <div className={classes.properties_row}>\n  // //     <h3><Localized id=\"path_editor_redirect_label\" /></h3>\n  // //     <FancyInput>\n  // //       {({ setError }) => (\n  // //         <UrlInput\n  // //           onError={setError}\n  // //           onBlur={newValue => updateProperty('link', newValue)}\n  // //           type=\"text\"\n  // //           placeholder={getString('path_editor_redirect_placeholder')}\n  // //           aria-label={getString('path_editor_redirect_label')}\n  // //           defaultValue={properties.link}\n  // //           style={{\n  // //             marginRight: '0',\n  // //             marginLeft: '0',\n  // //             width: '100%'\n  // //           }}\n  // //           className=\"show_border_on_active\"\n  // //         />\n  // //       )}\n  // //     </FancyInput>\n  // //     </div>\n  // //   </>\n  // } else if (type === 'person') {\n  //   propertiesFrameContent = <>\n  //     <div className={classes.properties_row}>\n  //       <h3><Localized id=\"properties_editor_pronouns_label\" /></h3>\n  //       <HtmlInput\n  //         defaultValue={properties.pronouns}\n  //         onChange={newValue => updateProperty('pronouns', newValue, true)}\n  //         onBlur={publishProperties}\n  //         placeholder={''}\n  //         style={{\n  //           margin: '0',\n  //           width: '100%',\n  //         }}\n  //         linebreaks={false}\n  //         className={`type_text`}\n  //       />\n  //     </div>\n  //   </>\n  // } else\n  if (type === 'checkbox') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_checked_label\" /></h3>\n        <CheckboxInput\n          onChange={newValue => updateProperty('checked', newValue)}\n          defaultValue={Boolean(properties.checked)}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  } else if (type === 'button') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_action_label\" /></h3>\n        <ActionInput\n          onChange={newValue => updateProperty('action', newValue)}\n          defaultValue={properties.action || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  } else if (type === 'page' || type === 'person') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_trigger_path_label\" /></h3>\n        <TriggerInput\n          onChange={newValue => updateProperty('trigger', newValue)}\n          defaultValue={properties.trigger || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  } else if (type === 'redirect') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_trigger_path_label\" /></h3>\n        <TriggerInput\n          onChange={newValue => updateProperty('trigger', newValue)}\n          defaultValue={properties.trigger || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_action_url_label\" /></h3>\n        <ActionInput\n          onChange={newValue => updateProperty('action', newValue)}\n          defaultValue={properties.action || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  }\n  // else if (type === 'automation') {\n  //   propertiesFrameContent = <>\n  //     <div className={classes.properties_row}>\n  //       <h3><Localized id=\"properties_editor_trigger_label\" /></h3>\n  //       <TriggerInput\n  //         onChange={newValue => updateProperty('trigger', newValue)}\n  //         defaultValue={properties.trigger || {}}\n  //         style={{\n  //           marginRight: '0',\n  //           marginLeft: '0',\n  //           width: '100%'\n  //         }}\n  //       />\n  //     </div>\n  //     <div className={classes.properties_row}>\n  //       <h3><Localized id=\"properties_editor_action_label\" /></h3>\n  //       <ActionInput\n  //         onChange={newValue => updateProperty('action', newValue)}\n  //         defaultValue={properties.action || {}}\n  //         style={{\n  //           marginRight: '0',\n  //           marginLeft: '0',\n  //           width: '100%'\n  //         }}\n  //       />\n  //     </div>\n  //   </>\n  // }\n\n  return <>\n    {\n      type === 'page'\n      || type === 'person'\n      || type === 'redirect'\n      ? <>\n          <CoverphotoPicker\n            coverphotoValue={properties.coverphoto}\n            iconValue={properties.icon}\n            onChange={newValue => updateProperty('coverphoto', newValue)}\n          />\n          <IconPicker\n            iconValue={properties.icon}\n            coverphotoValue={properties.coverphoto}\n            onChange={newValue => updateProperty('icon', newValue)}\n          />\n        </>\n      : null\n    }\n\n    <div className={classes.main_headline} style={{\n      paddingLeft: 'calc(8 * var(--basis))',\n    }}>\n      <HtmlInput\n        defaultValue={properties.text}\n        onChange={newValue => updateProperty('text', newValue, true)}\n        onBlur={publishProperties}\n\n        placeholder={getString('placeholder_main_headline')}\n        style={{\n          padding: 'var(--basis) var(--basis_x2)',\n        }}\n        linebreaks={true}\n        className={`type_h1`}\n      />\n    </div>\n\n    <div className={classes.propertiesFrame} style={\n      propertiesFrameContent === null\n        ? { display: 'none' }\n        : null\n    }>\n      {propertiesFrameContent}\n\n      {/* <div className={classes.properties_row}>\n        <h3><Localized id=\"path_editor_tags_label\" /></h3>\n        <HtmlInput\n          onBlur={newValue => updateProperty('tags', newValue)}\n          type=\"text\"\n          placeholder={getString('path_editor_tags_placeholder')}\n          aria-label={getString('path_editor_tags_label')}\n          defaultValue={properties.tags}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: 'calc(100% - var(--basis_x2))'\n          }}\n        />\n      </div> */}\n\n      {/*\n        voltTeams && voltTeams.length > 0\n        ? <>\n          <h3><Localized id=\"path_editor_belongs_to_team_label\" /></h3>\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}><Localized id=\"path_editor_belongs_to_team_info\" /></em>\n          <Select\n            defaultValue={{\n              value: voltTeamInfos !== null ? voltTeamInfos.id || null : null,\n              label: voltTeamInfos !== null ? voltTeamInfos.name || '' : '',\n            }}\n            defaultInputValue={voltTeamInfos !== null ? voltTeamInfos.name || '' : ''}\n            onChange={setVoltTeamInfosFromSelect}\n            ariaLabel={getString('path_editor_belongs_to_team_search_placeholder')}\n            label={getString('path_editor_belongs_to_team_search_placeholder')}\n            placeholder={getString('path_editor_belongs_to_team_search_placeholder')}\n            options={voltTeams}\n            styles={custom_react_select_styles}\n            theme={custom_react_select_theme}\n          />\n        </>\n        : null\n      */}\n    </div>\n  </>\n}\n\nexport default withLocalization(PropertiesEditor)\n","import React, { useState, useEffect, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockTextRaw({\n  getString,\n  block = {},\n  onChange,\n  onSaveBlock,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  onAddRowAfter,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState('')\n\n  useEffect(() => {\n    setText(properties.text || '')\n  }, [properties.text, setText])\n\n  const publishTextChange = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  let text_style_class = 'type_text'\n  if (properties.hasOwnProperty('text_style')) {\n    text_style_class = 'type_'+properties.text_style\n  }\n\n  const {\n    color,\n  } = getBlockColor(block)\n\n  const colorStyles = {}\n  if (color) {\n    colorStyles.color = color\n  }\n\n  return <HtmlInput\n    defaultValue={text}\n    onChange={setText}\n    onBlur={publishTextChange}\n\n    placeholder={getString('placeholder_text')}\n    style={{\n      margin: '0',\n      backgroundColor: 'transparent',\n      ...colorStyles,\n    }}\n    linebreaks={true}\n    className={`hide_border ${text_style_class}`}\n\n    onInputRef={onInputRef}\n    onGoToPrevInput={onGoToPrevInput}\n    onGoToNextInput={onGoToNextInput}\n    onMergeToPrevInput={() => onMergeToPrevInput(block)}\n    onMergeFromNextInput={() => onMergeFromNextInput(block)}\n    onSplitText={onSplitText}\n  />\n}\n\nconst InlineEditorBlockText = withLocalization(InlineEditorBlockTextRaw)\n\nexport default InlineEditorBlockText\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport FancyInput from './FancyInput.js'\nimport HtmlInput from './HtmlInput.js'\nimport UrlInput from './UrlInput.js'\n\nfunction InlineEditorBlockButtonRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n  const {\n    action = {}\n  } = properties\n  const [link, setLink] = useState(action.url || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      const newBlock = {\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      }\n\n      if (link === '') {\n        if (newBlock.properties.hasOwnProperty('trigger')) {\n          delete newBlock.properties.trigger\n        }\n        if(newBlock.properties.hasOwnProperty('action')) {\n          delete newBlock.properties.action\n        }\n      } else {\n        newBlock.properties.trigger = {\n          type: 'click'\n        }\n        newBlock.properties.action = {\n\t\t\t\t  type: 'open_url',\n\t\t\t\t  url: link,\n\t\t\t  }\n      }\n\n      onChange(newBlock)\n    }\n  }, [onChange, block, text, link])\n  \n  const {\n    color,\n    colorRGB,\n    contrastingColor,\n  } = getBlockColor(block)\n\n  const colorStyles = {}\n  if (color) {\n    colorStyles['--on-background-rgb'] = colorRGB\n    colorStyles['--button-background'] = color\n    colorStyles['--button-color'] = contrastingColor\n  }\n\n  return <div style={{\n    margin: '0 0 var(--basis) 0',\n    cursor: 'auto',\n    ...colorStyles,\n  }}\n  className=\"clickable_card active\"\n  >\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_button')}\n      style={{\n        margin: '0',\n        ...colorStyles,\n      }}\n      linebreaks={true}\n      className=\"hide_border type_button default\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n\n    <FancyInput>\n      {({ setError }) => (\n        <UrlInput\n          onError={setError}\n          onChange={setLink}\n          onBlur={publishChanges}\n          type=\"text\"\n          defaultValue={link}\n          placeholder={getString('action_input_url_placeholder')}\n          style={{\n            margin: 'var(--basis) 0 0 0',\n            width: '100%',\n          }}\n        />\n      )}\n    </FancyInput>\n  </div>\n}\n\nconst InlineEditorBlockButton = withLocalization(InlineEditorBlockButtonRaw)\n\nexport default InlineEditorBlockButton\n","import React, { useRef, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport {\n  // AutoAwesomeSharp as ActionIcon,\n  LinkSharp as RedirectIcon,\n  ArrowForward as ToIcon,\n} from '@mui/icons-material'\n\nimport FancyInput from './FancyInput.js'\nimport HtmlInput from './HtmlInput.js'\nimport UrlInput from './UrlInput.js'\nimport PathInput from './PathInput.js'\n\n\nfunction InlineEditorBlockRedirectRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  style = {},\n}) {\n  const properties = block.properties || {}\n  const {\n    trigger = {},\n    action = {}\n  } = properties\n\n  const textRef = useRef(properties.text || '')\n  const text = textRef.current\n  const setText = newValue => textRef.current = newValue\n\n  const triggerPathRef = useRef(trigger.path || '')\n  const triggerPath = triggerPathRef.current\n  const setTriggerPath = newValue => triggerPathRef.current = newValue\n\n  const linkRef = useRef(action.url || '')\n  const link = linkRef.current\n  const setLink = newValue => linkRef.current = newValue\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      const text = textRef.current\n      const triggerPath = triggerPathRef.current\n      const link = linkRef.current\n\n      const newBlock = {\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      }\n\n      if (triggerPath === '') {\n        if (newBlock.properties.hasOwnProperty('trigger')) {\n          delete newBlock.properties.trigger\n        }\n      } else {\n        newBlock.properties.trigger = {\n          type: 'path',\n          path: triggerPath,\n        }\n      }\n\n      if (link === '') {\n        if(newBlock.properties.hasOwnProperty('action')) {\n          delete newBlock.properties.action\n        }\n      } else {\n        newBlock.properties.action = {\n\t\t\t\t  type: 'open_url',\n\t\t\t\t  url: link,\n\t\t\t  }\n      }\n\n      onChange(newBlock)\n    }\n  }, [ onChange, block ])\n  \n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  return <div style={{\n    ...style,\n    margin: '0 0 var(--basis) 0',\n    cursor: 'auto',\n    '--on-background-rgb': colorRGB,\n  }}\n  className=\"clickable_card active\"\n  >\n    <div style={{ width: '100%', display: 'flex', alignItems: 'center', color }}>\n      <RedirectIcon\n        style={{\n          margin: 'var(--basis)',\n        }}\n      />\n\n      <HtmlInput\n        defaultValue={text}\n        onChange={setText}\n        onBlur={publishChanges}\n\n        placeholder={getString('placeholder_headline_main')}\n        style={{\n          flexGrow: '1',\n          width: '100%',\n          margin: '0',\n          fontWeight: 'bold',\n          backgroundColor: 'transparent',\n          color,\n        }}\n        linebreaks={true}\n        className=\"hide_border type_text\"\n\n        onInputRef={onInputRef}\n        onGoToPrevInput={onGoToPrevInput}\n        onGoToNextInput={onGoToNextInput}\n        onMergeToPrevInput={() => onMergeToPrevInput(block)}\n        onMergeFromNextInput={() => onMergeFromNextInput(block)}\n        onSplitText={onSplitText}\n      />\n    </div>\n\n    <div style={{ paddingInlineStart: 'var(--basis_x8)', width: '100%', display: 'flex', alignItems: 'center', }}>\n      volt.link/\n      <FancyInput style={{ width: '100%', marginInlineStart: 'var(--basis)' }}>\n        {({ setError }) => (\n          <PathInput\n            onError={setError}\n            onChange={setTriggerPath}\n            onBlur={publishChanges}\n            defaultValue={triggerPath}\n            placeholder={getString('trigger_input_path_placeholder')}\n            style={{\n              margin: 'var(--basis) 0',\n              width: '100%',\n            }}\n          />\n        )}\n      </FancyInput>\n    </div>\n\n    <div style={{ paddingInlineStart: 'var(--basis_x8)', width: '100%', display: 'flex', alignItems: 'center', }}>\n      <ToIcon\n        style={{\n          flexShrink: 0,\n          margin: '0 var(--basis) 0 0',\n        }}\n      />\n\n      <FancyInput style={{ width: '100%' }}>\n        {({ setError }) => (\n          <UrlInput\n            onError={setError}\n            onChange={setLink}\n            onBlur={publishChanges}\n            type=\"text\"\n            defaultValue={link}\n            placeholder={getString('path_editor_item_link_label')}\n            style={{\n              margin: 'var(--basis) 0',\n              width: '100%',\n            }}\n          />\n        )}\n      </FancyInput>\n    </div>\n  </div>\n}\n\nconst InlineEditorBlockRedirect = withLocalization(InlineEditorBlockRedirectRaw)\n\nexport default InlineEditorBlockRedirect\n","import { getBlockColor } from '../../functions.js'\n\nexport default function InlineEditorBlockDivider({ block }) {\n  const {\n    color,\n  } = getBlockColor(block)\n\n  const styles = {}\n  if (color) {\n    styles['--on-background'] = color\n  }\n\n  return <hr style={styles} />\n}\n","import React, { useState, useCallback, useRef } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport HtmlInput from './HtmlInput.js'\nimport CheckboxInput from './CheckboxInput.js'\n\nfunction InlineEditorBlockCheckboxRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n  const checked = useRef(Boolean(properties.checked))\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n          checked: checked.current,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  const saveChecked = useCallback(newValue => {\n    checked.current = newValue\n    publishChanges()\n  }, [ publishChanges ])\n\n  return <div style={{ display: 'flex' }}>\n    <CheckboxInput\n      checked={checked.current}\n      onChange={saveChecked}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_text')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n        backgroundColor: 'transparent',\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockCheckbox = withLocalization(InlineEditorBlockCheckboxRaw)\n\nexport default InlineEditorBlockCheckbox\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\n\nimport {\n  Face as PersonPlaceholderIcon,\n} from '@mui/icons-material'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockPersonRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n  \n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  return <div\n    style={{\n      display: 'flex',\n      margin: '0 0 var(--basis) 0',\n      cursor: 'auto',\n      '--on-background-rgb': colorRGB,\n      color: color,\n    }}\n    className=\"clickable_card active\"\n  >\n    <PersonPlaceholderIcon\n      style={{\n        margin: 'var(--basis)',\n      }}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_text')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n        fontWeight: 'bold',\n        backgroundColor: 'transparent',\n        color,\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockPerson = withLocalization(InlineEditorBlockPersonRaw)\n\nexport default InlineEditorBlockPerson\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport {\n  InsertDriveFile as PagePlaceholderIcon,\n} from '@mui/icons-material'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockPageRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n  \n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  return <div\n    style={{\n      display: 'flex',\n      margin: '0 0 var(--basis) 0',\n      cursor: 'auto',\n      '--on-background-rgb': colorRGB,\n      color: color,\n    }}\n    className=\"clickable_card active\"\n  >\n    <PagePlaceholderIcon\n      style={{\n        margin: 'var(--basis)',\n      }}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_headline_main')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n        fontWeight: 'bold',\n        backgroundColor: 'transparent',\n        color,\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockPage = withLocalization(InlineEditorBlockPageRaw)\n\nexport default InlineEditorBlockPage\n","import React, { useState, useCallback, useEffect } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport BlockMenu from './BlockMenu.js'\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\n\nimport InlineEditorBlockText from './InlineEditorBlockText.js'\nimport InlineEditorBlockButton from './InlineEditorBlockButton.js'\nimport InlineEditorBlockRedirect from './InlineEditorBlockRedirect.js'\nimport InlineEditorBlockDivider from './InlineEditorBlockDivider.js'\nimport InlineEditorBlockCheckbox from './InlineEditorBlockCheckbox.js'\nimport InlineEditorBlockPerson from './InlineEditorBlockPerson.js'\nimport InlineEditorBlockPage from './InlineEditorBlockPage.js'\n// import InlineEditorBlockCode from './InlineEditorBlockCode.js'\n\nimport classes from './InlineEditorBlock.module.css'\n\n// function addIds(array){\n//   if (Array.isArray(array)) {\n//     return array.map(item => {\n//       let new_item = { ...item }\n//       if (!new_item.hasOwnProperty('_id')) {\n//         new_item._id = uuidv4()\n//       }\n//       return new_item\n//     })\n//   }\n//   return array\n// }\n\n// function stripIDs(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\nfunction InlineEditorBlockInbetweenComponent({ type = 'text', ...props }){\n  let component = null\n\n  switch (type) {\n    case 'button':\n      component = <InlineEditorBlockButton {...props} />\n    break;\n    case 'redirect':\n      component = <InlineEditorBlockRedirect {...props} />\n    break;\n    case 'divider':\n      component = <InlineEditorBlockDivider {...props} />\n    break;\n    case 'checkbox':\n      component = <InlineEditorBlockCheckbox {...props} />\n    break;\n    case 'person':\n      component = <InlineEditorBlockPerson {...props} />\n    break;\n    case 'page':\n      component = <InlineEditorBlockPage {...props} />\n    break;\n    // case 'code':\n    //   component = <InlineEditorBlockCode {...props} />\n    // break;\n    default:\n      component = <InlineEditorBlockText {...props} />\n  }\n\n  return component\n}\n\nfunction InlineEditorBlockRaw({\n  fluentByObject,\n  getString,\n  contentConfig = {},\n  className,\n  onChange,\n  reorderHandle,\n  onRemoveRow,\n  actionButton,\n  dataset = {},\n  addRowBefore,\n  addRowAfter,\n  permissions = [],\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n  onRemoveSelf,\n}) {\n  const saveBlock = useSaveBlock()\n\n  // const defaultLocale = getString('default_locale')\n\n  const [block, setBlock] = useState({\n    ...(contentConfig.block || { type: 'text' }),\n    _id: contentConfig.blockId || null,\n  })\n  const properties = block.properties || {}\n  const active = typeof properties.active === 'boolean' ? properties.active : true\n\n  useEffect(() => {\n    if (contentConfig.block) {\n      setBlock(contentConfig.block)\n    }\n  }, [contentConfig.block])\n\n  const saveBlockCallback = useCallback(newBlock => {\n    saveBlock(newBlock)\n      .then(gottenBlock => {\n        setBlock(gottenBlock)\n        if (!block._id || block._id !== gottenBlock._id) {\n          onChange({\n            blockId: gottenBlock._id,\n            block: gottenBlock,\n          })\n        }\n      })\n  }, [block, onChange, saveBlock])\n\n  const changeType = useCallback(newValue => {\n    const newBlock = {\n      ...block,\n      type: newValue,\n    }\n\n    saveBlockCallback(newBlock)\n  }, [ block, saveBlockCallback])\n\n  const saveProperty = useCallback((propertyName, newValue) => {\n    if (typeof propertyName === 'string') {\n      const newProperties = { ...block.properties }\n      if (newValue === null) {\n        delete newProperties[propertyName]\n      } else {\n        newProperties[propertyName] = newValue\n      }\n\n      if (newProperties !== block.properties) {\n        const newBlock = {\n          ...block,\n          properties: newProperties,\n        }\n\n        saveBlockCallback(newBlock)\n      }\n    }\n  }, [ block, saveBlockCallback ])\n\n  // const handleChange = useCallback(newBlock => {\n  //   setBlock(newBlock)\n\n  //   if (onChange) {\n  //     const target = wrapperDiv.current\n  //     target.value = newBlock\n  //     onChange({ target })\n  //   }\n  // }, [setBlock, onChange])\n\n  const handleBlockChange = useCallback(newBlock => {\n    if (JSON.stringify(newBlock) !== JSON.stringify(block)) {\n      saveBlock(newBlock)\n        .then((newBlock) => {\n          setBlock(newBlock)\n          if (!block._id || block._id !== newBlock._id) {\n            onChange({\n              blockId: newBlock._id,\n              block: newBlock,\n            })\n          }\n        })\n    }\n  }, [saveBlock, block, onChange])\n\n  const handleSaveBlock = useCallback((newBlock, callback) => {\n    saveBlock(newBlock)\n      .then(newBlock => {\n        if (callback) {\n          callback(newBlock)\n        }\n      })\n      .catch(console.error)\n  }, [ saveBlock ])\n\n  const onArchiveToggle = useCallback(newArchivedValue => {\n    if (typeof onRemoveSelf === 'function') {\n      onRemoveSelf()\n    }\n  }, [onRemoveSelf])\n\n  return <div\n    className={`${classes.block} ${className}`}\n    {...dataset}\n  >\n\n    <BlockMenu\n      {...{\n        block,\n        setType: changeType,\n        setProperty: saveProperty,\n        onRemoveRow,\n        addRowBefore,\n        addRowAfter,\n      }}\n\n      onArchivedToggle={onArchiveToggle}\n\n      trigger={props => (\n        <div\n          {...props}\n          className={classes.reorderHandle}\n        >\n          {reorderHandle}\n        </div>\n      )}\n    />\n\n    <div className={`${classes.block_input} ${(active ? classes.form_active : classes.form_deactivated)}`}>\n      <InlineEditorBlockInbetweenComponent\n        type={block.type}\n        block={block}\n        onChange={handleBlockChange}\n        onSaveBlock={handleSaveBlock}\n\n        onInputRef={onInputRef}\n        onGoToPrevInput={onGoToPrevInput}\n        onGoToNextInput={onGoToNextInput}\n        onSplitText={onSplitText}\n        onMergeToPrevInput={onMergeToPrevInput}\n        onMergeFromNextInput={onMergeFromNextInput}\n\n        onAddRowAfter={addRowAfter}\n      />\n    </div>\n\n  </div>\n}\n\nconst InlineEditorBlock = withLocalization(InlineEditorBlockRaw)\n\nexport default InlineEditorBlock\n","import { useState, useRef, useEffect, useCallback } from 'react'\n\nimport { v4 as uuidv4 } from 'uuid'\n\nimport {\n  Add as AddIcon,\n} from '@mui/icons-material'\nimport {\n  Tooltip,\n} from '@mui/material'\n\nimport { Localized } from '../../fluent/Localized.js'\nimport InlineEditorBlock from './InlineEditorBlock.js'\nimport useLoadBlocks from '../../hooks/useLoadBlocks.js'\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\nimport useArchiveBlock from '../../hooks/useArchiveBlock.js'\n// import { useTranslatedInputContext } from './TranslatedInput.js'\n\nimport AddMenu from './AddMenu.js'\n\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\nimport DragIndicatorIcon from '@mui/icons-material/DragIndicator'\n\nimport classes from './ContentEditor.module.css'\n\n// function stripTmpIds(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\nfunction addTmpIds(array) {\n  return [...array].map(obj => {\n    const obj_new = { ...obj }\n    obj_new.tmp_id = uuidv4()\n    return obj_new\n  })\n}\n\nfunction getFirstLineStartNode(element){\n  element.normalize()\n\n  const childNodes = element.childNodes\n  if (childNodes.length > 0) {\n    return childNodes[0]\n  }\n\n  return element\n}\n\nfunction getLastLineStartNode(element) {\n  element.normalize()\n\n  const childNodes = [...element.childNodes].reverse()\n  if (childNodes.length > 0) {\n    let lastLineNode = element\n    if (childNodes[0].nodeType === 3) {\n      for (const childNode of childNodes) {\n        if (childNode.nodeType === 3) {\n          lastLineNode = childNode\n        } else if (childNode.nodeType === 1) {\n          break\n        }\n      }\n    } else {\n      if (childNodes.length > 1) {\n        if (childNodes[1].nodeType === 3) {\n          const thisChildNodes = childNodes.slice(1)\n          for (const childNode of thisChildNodes) {\n            if (childNode.nodeType === 3) {\n              lastLineNode = childNode\n            } else if (childNode.nodeType === 1) {\n              break\n            }\n          }\n        }\n      }\n    }\n\n    return lastLineNode\n  }\n\n  return element\n}\n\nfunction moveCursorToOffsetInLine(contentEditableElement, lastLineStartNode, offset = 0) {\n  contentEditableElement.focus()\n\n  // If this function exists... (IE 9+)\n  if (window.getSelection) {\n    const lastLineStartNodeLength = (\n      lastLineStartNode.nodeType === 3\n        ? lastLineStartNode.length\n        : lastLineStartNode.innerText.length\n    )\n\n    if (offset === -1 || offset > lastLineStartNodeLength) {\n      offset = lastLineStartNodeLength\n    }\n\n    const range = document.createRange()\n    range.setStart(lastLineStartNode, 0)\n    range.setEnd(lastLineStartNode, offset)\n    range.collapse(false) // false = collapse to end\n    const sel = window.getSelection()\n    sel.removeAllRanges()\n    sel.addRange(range)\n  }\n}\n\nfunction reorder(list, startIndex, endIndex) {\n  const result = Array.from(list)\n  const [removed] = result.splice(startIndex, 1)\n  result.splice(endIndex, 0, removed)\n\n  return result\n}\n\nfunction ContentEditor({ parentId, defaultValue = [], onChange }) {\n  // const [contentConfigs, setContentConfigs] = useState([])\n  const contentConfigs_Ref = useRef([])\n  const contentConfigs = contentConfigs_Ref.current\n\n  // const [inputRefs, setInputRefs] = useState({})\n  const inputRefs_Ref = useRef({})\n  const inputRefs = inputRefs_Ref.current\n\n  const [updateCounter, setUpdateCounter] = useState(0)\n\n  const loadBlocks = useLoadBlocks()\n  const saveBlock = useSaveBlock()\n  const archiveBlock = useArchiveBlock()\n\n  const [autoFocus, setAutoFocus] = useState(null)\n  useEffect(()=>{\n    if (typeof autoFocus === 'object' && autoFocus !== null) {\n      if (\n        inputRefs.hasOwnProperty(autoFocus.tmp_id)\n      ) {\n        const inputRef = inputRefs[autoFocus.tmp_id]\n        if (\n          typeof inputRef === 'object'\n          && inputRef !== null\n        ) {\n          if (autoFocus.inFirstLine === true) {\n            const firstLineStartNode = getFirstLineStartNode(inputRef.current)\n            moveCursorToOffsetInLine(inputRef.current, firstLineStartNode, autoFocus.positionFromLineStart)\n          } else if (autoFocus.inLastLine === true) {\n            const lastLineStartNode = getLastLineStartNode(inputRef.current)\n            moveCursorToOffsetInLine(inputRef.current, lastLineStartNode, autoFocus.positionFromLineStart)\n          }\n          setAutoFocus(null)\n        }\n      }\n    }\n  }, [\n    autoFocus,\n    setAutoFocus,\n    inputRefs,\n  ])\n\n  useEffect(()=>{\n    async function loadMissingBlocks () {\n      let newContentConfigs = [...addTmpIds(defaultValue)]\n\n      const ids2load = newContentConfigs\n        .filter(contentConfig => !contentConfig.hasOwnProperty('block'))\n        .map(contentConfig => contentConfig.blockId)\n\n      let loadedBlocks = []\n      if (ids2load.length > 0) {\n        loadedBlocks = await loadBlocks({ ids: ids2load })\n      }\n      \n      newContentConfigs = newContentConfigs\n        .map(contentConfig => {\n          if (!contentConfig.hasOwnProperty('block')) {\n            contentConfig.block = loadedBlocks.find(block => block._id === contentConfig.blockId)\n          }\n          return contentConfig\n        })\n\n      contentConfigs_Ref.current = newContentConfigs\n      setUpdateCounter(old => old + 1)\n    }\n\n    if (contentConfigs.length === 0) {\n      if (defaultValue.length > 0) {\n        loadMissingBlocks()\n      }\n    }\n  }, [contentConfigs, defaultValue, loadBlocks, contentConfigs_Ref, setUpdateCounter])\n\n  const saveInputRef = useCallback((keys, inputRef) => {\n    const newInputRefs = {...inputRefs_Ref.current}\n\n    if (\n      !newInputRefs.hasOwnProperty(keys.tmp_id)\n      || newInputRefs[keys.tmp_id] !== inputRef\n    ) {\n      newInputRefs[keys.tmp_id] = inputRef\n      inputRefs_Ref.current = newInputRefs\n    }\n  }, [ inputRefs_Ref ])\n\n  const goToPrevInput = useCallback((keys, { caret }) => {\n    const index = keys.index\n\n    let prevInputRef = null\n    for (let thisIndex = contentConfigs.length-1; thisIndex >= 0; thisIndex--) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (thisIndex < index && inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        prevInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (prevInputRef) {\n      const lastLineStartNode = getLastLineStartNode(prevInputRef.current)\n      moveCursorToOffsetInLine(prevInputRef.current, lastLineStartNode, caret.positionFromLineStart)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const goToNextInput = useCallback((keys, { caret }) => {\n    const index = keys.index\n\n    let nextInputRef = null\n    for (let thisIndex = 0; thisIndex < contentConfigs.length; thisIndex++) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (thisIndex > index && inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        nextInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (nextInputRef) {\n      const firstLineStartNode = getFirstLineStartNode(nextInputRef.current)\n      moveCursorToOffsetInLine(nextInputRef.current, firstLineStartNode, caret.positionFromLineStart)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const focusLastLine = useCallback(() => {\n    let lastInputRef = null\n    for (let thisIndex = contentConfigs.length-1; thisIndex >= 0; thisIndex--) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        lastInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (lastInputRef) {\n      const lastLineStartNode = getLastLineStartNode(lastInputRef.current)\n      moveCursorToOffsetInLine(lastInputRef.current, lastLineStartNode, -1)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const handleRowChange = useCallback((keys, newContentConfig) => {\n    const newContentConfigs = [...contentConfigs]\n    for (const index in newContentConfigs) {\n      const oldContentConfig = newContentConfigs[index]\n      if (oldContentConfig.tmp_id === keys.tmp_id) {\n        newContentConfigs[index] = {\n          ...oldContentConfig,\n          ...newContentConfig,\n        }\n        break\n      }\n    }\n\n    contentConfigs_Ref.current = newContentConfigs\n    onChange(newContentConfigs)\n\n    return new Promise(resolve => {\n      resolve(newContentConfigs)\n    })\n  }, [contentConfigs, contentConfigs_Ref, onChange])\n\n  const addRowByIndex = useCallback((index, offset = 0, newContentConfig) => {\n    if (typeof newContentConfig === 'object') {\n      newContentConfig = {\n        tmp_id: uuidv4(),\n        ...newContentConfig,\n      }\n    } else {\n      newContentConfig = newContentConfig || { tmp_id: uuidv4() }\n    }\n\n    const newBlock = newContentConfig.block || null\n\n    if (\n      newBlock !== null\n      && typeof index === 'number'\n      && !isNaN(index)\n    ) {\n      saveBlock(newBlock)\n        .then(newBlock => {\n          newContentConfig.block = newBlock\n          newContentConfig.blockId = newBlock._id\n\n          let new_rows = [...contentConfigs]\n          new_rows.splice(index + offset, 0, newContentConfig)\n          contentConfigs_Ref.current = new_rows\n          onChange(new_rows)\n        })\n        .catch(console.error)\n    }\n  }, [contentConfigs, contentConfigs_Ref, saveBlock, onChange])\n\n  const createBlockByType = useCallback(({ type, close }) => {\n    const newBlock = { type }\n\n    if (typeof parentId === 'string' && parentId.length > 0) { // a valid parentId should be 24 char long\n      newBlock.parent = parentId\n    }\n\n    addRowByIndex(0, 0, { block: newBlock })\n\n    if (typeof close === 'function') {\n      close()\n    }\n  }, [addRowByIndex, parentId])\n\n  const onMergeToPrevInput = useCallback(keys => {\n    const {\n      index,\n    } = keys\n\n    const clonedContentConfigs = [...contentConfigs]\n    if (index > 0) {\n      const prev_index = index - 1\n      const prev_contentConfig = clonedContentConfigs[prev_index]\n      const prev_tmp_id = prev_contentConfig.tmp_id\n\n      const this_block = clonedContentConfigs[index].block\n      const prev_block = clonedContentConfigs[prev_index].block\n\n      const new_prev_block = {\n        ...prev_block,\n        properties: {\n          ...prev_block.properties,\n          text: prev_block.properties.text + this_block.properties.text,\n        },\n      }\n\n      const thisRef = inputRefs_Ref.current[prev_tmp_id]\n      const textLength = thisRef.current.textContent.length\n\n      saveBlock(new_prev_block)\n        .then(savedPrevBlock => {\n          const new_tmp_id = uuidv4()\n          handleRowChange({\n            index: prev_index,\n            tmp_id: prev_tmp_id,\n          }, {\n            ...prev_contentConfig,\n            tmp_id: new_tmp_id,\n            blockId: savedPrevBlock._id,\n            block: savedPrevBlock,\n          })\n            .then(newContentConfigs => {\n              const this_block = newContentConfigs[index].block\n              newContentConfigs.splice(index, 1) // delete the block\n\n              archiveBlock({ _id: this_block._id, archive: true })\n                .then(() => {\n                  contentConfigs_Ref.current = newContentConfigs\n                  setAutoFocus({\n                    tmp_id: new_tmp_id,\n                    positionFromLineStart: textLength,\n                    inFirstLine: false,\n                    inLastLine: true,\n                  })\n                  onChange(newContentConfigs)\n                })\n            })\n        })\n        .catch(console.error)\n    } else {\n      // This is the first row. Nothing to merge into.\n    }\n  }, [ contentConfigs, inputRefs_Ref, saveBlock, handleRowChange, archiveBlock, contentConfigs_Ref, setAutoFocus, onChange ])\n\n  const onMergeFromNextInput = useCallback(keys => {\n    const {\n      index,\n      tmp_id,\n    } = keys\n\n    const clonedContentConfigs = [...contentConfigs]\n    if (index < clonedContentConfigs.length - 1) {\n\n      const next_index = index + 1\n\n      const this_old_contentConfig = clonedContentConfigs[index]\n      const this_block = clonedContentConfigs[index].block\n      const next_block = clonedContentConfigs[next_index].block\n\n      const new_block = {\n        ...this_block,\n        properties: {\n          ...this_block.properties,\n          text: this_block.properties.text + next_block.properties.text,\n        },\n      }\n\n      const thisRef = inputRefs_Ref.current[tmp_id]\n      const textLength = thisRef.current.textContent.length\n\n      saveBlock(new_block)\n        .then(savedBlock => {\n          const new_tmp_id = uuidv4()\n          handleRowChange(keys, {\n            ...this_old_contentConfig,\n            tmp_id: new_tmp_id,\n            blockId: savedBlock._id,\n            block: savedBlock,\n          })\n            .then(newContentConfigs => {\n              const next_block = newContentConfigs[next_index].block\n              newContentConfigs.splice(next_index, 1) // delete the block\n\n              archiveBlock({ _id: next_block._id, archive: true })\n                .then(() => {\n                  contentConfigs_Ref.current = newContentConfigs\n                  setAutoFocus({\n                    tmp_id: new_tmp_id,\n                    positionFromLineStart: textLength,\n                    inFirstLine: false,\n                    inLastLine: true,\n                  })\n                  onChange(newContentConfigs)\n                })\n            })\n        })\n        .catch(console.error)\n\n\n\n\n      // // const firstBlock = rows[index]\n      // // const secondBlock = rows[index + 1]\n\n      // // get current text length (we know the caret is at the end of the text)\n      // const thisRef = inputRefs[tmp_id]\n      // const textLength = thisRef.current.textContent.length\n\n      // // refocus the input at the last caret position\n      // const lastLineStartNode = getLastLineStartNode(thisRef.current)\n      // moveCursorToOffsetInLine(thisRef.current, lastLineStartNode, textLength) // we can't use a text length of -1, as the text length will be changed after the merge\n    } else {\n      // This is the last row. Nothing to merge into.\n    }\n  }, [ contentConfigs, inputRefs_Ref, saveBlock, handleRowChange, archiveBlock, contentConfigs_Ref, setAutoFocus, onChange ])\n\n  const splitText = useCallback((keys, { texts }) => {\n    const {\n      index,\n      tmp_id,\n    } = keys\n\n    const newContentConfigs = [...contentConfigs]\n\n    const block = (newContentConfigs.find(block => block.tmp_id === tmp_id)).block || {}\n\n    const firstBlock = {\n      ...block,\n      properties: {\n        ...block.properties,\n        text: texts[0],\n      },\n    }\n\n    const secondBlock = {\n      ...block,\n      properties: {\n        ...block.properties,\n        text: texts[1],\n      },\n    }\n    delete secondBlock._id\n\n    saveBlock(firstBlock)\n      .then(savedFirstBlock => {\n        saveBlock(secondBlock)\n          .then(savedSecondBlock => {\n            newContentConfigs[index] = {\n              ...newContentConfigs[index],\n              tmp_id: uuidv4(),\n              blockId: savedFirstBlock._id,\n              block: savedFirstBlock,\n            }\n\n            const nextContentConfig = {\n              tmp_id: uuidv4(),\n              blockId: savedSecondBlock._id,\n              block: savedSecondBlock,\n            }\n            newContentConfigs.splice(index + 1, 0, nextContentConfig)\n\n            contentConfigs_Ref.current = newContentConfigs\n            onChange(newContentConfigs)\n            setAutoFocus({\n              tmp_id: nextContentConfig.tmp_id,\n              positionFromLineStart: 0,\n              inFirstLine: true,\n              inLastLine: false,\n            })\n          })\n          .catch(console.error)\n        })\n      .catch(console.error)\n  }, [\n    contentConfigs,\n    saveBlock,\n    contentConfigs_Ref,\n    onChange,\n    setAutoFocus,\n  ])\n\n  const handleRemoveSelf = useCallback(keys => {\n    const {\n      index,\n    } = keys\n\n    const newContentConfigs = [...contentConfigs]\n    newContentConfigs.splice(index, 1) // delete the block\n\n    contentConfigs_Ref.current = newContentConfigs\n\n    onChange(newContentConfigs)\n  }, [ contentConfigs, onChange ])\n\n  function onDragEnd(result) {\n    if (!result.destination) {\n      return\n    }\n\n    if (result.destination.index === result.source.index) {\n      return\n    }\n\n    const newContentConfigs = reorder(\n      contentConfigs,\n      result.source.index,\n      result.destination.index\n    )\n\n    contentConfigs_Ref.current = newContentConfigs\n    onChange(newContentConfigs)\n  }\n\n  const filteredContentConfigs = contentConfigs\n    .filter(Boolean)\n    .filter(contentConfig => contentConfig.tmp_id)\n\n  return <>\n  <div\n    key={updateCounter}\n    style={{\n      position: 'relative',\n      width: '1000px',\n      maxWidth: '100%',\n      margin: 'var(--basis_x8) auto 0 auto',\n    }}\n  >\n    <div>\n      <AddMenu\n        types={[\n          'button',\n          'text',\n          // 'checkbox',\n          // 'code',\n          'divider',\n          'page',\n          'redirect',\n        ]}\n        createBlock={createBlockByType}\n        trigger={triggerProps => \n          <button\n            {...triggerProps}\n            className=\"text hasIcon\"\n            style={{\n              margin: '0 0 var(--basis_x2) 0',\n            }}\n          >\n            <span style={{pointerEvents: 'none'}}>\n              <AddIcon className=\"icon\" />\n              <span style={{marginInlineStart: 'var(--basis_x2)', verticalAlign: 'middle'}}>\n                <Localized id=\"add_content_before\" />\n              </span>\n            </span>\n          </button>\n        }\n      />\n    </div>\n\n    <DragDropContext onDragEnd={onDragEnd}>\n      <Droppable\n        droppableId=\"list\"\n        isDropDisabled={false}\n      >\n        {provided => (\n          <div\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n            className=\"inputBorder\"\n            style={{\n              '--input-box-shadow': 'inset var(--basis_x8) 0 0 0 var(--background), inset var(--basis_x8) 0 0 var(--basis_x0_2) var(--on-background-contrast), inset 0 0 0 var(--basis_x0_2) var(--on-background-contrast)',\n              boxShadow: 'var(--input-box-shadow)',\n              paddingTop: filteredContentConfigs.length > 0 ? 'var(--basis)' : '',\n              paddingRight: 'var(--basis)',\n            }}\n          >\n            {\n              filteredContentConfigs\n              .map(\n                (contentConfig, index) => {\n                  const tmp_id = contentConfig.tmp_id\n                  const keys = {\n                    index,\n                    tmp_id,\n                  }\n\n                  return <Draggable\n                    key={tmp_id}\n                    draggableId={tmp_id}\n                    index={index}\n                    isDragDisabled={false}\n                    disableInteractiveElementBlocking={true}\n                    shouldRespectForcePress={true}\n                  >\n                    {provided => (\n                      <div\n                        ref={provided.innerRef}\n                        {...provided.draggableProps}\n\n                        key={tmp_id}\n                        className={classes.row}\n                      >\n                      <div className={classes.form}>\n                        <InlineEditorBlock\n                          key={tmp_id}\n                          className={classes.item}\n                          dataset={{\n                            'data-index': index,\n                            'data-id': tmp_id,\n                          }}\n                          contentConfig={contentConfig}\n\n                          reorderHandle={\n                            <Tooltip title={<div style={{ textAlign: 'center' }}>\n                              <strong>Drag</strong> to move.<br />\n                              <strong>Click</strong> to open menu.\n                            </div>}>\n                              <button\n                                className={`text ${classes.inlineRowButton} ${classes.dragHandleButton}`}\n                                {...provided.dragHandleProps}\n                              >\n                                <DragIndicatorIcon />\n                              </button>\n                            </Tooltip>\n                          }\n\n                          onRemoveSelf={ () => handleRemoveSelf(keys) }\n                          addRowBefore={ (newValue) => addRowByIndex(index, 0, newValue) }\n                          addRowAfter={ (newValue) => addRowByIndex(index, 1, newValue) }\n\n                          onInputRef={(inputRef) => saveInputRef(keys, inputRef)}\n                          onGoToPrevInput={(attr) => goToPrevInput(keys, attr)}\n                          onGoToNextInput={(attr) => goToNextInput(keys, attr)}\n                          onSplitText={(attr) => splitText(keys, attr)}\n                          onChange={(attr) => handleRowChange(keys, attr)}\n                          onMergeToPrevInput={(attr) => onMergeToPrevInput(keys, attr)}\n                          onMergeFromNextInput={(attr) => onMergeFromNextInput(keys, attr)}\n                          // {...repeater_props}\n                        />\n                      </div>\n                    </div>\n                    )}\n                  </Draggable>\n                }\n              )\n            }\n            {provided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    </DragDropContext>\n  </div>\n\n  <div\n    style={{\n      position: 'relative',\n      height: '50vh',\n      cursor: (filteredContentConfigs.length === 0 ? 'default' : 'text'),\n    }}\n    onClick={filteredContentConfigs.length === 0 ? null : focusLastLine}\n  ></div>\n  </>\n}\n\nexport default ContentEditor\n","import { useState, useCallback } from 'react'\n\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\n\nimport { Helmet } from 'react-helmet'\n\n// import Select from 'react-select'\n\nimport {\n  // TranslateSharp as TranslateIcon,\n  IosShareSharp as ShareIcon,\n  SaveSharp as SaveIcon,\n  MoreHorizSharp as BlockMenuIcon,\n} from '@mui/icons-material'\n\nimport MdiIcon from '@mdi/react'\nimport {\n  mdiTranslate,\n  mdiLockAlert, // mdiLock\n  mdiAccountLockOpen, // mdiAccountGroup\n  mdiEarth, // mdiLockOpen mdiEarth mdiLockOpenVariant\n} from '@mdi/js'\n\nimport classes from './PageEditor.module.css'\n\nimport { Localized, useLocalization } from '../../fluent/Localized.js'\n// import { useTranslatedInputContext, LocalesMenu } from '../edit/TranslatedInput.js'\n\nimport Header from '../Header.js'\nimport BlockMenu from '../edit/BlockMenu.js'\nimport SharingEditor from '../edit/SharingEditor.js'\nimport TranslationEditor from '../edit/TranslationEditor.js'\nimport PermissionsEditor from '../edit/PermissionsEditor.js'\nimport PropertiesEditor from '../edit/PropertiesEditor.js'\nimport ContentEditor from '../edit/ContentEditor.js'\n\n// const custom_react_select_styles = {\n//   menu: (provided, state) => ({\n//     ...provided,\n//     background: 'var(--purple)',\n//   }),\n// }\n// const custom_react_select_theme = theme => ({\n//   ...theme,\n//   borderRadius: 0,\n//   colors: {\n//     ...theme.colors,\n//     primary: 'var(--green)',\n//     primary25: 'var(--purple-dark)',\n//   },\n// })\n\nfunction PageEditor({\n  block,\n  onSaveBlock,\n}) {\n  const { getString } = useLocalization()\n\n  const saveBlock = useSaveBlock()\n\n  // const { currentLocale, setLocales } = useTranslatedInputContext()\n\n  const [ isSharingEditorOpen, setIsSharingEditorOpen ] = useState(false)\n  const openSharingEditor = useCallback(() => setIsSharingEditorOpen(true), [ setIsSharingEditorOpen ])\n  const closeSharingEditor = useCallback(() => setIsSharingEditorOpen(false), [ setIsSharingEditorOpen ])\n\n  const [ isTranslationEditorOpen, setIsTranslationEditorOpen ] = useState(false)\n  const openTranslationEditor = useCallback(() => setIsTranslationEditorOpen(true), [ setIsTranslationEditorOpen ])\n  const closeTranslationEditor = useCallback(() => setIsTranslationEditorOpen(false), [ setIsTranslationEditorOpen ])\n\n  const [ isPermissionsEditorOpen, setIsPermissionsEditorOpen ] = useState(false)\n  const openPermissionsEditor = useCallback(() => setIsPermissionsEditorOpen(true), [ setIsPermissionsEditorOpen ])\n  const closePermissionsEditor = useCallback(() => setIsPermissionsEditorOpen(false), [ setIsPermissionsEditorOpen ])\n\n  // const [block, setBlock] = useState({\n  //   type: defaultType || 'page',\n  //   properties: defaultProperties || {},\n  //   content: defaultContent || [],\n  //   ...defaultBlockRest,\n  // })\n  const type = block.type\n  const properties = block.properties\n  const content = block.content\n  const permissions = block.permissions\n\n  const saveType = useCallback(newType => {\n    if (newType !== block.type) {\n      const newBlock = {\n        ...block,\n        type: newType,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          onSaveBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, onSaveBlock])\n\n  const saveProperties = useCallback(newProperties => {\n    if (newProperties !== block.properties) {\n      const newBlock = {\n        ...block,\n        properties: newProperties,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          onSaveBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, onSaveBlock])\n\n  const saveProperty = useCallback((propertyName, newValue) => {\n    if (\n      typeof propertyName === 'string'\n    ) {\n      const newProperties = { ...properties }\n      if (newValue === null) {\n        delete newProperties[propertyName]\n      } else {\n        newProperties[propertyName] = newValue\n      }\n      \n      saveProperties(newProperties)\n    }\n  }, [properties, saveProperties])\n\n  const saveContent = useCallback(newContent => {\n    if (newContent !== block.content) {\n      const newBlock = {\n        ...block,\n        content: newContent,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          onSaveBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, onSaveBlock])\n\n  const savePermissions = useCallback(newPermissions => {\n    if (newPermissions !== block.permissions) {\n      const newBlock = {\n        ...block,\n        permissions: newPermissions,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          onSaveBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, onSaveBlock])\n\n  const manuallySaveEverything = useCallback(() => {\n    saveBlock(block)\n      .then(gottenBlock => {\n        if (gottenBlock._id !== block._id) {\n          onSaveBlock(gottenBlock)\n        }\n      })\n  }, [saveBlock, block, onSaveBlock])\n\n  // const isFirstRun = useRef(true)\n  // useEffect(() => {\n  //   if (isFirstRun.current) {\n  //     isFirstRun.current = false\n  //     return;\n  //   }\n  //\n  //   if (\n  //     Object.keys(block).length > 0\n  //     && JSON.stringify(initialBlock) !== JSON.stringify(block)\n  //   ) {\n  //   }\n  // }, [isFirstRun, initialBlock, block])\n\n\n\n  // START permissions icon\n  let PermissionsIcon = mdiLockAlert\n  if (\n    !!block\n    && !!block.computed\n    && !!block.computed.inherited_block_permissions\n    && Array.isArray(block.computed.inherited_block_permissions)\n  ) {\n    const inherited_block_permissions_obj = block.computed.inherited_block_permissions\n      .reduce((acc, curr) => {\n        acc[curr.email] = curr.role\n        return acc\n      }, {})\n\n    if (\n      inherited_block_permissions_obj['@public'] === 'viewer'\n      || inherited_block_permissions_obj['@public'] === 'editor'\n      || inherited_block_permissions_obj['@public'] === 'owner'\n    ) {\n      PermissionsIcon = mdiEarth\n    } else if (\n      inherited_block_permissions_obj['@volteuropa.org'] === 'viewer'\n      || inherited_block_permissions_obj['@volteuropa.org'] === 'editor'\n      || inherited_block_permissions_obj['@volteuropa.org'] === 'owner'\n    ) {\n      PermissionsIcon = mdiAccountLockOpen\n    }\n  }\n  // END permissions icon\n\n\n\n  const rightHeaderActions = <div className=\"buttonRow\" style={{ whiteSpace: 'nowrap' }}>\n    {/* <button className=\"text\"><Localized id=\"path_editor_share\"/></button> */}\n\n\n    {/*\n    <LocalesMenu\n      trigger={triggerProps => (\n        <button {...triggerProps} className=\"text hasIcon\">\n          <TranslateIcon className=\"icon\" />\n          <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}>\n            <Localized id=\"path_editor_translate\" />\n            {getString('locale_'+currentLocale)}\n          </span>\n        </button>\n      )}\n    />\n    */}\n\n    {\n      isSharingEditorOpen\n      ? <SharingEditor\n          defaultBlock={block}\n          open={isSharingEditorOpen}\n          onClose={closeSharingEditor}\n          onChange={saveProperties}\n        />\n      : null\n    }\n    <button className=\"text hasIcon\" onClick={openSharingEditor}>\n      <ShareIcon className=\"icon\" />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_share\" /></span>\n    </button>\n\n    {\n      type !== 'divider'\n      ? <>\n        {\n          isTranslationEditorOpen\n          ? <TranslationEditor\n              defaultBlock={block}\n              open={isTranslationEditorOpen}\n              onClose={closeTranslationEditor}\n              onSaveProperty={saveProperty}\n            />\n          : null\n        }\n        <button className=\"text hasIcon\" onClick={openTranslationEditor}>\n          <MdiIcon\n            path={mdiTranslate}\n            className=\"icon\"\n          />\n          <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_translate\" /></span>\n        </button>\n      </>\n      : null\n    }\n\n    {\n      isPermissionsEditorOpen\n      ? <PermissionsEditor\n          defaultPermissions={permissions}\n          open={isPermissionsEditorOpen}\n          onClose={closePermissionsEditor}\n          onChange={savePermissions}\n        />\n      : null\n    }\n    <button className=\"text hasIcon\" onClick={openPermissionsEditor}>\n      <MdiIcon\n        path={PermissionsIcon}\n        className=\"icon\"\n      />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_permissions\" /></span>\n    </button>\n\n    <button className=\"text hasIcon\" onClick={manuallySaveEverything}>\n      <SaveIcon className=\"icon\" />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_publish\" /></span>\n    </button>\n\n    <BlockMenu\n      {...{\n        block,\n        setType: saveType,\n        setProperty: saveProperty,\n      }}\n\n      typeOptions={[\n        'page',\n        'redirect',\n      ]}\n\n      trigger={props => (\n        <button\n          {...props}\n          className=\"default hasIcon\"\n        >\n          <BlockMenuIcon className=\"icon\" />\n        </button>\n      )}\n    />\n  </div>\n\n  const title = block.properties.text || getString('placeholder_main_headline')\n\n  return <div key={block._id} className={`hasHeader ${classes.editor} ${typeof type === 'string' && type !== '' ? classes['type_'+type] : ''}`}>\n    <Helmet>\n      <title> {title}</title>\n    </Helmet>\n    \n    <Header\n      block={block}\n      // title={<a href={`https://volt.link/${slug}`} target=\"_blank\" rel=\"noopener noreferrer\"><span className=\"hideOnSmallScreen\">volt.link</span>/{slug}</a>}\n      title={title}\n      rightActions={rightHeaderActions}\n    />\n\n    <PropertiesEditor\n      type={type}\n      defaultProperties={properties}\n      onChange={saveProperties}\n    />\n\n    <ContentEditor\n      parentId={block._id || null}\n      onChange={saveContent}\n      defaultValue={content}\n    />\n  </div>\n}\n\nexport default PageEditor\n","import { useRef, useState, useEffect, useCallback } from 'react'\n\nimport {\n  useParams,\n} from 'react-router-dom'\n\nimport classes from './Editor.module.css'\n\nimport useLoadBlock from '../hooks/useLoadBlock.js'\nimport useBlockMatchesRoles from '../hooks/useBlockMatchesRoles.js'\n\nimport Header from '../components/Header.js'\nimport { ErrorPage } from '../components/ErrorPages.js'\n\nimport PageEditor from '../components/apps/PageEditor.js'\n\nfunction Editor() {\n  const loadBlock = useLoadBlock()\n\n  const loadedTheBlock = useRef(false)\n  let { id = '' } = useParams()\n\n  const [block, setBlockInternal] = useState({\n    type: 'page',\n    properties: {},\n    content: [],\n  })\n\n  const setBlock = useCallback(newBlock => {\n    setBlockInternal(newBlock)\n  }, [ setBlockInternal ])\n\n  const [ canEdit, setCanEdit ] = useState(null)\n  const blockMatchesRoles = useBlockMatchesRoles()\n  useEffect(() => {\n    blockMatchesRoles(id, ['editor', 'owner'])\n      .then(matchesRoles => {\n        setCanEdit(matchesRoles)\n      })\n      .catch(error => {\n        console.error(error)\n        setCanEdit(false)\n      })\n  }, [ id, blockMatchesRoles, setCanEdit ])\n\n  useEffect(() => {\n    if (\n      canEdit\n      && typeof id === 'string'\n      && id !== ''\n      && (\n        !loadedTheBlock.current\n        || id !== block._id\n      )\n    ) {\n      loadBlock(id)\n        .then(loadedBlock => {\n          loadedTheBlock.current = true\n\n          setBlock(loadedBlock)\n        })\n    }\n  }, [\n    canEdit,\n    id,\n    block,\n    loadBlock,\n    setBlock,\n    // setLocales,\n  ])\n\n  // const isFirstRun = useRef(true)\n  // useEffect(() => {\n  //   if (isFirstRun.current) {\n  //     isFirstRun.current = false\n  //     return;\n  //   }\n  //\n  //   if (\n  //     Object.keys(block).length > 0\n  //     && JSON.stringify(initialBlock) !== JSON.stringify(block)\n  //   ) {\n  //   }\n  // }, [isFirstRun, initialBlock, block])\n\n  if (canEdit === false) {\n    return <div className={classes.editor}>\n      <Header\n        block={null}\n        title=\"Error\"\n        rightActions={null}\n      />\n      <div className={`basis_x1 ${classes.app} ${classes.spine_aligned}`} dir=\"auto\">\n        <main className={`${classes.contentWrapper}`}>\n          <ErrorPage errorName=\"no_access\" />\n        </main>\n      </div>\n    </div>\n  } else if (canEdit === true) {\n    return <PageEditor\n      block={block}\n      onSaveBlock={setBlock}\n    />\n  } else {\n    return null\n  }\n}\n\nexport default Editor\n"],"sourceRoot":""}