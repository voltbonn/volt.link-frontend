{"version":3,"sources":["hooks/useSaveBlock.js","components/edit/AddMenu.js","hooks/useArchiveBlock.js","components/SubMenu.js","components/edit/BlockMenu.js","pages/Editor.module.css","components/apps/PageEditor.module.css","components/edit/SharingEditor.module.css","components/edit/HtmlInput.module.css","components/edit/TranslationEditor.module.css","components/edit/InputWithLocal.module.css","components/Repeater.module.css","components/edit/FancyInput.module.css","components/edit/PermissionsEditor.module.css","components/edit/PropertiesEditor.module.css","components/edit/CoverphotoPicker.module.css","components/edit/IconPicker.module.css","components/edit/InlineEditorBlock.module.css","components/edit/ContentEditor.module.css","components/edit/HtmlInput.js","components/edit/SharingEditor.js","components/edit/InputWithLocal.js","components/Repeater.js","components/edit/TranslationEditor.js","components/edit/FancyInput.js","components/edit/EmailInput.js","components/edit/PermissionsEditor.js","components/edit/CheckboxInput.js","components/MultiButton.js","components/edit/UrlInput.js","images/coverphotos/thumbs/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.png","images/coverphotos/thumbs/Aktion.png","images/coverphotos/thumbs/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.png","images/coverphotos/thumbs/Welcome-to-Volt.png","images/coverphotos/thumbs/portugal.jpg","components/edit/CoverphotoPicker.js","components/edit/IconPicker.js","components/edit/PathInput.js","hooks/useCheckPath.js","components/edit/TriggerInput.js","components/edit/ActionInput.js","components/edit/PropertiesEditor.js","components/edit/InlineEditorBlockText.js","components/edit/InlineEditorBlockButton.js","components/edit/InlineEditorBlockRedirect.js","components/edit/InlineEditorBlockDivider.js","components/edit/InlineEditorBlockCheckbox.js","components/edit/InlineEditorBlockPerson.js","components/edit/InlineEditorBlockPage.js","components/edit/InlineEditorBlock.js","components/edit/ContentEditor.js","components/apps/PageEditor.js","pages/Editor.js"],"names":["removeProperty","obj","prop","i","JSON","parse","stringify","hasOwnProperty","useSaveBlock","getString","useLocalization","apollo_client","useApolloClient","useSnackbar","enqueueSnackbar","closeSnackbar","handleSaveBlock","useCallback","initialBlock","Promise","final_resolve","snackbarKey","newBlock","Array","isArray","content","map","contentConfig","blockId","loadingDataPromise","resolve","mutate","mutation","saveBlock_Mutation","variables","block","then","a","data","error","variant","preventDuplicate","autoHideDuration","_id","saveBlock","catch","console","message","race","setTimeout","response","persist","blockTypeIcons","button","text","code","divider","checkbox","page","person","redirect","default_types","AddMenuContent","createBlock","types","close","type","className","onClick","id","AddMenu","trigger","useUser","loggedIn","style","marginTop","useArchiveBlock","archive","archiveBlock_Mutation","unarchiveBlock_Mutation","SubMenu","disabled","parentMenuIsOpen","label","triggerProps","header","MenuListProps","position","onOpen","children","triggerRef","useRef","useState","isSubMenuOpen","setIsSubMenuOpen","open","toggleSubmenu","newOpen","closeSubmenu","MenuItem","ref","display","justifyContent","ArrowRight","marginRight","Menu","pointerEvents","anchorEl","current","anchorOrigin","vertical","horizontal","transformOrigin","autoFocus","disableAutoFocus","disableEnforceFocus","onClose","sx","maxWidth","maxHeight","overflow","background","color","ListSubheader","whiteSpace","lineHeight","margin","padding","backgroundColor","Divider","opacity","ListItemIcon","Close","Localized","typeIcons","defaultTypeOptions","colorOptions","default","yellow","green","red","blue","colorOptionsKeys","Object","keys","getColor","renderedColor","getBlockColor","properties","withLocalization","onToogle","setProperty","setType","typeOptions","onRemoveRow","addRowBefore","onArchivedToggle","onReloadContext","userroles","computed","active","text_style","roles","canEdit","includes","archived","setArchived","archiveBlock","mutationFunction","useMutation","navigate","useNavigate","createChildBlock","newBlockId","moveBlock_Mutation","movingBlockId","newParentId","newIndex","toggleArchiveBlock","newArchived","toggleActive","metadata","PopoverMenu","height","length","typeName","selected","marginBottom","thisColor","placeholder","defaultValue","onBlur","e","target","value","width","thisStyle","Add","VisibilityOff","Visibility","ListItemText","primary","secondary","Unarchive","Archive","component","Link","to","ListItem","paddingTop","paddingBottom","modified","replace","module","exports","getInLineRangeLength","element","whichLine","normalize","window","getSelection","selection","range","rangeCount","getRangeAt","clonedRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","cloneContents","rangeLength","childNodes","nodeType","detach","getCaretPosition","cs","getComputedStyle","paddingY","parseFloat","borderY","borderTopWidth","borderBottomWidth","elementHeight","offsetHeight","offset","getOffset","caretOffset","getCaretOffset","top","left","inFirstLine","inLastLine","caretPositionFromStart","node","textContent","nodeName","getRangeLengthWithLinebreaks","textLength","innerText","caretPositionFromEnd","positionFromLineStart","positionFromStart","positionFromEnd","HtmlInput","onChange","linebreaks","onError","onInputRef","onGoToPrevInput","onGoToNextInput","onSplitText","onMergeToPrevInput","onMergeFromNextInput","inputRef","textRef","textRefValue","__html","fakeDefaultValue","setFakeDefaultValue","updateText","newHtmlValue","html","temporalDivElement","document","createElement","innerHTML","stripHtml","useEffect","handleTextChange","event","trim","handleTextBlur","keyDownHandler","key","shiftKey","execCommand","preventDefault","caret","start","slice","end","texts","handlePaste","originalEvent","clipboardData","getData","onKeyDown","onInput","onPaste","classes","rebuild_textarea","show_placeholder","contentEditable","dangerouslySetInnerHTML","copyTextToClipboard","navigator","clipboard","writeText","info","err","textArea","body","appendChild","focus","select","msg","removeChild","fallbackCopyTextToClipboard","SharingEditor","defaultBlock","path","setPath","initialPath","savePath","newPath","newProperties","action","Modal","hideBackdrop","backdrop","dialog","inputWrapper","paddingRight","linebreak","input","actions","href","rel","click","marginInlineStart","alert","marginInlineEnd","InputWithLocal","reorderHandle","actionButton","locale","dataset","changedLocale","setChangedLocale","changedText","setChangedText","handleBlur","handleLocaleChange","newLocale","changes","event_or_text","input_with_local","LocaleSelect","flexGrow","Row","subDefaultValue","index","render","handleRowChange","isReorderable","handleAddRow","handleRemoveRow","showReorderControls","reorderLabel","showActionButton","hasOnlyOneRow","addRowByIndex","draggableId","tmp_id","isDragDisabled","disableInteractiveElementBlocking","shouldRespectForcePress","provided","innerRef","draggableProps","row","form","inlineRowButton","dragHandleButton","dragHandleProps","item","newValue","addRowAfter","getIndex","eventOrIndex","parseInt","isNaN","Repeater","addDefaultValue","addButtonText","hideAddButton","prependNewItems","rows","setRows","internalAddDefaultValue","tmp_defaultValue","uuidv4","new_rows","splice","rows_from_onChange","addButton","textAlign","addRowButton","onDragEnd","result","destination","source","list","startIndex","endIndex","from","removed","reorder","droppableId","isDropDisabled","droppableProps","filter","SimpleTranslationRepeater","onSaveProperty","isFirst","translations","onRepeaterChange","newTranslations","translation","onBlockLocaleChange","block2display","alignItems","gap","ViewerAuto","minHeight","repeater_props","other_repeater_props","InputWithLocal_props","TranslationEditor","blocks","setBlocks","loadBlocks","useLoadBlocks","ids2load","loadedBlocks","ids","contentBlocks","find","Boolean","loadContentBlocks","newBlocks","onSaveChildProperty","gottenBlock","blockIndex","findIndex","zIndex","flatMap","attr","FancyInput","setError","split","email_regex","emails_regex","EmailInput","multiple","props","isSubmittable","emails","match","LocalizedRole","role","RolesMenu","changeRole","removePermission","React","setAnchorEl","handleClose","currentTarget","Edit","Delete","sortPermissions","permissions","owner","p","sort","b","email","localeCompare","special","other","PermissionsEditor","defaultPermissions","user_data","user_email","user","inputRepaintKey","setInputRepaintKey","setPermissions","newEmails","setNewEmails","newRole","setNewRole","setNewPermission","newPermissions","array","obj_new","permission","unshift","blockPermissions","addPermissions","push","newEmail","addNewPermissionFromInput","oldInputRepaintKey","doesNotHaveVoltEuropa","doesNotHavePublic","menuButton","KeyboardArrowDown","permissionRow","ownerInfo","CheckboxInput","checked","setChecked","publishChanges","checkBlock","uncheckBlock","cursor","verticalAlign","CheckBox","CheckBoxOutlineBlank","MultiButton","ariaLabel","items","choosen","setChoosen","handleClick","title","icon","url_regex","is_email_not_url_regex","UrlInput","setText","schema_parts","schema","shift","after_schema","join","coverphotoValue","iconValue","onUrlChange","newUrl","url","isAbsoluteUrlRegexp","RegExp","coverphotoValueUrl","coverphotoIsSet","iconIsSet","test","root","coverphotoIsNotSet","iconIsNotSet","Popover","coverphoto","backgroundImage","domains","backend","encodeURIComponent","button_wrapper","changeCoverphotoButton","closePopover","popoverProps","Paper","elevation","marginLeft","volt_bonn_thumb","welcome_to_volt_thumb","plakatschlange_thumb","portugal_thumb","aktion_thumb","alt","src","iconValueUrl","iconWrapper","no_image","imageFormat","changeIconButton","PathInput","onSubmit","allowExisting","mountedRef","checkPath","handleCheckPath","query","checkPath_Query","useCheckPath","newText","toLowerCase","isOkay","errors","TriggerInput","setProperties","updateProperty","propertyKey","newPropertyValue","propertyTypes","cron","morePropsInput","minWidth","flexDirection","flexWrap","ActionInput","defaultProperties","silent","imprint","privacy_policy","tags","pronouns","publishProperties","propertiesFrameContent","properties_row","main_headline","paddingLeft","propertiesFrame","InlineEditorBlockText","onSaveBlock","onAddRowAfter","publishTextChange","text_style_class","colorStyles","InlineEditorBlockButton","link","setLink","colorRGB","contrastingColor","InlineEditorBlockRedirect","triggerPathRef","triggerPath","setTriggerPath","linkRef","fontWeight","paddingInlineStart","flexShrink","InlineEditorBlockDivider","styles","InlineEditorBlockCheckbox","saveChecked","InlineEditorBlockPerson","InlineEditorBlockPage","InlineEditorBlockInbetweenComponent","InlineEditorBlock","fluentByObject","onRemoveSelf","setBlock","saveBlockCallback","changeType","saveProperty","propertyName","handleBlockChange","callback","onArchiveToggle","newArchivedValue","BlockMenu","block_input","form_active","form_deactivated","addTmpIds","getFirstLineStartNode","getLastLineStartNode","reverse","lastLineNode","childNode","thisChildNodes","moveCursorToOffsetInLine","contentEditableElement","lastLineStartNode","lastLineStartNodeLength","createRange","setStart","collapse","sel","removeAllRanges","addRange","ContentEditor","parentId","contentConfigs_Ref","contentConfigs","inputRefs_Ref","inputRefs","updateCounter","setUpdateCounter","setAutoFocus","firstLineStartNode","newContentConfigs","old","loadMissingBlocks","saveInputRef","newInputRefs","goToPrevInput","prevInputRef","thisIndex","goToNextInput","nextInputRef","focusLastLine","lastInputRef","newContentConfig","oldContentConfig","loadedBlock","createBlockByType","parent","clonedContentConfigs","prev_index","prev_contentConfig","prev_tmp_id","this_block","prev_block","prev_text","this_text","new_prev_block","savedPrevBlock","new_tmp_id","next_index","this_old_contentConfig","next_block","next_text","new_block","savedBlock","splitText","firstBlock","secondBlock","savedFirstBlock","savedSecondBlock","nextContentConfig","handleRemoveSelf","filteredContentConfigs","boxShadow","Tooltip","PageEditor","isSharingEditorOpen","setIsSharingEditorOpen","openSharingEditor","closeSharingEditor","isTranslationEditorOpen","setIsTranslationEditorOpen","openTranslationEditor","closeTranslationEditor","isPermissionsEditorOpen","setIsPermissionsEditorOpen","openPermissionsEditor","closePermissionsEditor","saveType","newType","saveProperties","saveContent","newContent","savePermissions","manuallySaveEverything","PermissionsIcon","mdiLockAlert","inherited_block_permissions","inherited_block_permissions_obj","reduce","acc","curr","mdiEarth","mdiAccountLockOpen","rightHeaderActions","mdiTranslate","helmet_title","editor","Helmet","name","property","Header","rightActions","Editor","loadBlock","useLoadBlock","loadedTheBlock","useParams","setBlockInternal","setCanEdit","blockMatchesRoles","useBlockMatchesRoles","matchesRoles","app","spine_aligned","dir","contentWrapper","errorName"],"mappings":"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","file":"static/js/4.0896954c.chunk.js","sourcesContent":["import { useCallback } from 'react'\n\nimport { useLocalization } from '../fluent/Localized.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { saveBlock_Mutation } from '../graphql/mutations.js'\n\nimport { useSnackbar } from 'notistack'\n\nfunction removeProperty(obj, prop) {\n  // remove property from objects, arrays and sub-objects\n\n  obj = JSON.parse(JSON.stringify(obj)) // clone object to make everything mutable\n\n  if (obj.hasOwnProperty(prop)) {\n    delete obj[prop]\n  }\n  for (const i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (typeof obj[i] == 'object' && obj[i] !== null) {\n        removeProperty(obj[i], prop)\n      }\n    }\n  }\n\n  return obj\n}\n\nfunction useSaveBlock() {\n  const { getString } = useLocalization()\n\n  const apollo_client = useApolloClient()\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar()\n\n  const handleSaveBlock = useCallback((initialBlock) => {\n    return new Promise(final_resolve => {\n      let snackbarKey = null\n\n      let newBlock = {...initialBlock}\n      newBlock = removeProperty(newBlock, '__typename')\n      if (newBlock.hasOwnProperty('content') && Array.isArray(newBlock.content)) {\n        newBlock.content = newBlock.content.map(contentConfig => ({\n          blockId: contentConfig.blockId,\n        }))\n      }\n\n      const loadingDataPromise = new Promise(resolve => {\n        apollo_client.mutate({\n          mutation: saveBlock_Mutation,\n          variables: {\n            block: newBlock\n          },\n        })\n          .then(async ({ data }) => {\n            resolve('got-data')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            if (typeof data.error === 'string') {\n              if (data.error === 'no_edit_permission') {\n                enqueueSnackbar(getString('path_editor_edit_permission_error'), {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 2000,\n                })\n              } else {\n                enqueueSnackbar('' + data.error, {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 2000,\n                })\n              }\n            } else {\n              final_resolve({\n                ...initialBlock,\n                _id: data.saveBlock,\n              })\n\n              enqueueSnackbar(getString('path_editor_status_saved'), {\n                variant: 'success',\n                preventDuplicate: false,\n                autoHideDuration: 2000,\n              })\n            }\n          })\n          .catch(async error => {\n            console.error(error)\n            resolve('got-error')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            enqueueSnackbar(getString('path_editor_status_error_while_saving', {\n              error: error.message,\n            }), {\n              variant: 'error',\n              preventDuplicate: true,\n              autoHideDuration: 2000,\n            })\n          })\n      })\n\n      // Show a loading-info-snackbar if loading the data takes too long.\n      Promise.race([\n        new Promise(resolve => {\n          setTimeout(() => {\n            resolve('show-loading')\n          }, 300)\n        }),\n        loadingDataPromise,\n      ])\n        .then(response => {\n          if (response === 'show-loading') {\n            snackbarKey = enqueueSnackbar(getString('path_editor_status_started_saving'), {\n              persist: true,\n              preventDuplicate: true,\n            })\n          }\n        })\n        .catch(error => console.error)\n\n    })\n  }, [\n    enqueueSnackbar,\n    closeSnackbar,\n    apollo_client,\n    getString,\n  ])\n\n  return handleSaveBlock\n}\n\nexport default useSaveBlock\n","\nimport {\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n} from '@mui/material'\n\nimport {\n  InsertDriveFileSharp as PageIcon,\n  LinkSharp as RedirectIcon,\n  PersonSharp as PersonIcon,\n  Crop75Sharp as ButtonIcon,\n  NotesSharp as TextIcon,\n  Remove as DividerIcon,\n  CodeSharp as CodeIcon,\n  CheckBox as CheckboxIcon,\n  // EditSharp as EditIcon,\n} from '@mui/icons-material'\n\nimport useUser from '../../hooks/useUser.js'\nimport PopoverMenu from '../PopoverMenu.js'\nimport { Localized } from '../../fluent/Localized.js'\n\nconst blockTypeIcons = {\n  button: <ButtonIcon />,\n  text: <TextIcon />,\n  code: <CodeIcon />,\n  divider: <DividerIcon />,\n  checkbox: <CheckboxIcon />,\n  page: <PageIcon />,\n  person: <PersonIcon />,\n  redirect: <RedirectIcon />,\n}\n\nconst default_types = [\n  'page',\n  'redirect',\n]\n\nfunction AddMenuContent({ createBlock, types, close = null }) {\n  if (!types || !Array.isArray(types)) {\n    types = default_types\n  }\n\n  return <>\n    {\n      types\n        .map(type => (\n          <MenuItem className=\"roundMenuItem\" key={type} onClick={() => createBlock({ type, close })}>\n            <ListItemIcon>\n              {blockTypeIcons[type]}\n            </ListItemIcon>\n            <ListItemText>\n              <Localized id={'block_menu_type_label_'+type} />\n            </ListItemText>\n          </MenuItem>\n        ))\n    }\n  </>\n}\n\nfunction AddMenu ({ trigger, createBlock, types }) {\n  const { loggedIn } = useUser()\n\n  if (loggedIn) {\n    return <PopoverMenu trigger={trigger}>\n      {\n        ({ close }) => <>\n          <div style={{ marginTop: '8px' }}></div>\n          <AddMenuContent createBlock={createBlock} types={types} close={close} />\n        </>\n      }\n    </PopoverMenu>\n  }\n\n  return null\n}\n\nexport {\n  AddMenuContent,\n  AddMenu as default,\n}\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { archiveBlock_Mutation, unarchiveBlock_Mutation } from '../graphql/mutations.js'\n\nfunction useArchiveBlock() {\n  const apollo_client = useApolloClient()\n\n  const handleArchiveBlock = useCallback(({ _id, archive }) => {\n    return apollo_client.mutate({\n      mutation: archive ? archiveBlock_Mutation : unarchiveBlock_Mutation,\n      variables: { _id }\n    })\n  }, [ apollo_client ])\n\n  return handleArchiveBlock\n}\n\nexport default useArchiveBlock\n","import { useRef, useState, useCallback } from 'react'\n\nimport {\n  Divider,\n  Menu,\n  MenuItem,\n  ListItemIcon,\n  ListSubheader,\n} from '@mui/material'\n\nimport {\n  Close as CloseIcon,\n  ArrowRight as ArrowRightIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../fluent/Localized.js'\n\n// INFO: Some code is copied from: https://github.com/azmenak/material-ui-nested-menu-item/blob/master/src/index.tsx\n\nexport default function SubMenu ({\n  disabled = false,\n  parentMenuIsOpen = true,\n  label = '',\n  triggerProps = {},\n  header = null,\n  MenuListProps = {},\n  position = 'right',\n  onOpen = () => {},\n  children,\n}) {\n  const triggerRef = useRef(null)\n  const [isSubMenuOpen, setIsSubMenuOpen] = useState(false)\n  const open = isSubMenuOpen && parentMenuIsOpen\n\n  const toggleSubmenu = useCallback(() => {\n    if (disabled !== true) {\n      const newOpen = !open\n      setIsSubMenuOpen(newOpen)\n      if (newOpen === true) {\n        onOpen()\n      }\n    }\n  }, [ setIsSubMenuOpen, open, onOpen, disabled ])\n\n  const closeSubmenu = useCallback(() => {\n    setIsSubMenuOpen(false)\n  }, [ setIsSubMenuOpen ])\n\n  return <>\n    <MenuItem\n      {...triggerProps}\n\n      disabled={disabled}\n\n      ref={triggerRef}\n      onClick={toggleSubmenu}\n      className=\"roundMenuItem\"\n      style={{\n        display: 'flex',\n        justifyContent: 'space-between',\n        ...triggerProps.style,\n      }}\n    >\n      <div style={{ display: 'flex' }}>\n        {label}\n      </div>\n      <ArrowRightIcon style={{ marginRight: '-10px' }} />\n    </MenuItem>\n    <Menu\n      // Set pointer events to 'none' to prevent the invisible Popover div from capturing events for clicks and hovers\n      style={{ pointerEvents: 'none' }}\n      anchorEl={triggerRef.current}\n      anchorOrigin={{\n        vertical: 'top',\n        horizontal: (position === 'right' ? 'right' : 'left'),\n      }}\n      transformOrigin={{\n        vertical: 'top',\n        horizontal: (position === 'right' ? 'left' : 'right'),\n      }}\n      open={open}\n      autoFocus={false}\n      disableAutoFocus\n      disableEnforceFocus\n      onClose={closeSubmenu}\n      sx={{\n        marginTop: '-8px', // align with parent menu\n      }}\n      MenuListProps={{\n        ...MenuListProps,\n        sx: {\n          maxWidth: 380,\n          maxHeight: 'calc(100vh - 32px)',\n          overflow: 'auto',\n          background: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n          ...MenuListProps.sx,\n        },\n      }}\n    >\n      <div style={{pointerEvents: 'auto'}}>\n        {\n          header !== null\n            ? <ListSubheader\n                style={{\n                  whiteSpace: 'nowrap',\n                  lineHeight: '1',\n                  margin: '0',\n                  padding: '4px 16px 12px',\n                  backgroundColor: 'var(--background-contrast)',\n                  color: 'var(--on-background)',\n                }}\n              >\n                {header}\n              </ListSubheader>\n            : null\n        }\n\n        {children}\n\n        <Divider style={{opacity: 0.2}} />\n\n        <MenuItem className=\"roundMenuItem\" style={{marginTop:'8px'}} onClick={closeSubmenu}>\n          <ListItemIcon>\n            <CloseIcon />\n          </ListItemIcon>\n          <Localized id=\"block_menu_close_menu\" />\n        </MenuItem>\n      </div>\n    </Menu>\n  </>\n}\n","import { useCallback, useState } from 'react'\n\nimport {\n  Link,\n  useNavigate,\n} from 'react-router-dom'\n\nimport {\n  MenuItem,\n  Divider,\n  ListItemIcon,\n  ListItemText,\n  ListItem,\n} from '@mui/material'\n\nimport {\n  Archive as ArchiveIcon,\n  Unarchive as UnarchiveIcon,\n\n  Visibility as VisibilityIcon,\n  VisibilityOff as VisibilityOffIcon,\n  // Delete as DeleteIcon,\n  // VerticalAlignTop as VerticalAlignTopIcon,\n  // VerticalAlignBottom as VerticalAlignBottomIcon,\n  Add as AddIcon,\n  RepeatSharp as RepeatIcon,\n  // RemoveCircleSharp as RemoveCircleIcon,\n\n  InsertDriveFileSharp as PageIcon,\n  LinkSharp as RedirectIcon,\n  // PersonSharp as PersonIcon,\n  Crop75Sharp as ButtonIcon,\n  NotesSharp as TextIcon,\n  // CodeSharp as CodeIcon,\n  Remove as DividerIcon,\n  // CheckBox as CheckboxIcon,\n\n  PreviewSharp as ViewIcon,\n  EditSharp as EditIcon,\n\n  FormatSizeSharp as TextStyleIcon,\n  PaletteSharp as ColorIcon,\n  CircleSharp as ColorSwatchIcon,\n} from '@mui/icons-material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport useArchiveBlock from '../../hooks/useArchiveBlock.js'\nimport useUser from '../../hooks/useUser.js'\n\nimport PopoverMenu from '../PopoverMenu.js'\nimport SubMenu from '../SubMenu.js'\nimport { AddMenuContent } from './AddMenu.js'\n\nimport { saveBlock_Mutation, moveBlock_Mutation } from '../../graphql/mutations.js'\nimport useMutation from '../../hooks/useMutation.js'\n\nconst typeIcons = {\n  button: <ButtonIcon />,\n  text: <TextIcon />,\n  // checkbox: <CheckboxIcon />,\n  // code: <CodeIcon />,\n  divider: <DividerIcon />,\n  page: <PageIcon />,\n  redirect: <RedirectIcon />,\n}\n\nconst defaultTypeOptions = [\n  'button',\n  'text',\n  // 'checkbox',\n  // 'code',\n  'divider',\n  'page',\n  'redirect',\n]\n\nconst colorOptions = {\n  default: 'var(--on-background)',\n  yellow: 'var(--yellow)',\n  green: 'var(--green)',\n  red: 'var(--red)',\n  blue: 'var(--blue)',\n}\nconst colorOptionsKeys = Object.keys(colorOptions)\nfunction getColor (color) {\n  if (colorOptions.hasOwnProperty(color)) {\n    return colorOptions[color]\n  } else {\n    const {\n      color: renderedColor\n    } = getBlockColor({\n      properties: {\n        color,\n      },\n    })\n\n    if (renderedColor) {\n      return renderedColor\n    }\n  }\n  \n  return color\n}\n\nfunction BlockMenu ({\n  block = {},\n  getString,\n\n  trigger,\n  onToogle,\n\n  setProperty,\n  setType,\n  typeOptions = defaultTypeOptions,\n\n  onRemoveRow = null,\n  addRowBefore = null,\n  // addRowAfter = null,\n  onArchivedToggle = null,\n  onReloadContext = null,\n}) {\n  const { loggedIn, userroles } = useUser()\n\n  const { _id = '', type = '', properties = {}, computed = {} } = block\n  const {\n    active = true,\n    text_style = null,\n    color = null,\n  } = properties\n  const {\n    roles = [],\n  } = (computed === null ? {} : computed)\n  const canEdit = loggedIn && (userroles.includes('admin') || roles.includes('owner') || roles.includes('editor'))\n\n  const [archived, setArchived] = useState(properties.archived === true)\n  const archiveBlock = useArchiveBlock()\n\n  // const handleAddRowBefore = useCallback(() => {\n  //\n  //   // const newBlock = {\n  //   //   type,\n  //   // }\n  //\n  //   const newBlockId = ''\n  //\n  //   addRowBefore({\n  //     blockId: newBlockId,\n  //   })\n  // }, [ addRowBefore ])\n\n\n  const mutationFunction = useMutation()\n  const navigate = useNavigate()\n  const createChildBlock = useCallback(async newBlock => {\n    try {\n      if (newBlock) {\n        const { saveBlock: newBlockId } = await mutationFunction({\n          mutation: saveBlock_Mutation,\n          variables: {\n            block: newBlock,\n          },\n        })\n        if (newBlockId !== null) {\n          await mutationFunction({\n            mutation: moveBlock_Mutation,\n            variables: {\n              movingBlockId: newBlockId,\n              newParentId: _id,\n              newIndex: 0,\n            },\n          })\n          if (typeof onReloadContext === 'function') {\n            onReloadContext()\n          }\n          navigate(`/${newBlockId}/edit`)\n        }\n      }\n    } catch (error) {\n      console.error(error)\n    }\n  }, [ mutationFunction, _id, onReloadContext, navigate ])\n\n  const toggleArchiveBlock = useCallback(() => {\n    const newArchived = !archived\n    archiveBlock({ _id: block._id, archive: newArchived })\n      .then(() => {\n        setArchived(newArchived)\n        if (typeof onArchivedToggle === 'function') {\n          onArchivedToggle(newArchived)\n        }\n        if (typeof onReloadContext === 'function') {\n          onReloadContext()\n        }\n      })\n      .catch(console.error)\n  }, [archiveBlock, setArchived, archived, block, onArchivedToggle, onReloadContext])\n\n  const toggleActive = useCallback(() => {\n    if (typeof setProperty === 'function') {\n      setProperty('active', !active)\n    }\n  }, [ active, setProperty ])\n\n  const metadata = block.metadata || {}\n\n  let {\n    color: renderedColor\n  } = getBlockColor(block)\n\n  if (!renderedColor) {\n    renderedColor = 'transparent'\n  }\n\n  return <PopoverMenu\n    trigger={trigger}\n    onToogle={onToogle}\n  >\n    {({ open }) => (<div>\n\n      <div style={{ height: '8px' }}></div>\n\n      {\n        (\n          canEdit\n          && typeof setType === 'function'\n          && Array.isArray(typeOptions)\n          && typeOptions.length > 0\n        )\n        && <>\n          <SubMenu\n            disabled={type === 'person'}\n            parentMenuIsOpen={open}\n            label={<>\n              <ListItemIcon>\n                <RepeatIcon />\n              </ListItemIcon>\n              <Localized id=\"block_menu_choose_type_label\" />\n            </>}\n            header={<Localized id=\"block_menu_choose_type_label\" />}\n          >\n            {\n              typeOptions\n              .map(typeName => (\n                <MenuItem\n                  key={typeName}\n                  selected={typeName === type}\n                  onClick={() => setType(typeName)}\n                  className=\"roundMenuItem\"\n                >\n                  <ListItemIcon>\n                    {typeIcons[typeName]}\n                  </ListItemIcon>\n                  {getString(`block_menu_type_label_${typeName}`, typeName)}\n                </MenuItem>\n              ))\n            }\n          </SubMenu>\n          <Divider style={{ opacity: 0.2, marginTop: '8px', marginBottom: '8px' }} />\n        </>\n      }\n\n      {\n        (\n          canEdit\n          && typeof setProperty === 'function'\n        )\n        && <SubMenu\n          parentMenuIsOpen={open}\n          label={<>\n            <ListItemIcon>\n              <ColorIcon\n                style={{\n                  color: getColor(color),\n                }}\n              />\n            </ListItemIcon>\n            <Localized id=\"block_menu_choose_color_label\" />\n          </>}\n          header={<Localized id=\"block_menu_choose_color_label\" />}\n        >\n          {\n            colorOptionsKeys\n            .map(thisColor => (\n              <MenuItem\n                key={thisColor}\n                selected={thisColor === 'default' ? color === null : color === thisColor}\n                onClick={() => setProperty('color', thisColor === 'default' ? null : thisColor)}\n                className=\"roundMenuItem\"\n              >\n                <ListItemIcon>\n                  <ColorSwatchIcon\n                    style={{\n                      color: getColor(thisColor),\n                    }}\n                  />\n                </ListItemIcon>\n                {thisColor}\n              </MenuItem>\n            ))\n          }\n\n          <MenuItem\n            className=\"roundMenuItem\"\n            selected={color !== null && !colorOptionsKeys.includes(color)}\n          >\n            <ListItemIcon>\n              <ColorSwatchIcon\n                style={{\n                  color: renderedColor,\n                }}\n              />\n            </ListItemIcon>\n            <input\n              key={colorOptionsKeys.includes(color) ? color : 'custom'}\n              type=\"text\"\n              placeholder=\"#FFFFFF\"\n              defaultValue={color}\n              onBlur={e => setProperty('color', e.target.value)}\n              style={{\n                width: '160px',\n                margin: '0 calc(-1 * var(--basis)) 0 0',\n              }}\n            />\n          </MenuItem>\n        </SubMenu>\n      }\n\n      {\n        (\n          canEdit\n          && typeof setProperty === 'function'\n          && type === 'text'\n        )\n        && <SubMenu\n          parentMenuIsOpen={open}\n          label={<>\n            <ListItemIcon>\n              <TextStyleIcon />\n            </ListItemIcon>\n            <Localized id=\"block_menu_choose_text_style_label\" />\n          </>}\n          header={<Localized id=\"block_menu_choose_text_style_label\" />}\n        >\n          {\n            [\n              // 'h1', // title\n              'h2', // heading\n              'h3', // subheading\n              'body', // body text. This is saved as null.\n              // 'caption',\n            ]\n            .map(thisStyle => (\n              <MenuItem\n                key={thisStyle}\n                selected={thisStyle === 'body' ? text_style === null : text_style === thisStyle}\n                onClick={() => setProperty('text_style', thisStyle === 'body' ? null : thisStyle)}\n                className=\"roundMenuItem\"\n              >\n                {getString(`block_menu_text_style_label_${thisStyle}`, thisStyle)}\n              </MenuItem>\n            ))\n          }\n        </SubMenu>\n      }\n\n      {\n        (\n          canEdit\n          && typeof setProperty === 'function'\n        )\n        && <Divider style={{opacity: 0.2, marginTop:'8px', marginBottom:'8px'}} />\n      }\n\n      {/*\n        addRowBefore\n        && <MenuItem onClick={handleAddRowBefore}>\n          <ListItemIcon>\n            <VerticalAlignTopIcon />\n          </ListItemIcon>\n          <Localized id=\"block_menu_add_before\" />\n        </MenuItem>\n      */}\n\n      {/*\n        addRowAfter\n        && <MenuItem onClick={addRowAfter}>\n          <ListItemIcon>\n            <VerticalAlignBottomIcon />\n          </ListItemIcon>\n          <Localized id=\"block_menu_add_after\" />\n        </MenuItem>\n      */}\n\n      {\n        canEdit\n        && <SubMenu\n          parentMenuIsOpen={open}\n          label={<>\n            <ListItemIcon>\n              <AddIcon />\n            </ListItemIcon>\n            <Localized id=\"block_menu_create_child_block\" />\n          </>}\n        >\n          <AddMenuContent createBlock={createChildBlock} />\n        </SubMenu>\n      }\n\n      {\n        (\n          canEdit\n          && typeof setProperty === 'function'\n        )\n        && <MenuItem className=\"roundMenuItem\" onClick={toggleActive}>\n          <ListItemIcon>\n            {\n              active\n              ? <VisibilityOffIcon />\n              : <VisibilityIcon />\n            }\n          </ListItemIcon>\n\n          <ListItemText\n            primary={<span>{\n              active\n              ? <Localized id=\"block_menu_hide\" />\n              : <Localized id=\"block_menu_show\" />\n            }</span>}\n            secondary={<span style={{ whiteSpace: 'normal' }}><Localized id=\"block_menu_hide_show_description\" /></span>}\n          />\n          \n        </MenuItem>\n      }\n\n      {\n        (\n          canEdit\n          && typeof onArchivedToggle === 'function'\n        )\n        && <MenuItem className=\"roundMenuItem\" onClick={toggleArchiveBlock}>\n          <ListItemIcon>\n            {\n              archived === true\n              ? <UnarchiveIcon />\n              : <ArchiveIcon />\n            }\n          </ListItemIcon>\n          {\n            archived === true\n            ? <Localized id=\"block_menu_unarchive\" />\n            : <Localized id=\"block_menu_archive\" />\n          }\n        </MenuItem>\n      }\n            \n      {\n        canEdit\n        && <Divider style={{ opacity: 0.2, marginTop: '8px', marginBottom: '8px' }} />\n      }\n\n      {\n        (typeof _id === 'string' && _id !== '')\n        && <>\n          <MenuItem component={Link} to={`/${_id}/view`} className=\"roundMenuItem\" style={{ marginTop: '8px' }}>\n            <ListItemIcon>\n              <EditIcon />\n            </ListItemIcon>\n            <Localized id=\"view_block\" />\n          </MenuItem>\n\n          {\n            canEdit\n            && <MenuItem component={Link} to={`/${_id}/edit`} className=\"roundMenuItem\">\n              <ListItemIcon>\n                <ViewIcon />\n              </ListItemIcon>\n              <Localized id=\"edit_block\" />\n            </MenuItem>\n          }\n\n          <Divider style={{opacity: 0.2, marginTop:'8px', marginBottom:'8px' }} />\n        </>\n      }\n\n      {/*\n      <ListItem sx={{ paddingTop: '0', paddingBottom: '0' }}>\n        <ListItemText\n          primary={<Localized id=\"block_menu_info_created\" />}\n          secondary={(metadata.created || '').replace(/[TZ]/g, ' ')}\n        />\n      </ListItem>\n      */}\n      <ListItem sx={{ paddingTop: '0', paddingBottom: '0' }}>\n        <ListItemText\n          primary={<span><Localized id=\"block_menu_info_modified\" /></span>}\n          secondary={<span>{(metadata.modified || '').replace(/[TZ]/g, ' ')}</span>}\n        />\n      </ListItem>\n      <ListItem sx={{ paddingTop: '0', paddingBottom: '0' }}>\n        <ListItemText\n          primary={<span><Localized id=\"block_menu_info_id\" /></span>}\n          secondary={<span>{_id}</span>}\n        />\n      </ListItem>\n\n    </div>)}\n  </PopoverMenu>\n}\n\nexport default withLocalization(BlockMenu)\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"Editor_app__3WzMm\",\"spine_aligned\":\"Editor_spine_aligned__1h8Ra\",\"contentWrapper\":\"Editor_contentWrapper__1cY6-\",\"editor\":\"Editor_editor__2hX0g\",\"loadingContent\":\"Editor_loadingContent__2fqdK\",\"editor_form_row\":\"Editor_editor_form_row__17Pul\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"PageEditor_app__26Zo3\",\"spine_aligned\":\"PageEditor_spine_aligned__2i6Wu\",\"contentWrapper\":\"PageEditor_contentWrapper__WlUIr\",\"editor\":\"PageEditor_editor__U1pPN\",\"type_redirect\":\"PageEditor_type_redirect__2KPht\",\"loadingContent\":\"PageEditor_loadingContent__1YK7g\",\"editor_form_row\":\"PageEditor_editor_form_row__j4vjp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog\":\"SharingEditor_dialog__22jfY\",\"backdrop\":\"SharingEditor_backdrop__1Gra9\",\"inputWrapper\":\"SharingEditor_inputWrapper__1UyBD\",\"input\":\"SharingEditor_input__brkXK\",\"actions\":\"SharingEditor_actions__2zz6x\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"rebuild_textarea\":\"HtmlInput_rebuild_textarea__ZfRzZ\",\"show_placeholder\":\"HtmlInput_show_placeholder__hM8g2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog\":\"TranslationEditor_dialog__YL0sv\",\"backdrop\":\"TranslationEditor_backdrop__hfIzh\",\"inputWrapper\":\"TranslationEditor_inputWrapper__3aVMH\",\"input\":\"TranslationEditor_input__3U2bK\",\"actions\":\"TranslationEditor_actions__3dTaz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input_with_local\":\"InputWithLocal_input_with_local__3qqYa\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"Repeater_row__1ODoF\",\"middleActions\":\"Repeater_middleActions__3nRoT\",\"trigger\":\"Repeater_trigger__1VtG5\",\"content\":\"Repeater_content__110R9\",\"form\":\"Repeater_form__2N6kw\",\"item\":\"Repeater_item__2OI78\",\"inlineRowButton\":\"Repeater_inlineRowButton__uqk8Y\",\"dragHandleButton\":\"Repeater_dragHandleButton__2eLww\",\"addRowButton\":\"Repeater_addRowButton__3huSP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"error\":\"FancyInput_error__2DFWE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog\":\"PermissionsEditor_dialog__2rpyk\",\"backdrop\":\"PermissionsEditor_backdrop__1dRPN\",\"inputWrapper\":\"PermissionsEditor_inputWrapper__4DGsr\",\"input\":\"PermissionsEditor_input__1HyOC\",\"actions\":\"PermissionsEditor_actions__k4oBn\",\"permissionRow\":\"PermissionsEditor_permissionRow__2HaWO\",\"menuButton\":\"PermissionsEditor_menuButton__2jIMI\",\"ownerInfo\":\"PermissionsEditor_ownerInfo__EEKXP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main_headline\":\"PropertiesEditor_main_headline__3wy7R\",\"propertiesFrame\":\"PropertiesEditor_propertiesFrame__1uBEz\",\"properties_row\":\"PropertiesEditor_properties_row__2tX7M\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"coverphoto\":\"CoverphotoPicker_coverphoto__1mWB4\",\"root\":\"CoverphotoPicker_root__3T8t9\",\"coverphotoIsNotSet\":\"CoverphotoPicker_coverphotoIsNotSet__1O3-S\",\"button_wrapper\":\"CoverphotoPicker_button_wrapper__2oEjh\",\"coverphotoIsSet\":\"CoverphotoPicker_coverphotoIsSet__2o24A\",\"iconIsSet\":\"CoverphotoPicker_iconIsSet__D_4uA\",\"changeCoverphotoButton\":\"CoverphotoPicker_changeCoverphotoButton__2GnZD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"IconPicker_root__2okyv\",\"iconIsSet\":\"IconPicker_iconIsSet__SnQwA\",\"coverphotoIsSet\":\"IconPicker_coverphotoIsSet__3m9Dw\",\"icon\":\"IconPicker_icon__JWgfX\",\"iconWrapper\":\"IconPicker_iconWrapper__1zo6g\",\"sizing_pixel\":\"IconPicker_sizing_pixel__3TeE0\",\"iconIsNotSet\":\"IconPicker_iconIsNotSet__1T0Zd\",\"changeIconButton\":\"IconPicker_changeIconButton__TxsdG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"InlineEditorBlock_block__14-zd\",\"block_input\":\"InlineEditorBlock_block_input__2I1iu\",\"form_deactivated\":\"InlineEditorBlock_form_deactivated__2oktp\",\"form_active\":\"InlineEditorBlock_form_active__hi5HC\",\"reorderHandle\":\"InlineEditorBlock_reorderHandle__2_s23\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"ContentEditor_row__JonRI\",\"form\":\"ContentEditor_form__wtoB9\",\"item\":\"ContentEditor_item__3U0XE\",\"inlineRowButton\":\"ContentEditor_inlineRowButton__2pw6r\",\"dragHandleButton\":\"ContentEditor_dragHandleButton__1Y_RP\"};","import React, { useCallback, useRef, useState, useEffect } from 'react'\n\n// import hljs from 'highlight.js/lib/core'\n// import javascript from 'highlight.js/lib/languages/javascript'\n// // import 'highlight.js/styles/github.css'\n// import '../../highlightjs-volt-theme.css'\n\nimport {\n  offset as getCaretOffset,\n  getOffset,\n} from 'caret-pos'\n\nimport classes from './HtmlInput.module.css'\n\n// hljs.registerLanguage('javascript', javascript)\n\nfunction stripHtml(html){\n  // source: https://ourcodeworld.com/articles/read/376/how-to-strip-html-from-a-string-extract-only-text-content-in-javascript\n  // Create a new div element\n  var temporalDivElement = document.createElement(\"div\");\n  // Set the HTML content with the providen\n  temporalDivElement.innerHTML = html;\n  // Retrieve the text property of the element (cross-browser support)\n  return temporalDivElement.textContent || temporalDivElement.innerText || \"\";\n}\n\nfunction getRangeLengthWithLinebreaks(element){\n  element.normalize()\n\n  if (!window.getSelection) {\n    return 0;\n  }\n\n  const selection = window.getSelection()\n  const range = selection.rangeCount > 0 ? selection.getRangeAt(0) : null;\n\n  if (!range) {\n    return 0;\n  }\n\n  const clonedRange = range.cloneRange()\n  clonedRange.selectNodeContents(element)\n  clonedRange.setEnd(range.endContainer, range.endOffset)\n  const content = clonedRange.cloneContents()\n\n  let rangeLength = 0\n  for (const node of content.childNodes) {\n    if (node.nodeType === 3) { // node type = 3 is a text node\n      rangeLength += node.textContent.length\n    } else if (node.nodeType === 1 && node.nodeName === 'BR') { // node type = 1 is an element node\n      rangeLength += 1\n    }\n  }\n\n  clonedRange.detach()\n\n  return rangeLength\n}\n\nfunction getInLineRangeLength(element, whichLine){\n  element.normalize()\n\n  if (!window.getSelection) {\n    return 0;\n  }\n\n  const selection = window.getSelection()\n  const range = selection.rangeCount > 0 ? selection.getRangeAt(0) : null;\n\n  if (!range) {\n    return 0;\n  }\n\n  const clonedRange = range.cloneRange()\n  clonedRange.selectNodeContents(element)\n  clonedRange.setEnd(range.endContainer, range.endOffset)\n  const content = clonedRange.cloneContents()\n\n  let rangeLength = 0\n  if (content.childNodes.length > 0) {\n    if (whichLine === 'first') {\n      if (content.childNodes[0].nodeType === 3) {\n        rangeLength = content.childNodes[0].length\n      } else {\n        rangeLength = 0\n      }\n    } else if (whichLine === 'last') {\n      if (content.childNodes[content.childNodes.length-1].nodeType === 3) {\n        rangeLength = content.childNodes[content.childNodes.length-1].length\n      } else {\n        if (content.childNodes.length > 1) {\n          if (content.childNodes[content.childNodes.length-2].nodeType === 3) {\n            rangeLength = content.childNodes[content.childNodes.length-2].length\n          } else {\n            rangeLength = 0\n          }\n        } else {\n          rangeLength = 0\n        }\n      }\n    }\n  }\n\n  clonedRange.detach()\n\n  return rangeLength\n}\n\nfunction getCaretPosition(element){\n  // get element height without padding and border\n  const cs = getComputedStyle(element)\n  const paddingY = parseFloat(cs.paddingTop) + parseFloat(cs.paddingBottom)\n  const borderY = parseFloat(cs.borderTopWidth) + parseFloat(cs.borderBottomWidth)\n  const elementHeight = element.offsetHeight - paddingY - borderY\n\n  // get caret position\n  const offset = getOffset(element)\n  const caretOffset = getCaretOffset(element)\n  caretOffset.top = caretOffset.top - offset.top\n  caretOffset.left = caretOffset.left - offset.left\n\n  // check if caret is in the first line\n  let inFirstLine = caretOffset.top < caretOffset.height\n\n  // check if caret is in the last line\n  let inLastLine = elementHeight - caretOffset.top < caretOffset.height\n\n  // define caret position from start of text\n  const caretPositionFromStart = getRangeLengthWithLinebreaks(element)\n\n  // calc caret position from end of text\n  let textLength = element.innerText.length ||0\n  if (textLength < 0) {\n    textLength = 0\n  }\n  const caretPositionFromEnd = textLength - caretPositionFromStart\n\n  return {\n    inFirstLine,\n    inLastLine,\n    left: caretOffset.left,\n    top: caretOffset.top,\n    height: caretOffset.height,\n    positionFromLineStart: getInLineRangeLength(element, (inFirstLine ? 'first' : 'last')),\n    positionFromStart: caretPositionFromStart,\n    positionFromEnd: caretPositionFromEnd,\n  }\n}\n\nfunction HtmlInput({\n  type = 'text',\n  defaultValue = '',\n  children,\n  className,\n  onChange,\n  onBlur,\n  onError,\n  linebreaks,\n  style,\n  placeholder = '',\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  ...props\n}) {\n  const inputRef = useRef(null)\n\n  const textRef = useRef('')\n  const textRefValue = textRef.current\n  \n  const [fakeDefaultValue, setFakeDefaultValue] = useState({ __html: '' })\n\n  const updateText = useCallback(defaultValue => {\n\n    let newHtmlValue = stripHtml(defaultValue)\n\n    // if (type === 'code') {\n    //   // const html = hljs.highlightAuto(newHtmlValue, { ignoreIllegals: false })\n    //   const html = hljs.highlight(newHtmlValue, { language: 'javascript', ignoreIllegals: false })\n    //   newHtmlValue = html.value\n    // // } else {\n    // //   newHtmlValue = newHtmlValue\n    // //     // .replace(/\\t/g, '&emsp;')\n    // //     .replace(/</g, '&lt;')\n    // //     .replace(/>/g, '&gt;')\n    // //     // .replace(/\\n/g, '<br />')\n    // }\n\n    textRef.current = defaultValue\n\n    if (fakeDefaultValue.__html !== newHtmlValue) {\n      return setFakeDefaultValue({__html: newHtmlValue})\n    }\n  }, [\n    // type,\n    fakeDefaultValue,\n    setFakeDefaultValue,\n  ])\n\n  useEffect(() => {\n    if (textRefValue !== defaultValue) {\n      updateText(defaultValue)\n    }\n  }, [\n    textRefValue,\n    defaultValue,\n    updateText,\n  ])\n\n  const handleTextChange = useCallback((event) => {\n    let value = event.target.innerHTML || ''\n    // .replace(/&emsp;/g, '\\t')\n    // .replace(/&lt;/g, '<')\n    // .replace(/&gt;/g, '>')\n\n    if (linebreaks === false) {\n      value = value.replace(/<\\/? ?br ?\\/?>/g, ' ')\n    } else {\n      value = value.replace(/<\\/? ?br ?\\/?>/g, '\\n')\n    }\n\n    value = value.trim()\n    textRef.current = value\n\n    if (onChange) {\n      onChange(value)\n    }\n  }, [onChange, linebreaks])\n\n  const handleTextBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur(textRefValue)\n    }\n  }, [onBlur, textRefValue])\n\n  const keyDownHandler = useCallback(event => {\n    if (event.key === 'Enter' && event.shiftKey === true) {\n      // source: StackOverflow (https://stackoverflow.com/a/61237402)\n      if (linebreaks !== false) {\n        document.execCommand('insertLineBreak')\n      }\n      event.preventDefault()\n    } else if (event.key === 'Tab') {\n      document.execCommand('insertText', false, '\\t')\n      event.preventDefault()\n    } else if (event.key === 'ArrowUp') {\n      if (onGoToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inFirstLine) {\n          onGoToPrevInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowLeft') {\n      if (onGoToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inFirstLine && caret.positionFromStart <= 0) {\n          caret.positionFromLineStart = -1\n          onGoToPrevInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowDown') {\n      if (onGoToNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inLastLine) {\n          onGoToNextInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowRight') {\n      if (onGoToNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inLastLine && caret.positionFromEnd === 0) {\n          caret.positionFromLineStart = 0\n          onGoToNextInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Enter') {\n      if (type === 'code') {\n        if (linebreaks !== false) {\n          document.execCommand('insertLineBreak')\n        }\n        event.preventDefault()\n      } else {\n        if (onSplitText) {\n          const caret = getCaretPosition(inputRef.current)\n\n          const innerText = inputRef.current.innerText\n          const start = innerText.slice(0, caret.positionFromStart)\n          const end = innerText.slice(caret.positionFromStart)\n\n          onSplitText({\n            texts: [start, end],\n          })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Backspace') {\n      if (onMergeToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.positionFromStart === 0 && caret.inFirstLine) {\n          onMergeToPrevInput({\n            caret,\n            text: inputRef.current.innerText,\n          })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Delete') {\n      if (onMergeFromNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.positionFromEnd === 0 && caret.inLastLine) {\n          onMergeFromNextInput({\n            caret,\n            text: inputRef.current.innerText,\n          })\n          event.preventDefault()\n        }\n      }\n    }\n  }, [\n    inputRef,\n    linebreaks,\n    onGoToPrevInput,\n    onGoToNextInput,\n    onSplitText,\n    onMergeToPrevInput,\n    onMergeFromNextInput,\n    type,\n  ])\n\n  useEffect(() => {\n    if (onInputRef) {\n      onInputRef(inputRef)\n    }\n  }, [onInputRef, inputRef])\n\n  const handlePaste = useCallback(event => {\n    // only accept plain text\n\n    // cancel paste\n    event.preventDefault()\n\n    // get text representation of clipboard\n    let text = (event.originalEvent || event).clipboardData.getData('text/plain')\n\n    if (linebreaks === false) {\n      text = text.replace(/\\n/g, ' ')\n    }\n\n    // insert text manually\n    document.execCommand('insertText', false, text)\n  }, [linebreaks])\n\n  // const highlighted = hljs.highlightAuto(text, { ignoreIllegals: true })\n  // language\n  //   ? hljs.highlight(language, content)\n  //   : hljs.highlightAuto(content)\n\n  return <>\n  <div\n    ref={inputRef}\n    onKeyDown={keyDownHandler}\n    onInput={handleTextChange}\n    onBlur={handleTextBlur}\n    onPaste={handlePaste}\n    className={`${classes.rebuild_textarea} ${textRefValue.length === 0 ? classes.show_placeholder : ''} ${className}`}\n    contentEditable={true}\n    dangerouslySetInnerHTML={fakeDefaultValue}\n    style={style}\n    placeholder={placeholder}\n  />\n    {/* <pre className=\"hljs\">\n      <code dangerouslySetInnerHTML={{ __html: highlighted.value }} />\n    </pre> */}\n  </>\n}\n\nexport default HtmlInput\n","import React, { useEffect, useState, useCallback }from 'react'\n\nimport {\n  Modal,\n} from '@mui/material'\nimport {\n  QrCodeSharp as QrCodeIcon,\n  AssessmentSharp as AssessmentIcon,\n  ContentCopySharp as CopyIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../../fluent/Localized.js' // useLocalization\n\nimport classes from './SharingEditor.module.css'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction fallbackCopyTextToClipboard(text) {\n  // Source: https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\n  var textArea = document.createElement(\"textarea\");\n  textArea.value = text;\n\n  // Avoid scrolling to bottom\n  textArea.style.top = \"0\";\n  textArea.style.left = \"0\";\n  textArea.style.position = \"fixed\";\n\n  document.body.appendChild(textArea);\n  textArea.focus();\n  textArea.select();\n\n  try {\n    var successful = document.execCommand('copy');\n    var msg = successful ? 'successful' : 'unsuccessful';\n    console.info('Fallback: Copying text command was ' + msg);\n  } catch (err) {\n    console.error('Fallback: Oops, unable to copy', err);\n  }\n\n  document.body.removeChild(textArea);\n}\n\nfunction copyTextToClipboard(text) {\n  // Source: https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\n  if (!navigator.clipboard) {\n    fallbackCopyTextToClipboard(text);\n    return;\n  }\n  navigator.clipboard.writeText(text).then(function() {\n    console.info('Async: Copying to clipboard was successful!');\n  }, function(err) {\n    console.error('Async: Could not copy text: ', err);\n  });\n}\n\nfunction SharingEditor({\n  defaultBlock = {},\n  open = false,\n  onChange,\n  onClose,\n}) {\n  const [ path, setPath ] = useState('')\n\n  useEffect(() => {\n    const properties = defaultBlock.properties || {}\n    const initialPath = (properties.trigger || {}).path || ''\n\n    setPath(initialPath)\n  }, [ defaultBlock, setPath ])\n\n  const savePath = useCallback(newPath => {\n    const newProperties = {...(defaultBlock.properties || {})}\n\n    if (newPath === '') {\n      if (newProperties.hasOwnProperty('trigger')) {\n        delete newProperties.trigger\n      }\n      if (newProperties.hasOwnProperty('action')) {\n        delete newProperties.action\n      }\n    } else {\n      newProperties.trigger = {\n\t\t  \ttype: 'path',\n\t\t  \tpath: newPath,\n\t\t  }\n\t\t  newProperties.action = {\n\t\t  \ttype: 'render_block',\n\t\t  }\n    }\n\n    setPath(newPath)\n    onChange(newProperties)\n  }, [\n    defaultBlock,\n    onChange,\n    setPath,\n  ])\n\n  const viewStatistics = () => {\n    const a = document.createElement('a')\n    a.href = `https://umami.qiekub.org/share/s0ZHBZbb/volt.link?url=%2F${path}`\n    a.target = '_blank'\n    a.rel = 'noreferrer'\n    a.click()\n  }\n\n  const gotoQrcodePage = () => {\n    const a = document.createElement('a')\n    a.href = `https://qrcode.volt.link/?c=volt.link/${path}`\n    a.target = '_blank'\n    a.rel = 'noreferrer'\n    a.click()\n  }\n\n  const copyUrl = () => {\n    copyTextToClipboard(`https://volt.link/${path}`)\n    alert('Copied to clipboard ')\n  }\n\n  if (!open) {\n    return null\n  }\n\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      hideBackdrop={true}\n    >\n      <>\n        <div className={classes.backdrop} onClick={onClose}></div>\n\n        <div className={classes.dialog}>\n\n            <h1 style={{ margin: '0 0 var(--basis_x4) 0' }}>Share the link</h1>\n            {/* <p>Enter @volteuropa.org addresses to give editing rights.<br/>Groups addresses are not supported.</p> */}\n\n            {/* <hr style={{ opacity: 0.2 }} /> */}\n\n            <div className={classes.inputWrapper}>\n             <span style={{ paddingRight: 'var(--basis)' }}>volt.link/</span>\n             <HtmlInput\n                defaultValue={path}\n                onBlur={savePath}\n                linebreak={false}\n                className={classes.input}\n                style={{ margin: '0' }}\n              />\n            </div>\n\n            <hr style={{ opacity: 0.2 }} />\n\n            <div className={classes.actions}>\n              {\n                path !== ''\n                ? <div>\n                    <button className=\"text hasIcon\" onClick={gotoQrcodePage} style={{ marginInlineStart: '0' }}>\n                      <QrCodeIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_qrcode\" /></span>\n                    </button>\n                    <button className=\"text hasIcon\" onClick={viewStatistics}>\n                      <AssessmentIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_statistics\" /></span>\n                    </button>\n                    <button className=\"text hasIcon\" onClick={copyUrl}>\n                      <CopyIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_copy_url\" /></span>\n                    </button>\n                  </div>\n                : <div></div>\n              }\n\n              <button onClick={onClose} className=\"green\" style={{ marginInlineEnd: '0' }}>\n                <Localized id=\"dialog_done\" />\n              </button>\n            </div>\n        </div>\n      </>\n    </Modal>\n  )\n}\n\nexport default SharingEditor\n","import { useState, useCallback } from 'react'\n\nimport classes from './InputWithLocal.module.css'\nimport LocaleSelect from './LocaleSelect.js'\n\nfunction InputWithLocal({ reorderHandle, actionButton, locale, defaultValue, children, style, onChange, onBlur, className, dataset = {}, ...props }) {\n  const [changedLocale, setChangedLocale] = useState(locale)\n  const [changedText, setChangedText] = useState(defaultValue)\n\n  const handleBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur({\n        value: {\n          locale: changedLocale,\n          text: changedText,\n        },\n        dataset,\n      })\n    }\n  }, [ onBlur, changedLocale, changedText, dataset ])\n\n  const handleLocaleChange = useCallback(newLocale => {\n    setChangedLocale(newLocale)\n\n    const changes = {\n      value: {\n        locale: newLocale,\n        text: changedText,\n      },\n      dataset,\n    }\n\n    if (onChange) {\n      onChange(changes)\n    }\n    if (onBlur) {\n      onBlur(changes)\n    }\n  }, [setChangedLocale, onChange, changedText, dataset, onBlur])\n\n  const handleTextChange = useCallback((event_or_text) => {\n    let text = event_or_text\n    if (\n      !!event_or_text\n      && !!event_or_text.target\n      && !!event_or_text.target.value\n    ) {\n      text = event_or_text.target.value\n    }\n\n    setChangedText(text)\n    if (onChange) {\n      onChange({\n        value: {\n          locale: changedLocale,\n          text,\n        },\n        dataset,\n      })\n    }\n  }, [setChangedText, onChange, changedLocale, dataset])\n\n  return <div\n    className={classes.input_with_local+' '+className}\n    style={style}\n  >\n    <LocaleSelect\n      onChange={handleLocaleChange}\n      defaultValue={locale}\n    />\n    {\n      !!children\n        ? children({\n          onChange: handleTextChange,\n          onBlur: handleBlur,\n          defaultValue,\n          style: {\n            flexGrow: '1',\n          }\n        })\n        : null\n    }\n  </div>\n}\n\nexport default InputWithLocal\n","import { useState, useCallback, useEffect } from 'react'\n\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\n\nimport { v4 as uuidv4 } from 'uuid'\n\nimport classes from './Repeater.module.css'\n\nimport DragIndicatorIcon from '@mui/icons-material/DragIndicator'\n\nfunction reorder(list, startIndex, endIndex) {\n  const result = Array.from(list)\n  const [removed] = result.splice(startIndex, 1)\n  result.splice(endIndex, 0, removed)\n\n  return result\n}\n\nfunction Row({\n  subDefaultValue,\n  index,\n  render,\n  handleRowChange,\n  isReorderable,\n  handleAddRow,\n  handleRemoveRow,\n  showReorderControls,\n  reorderLabel,\n  showActionButton,\n  hasOnlyOneRow,\n  addRowByIndex,\n}) {\n  return <Draggable\n      key={subDefaultValue.tmp_id}\n      draggableId={subDefaultValue.tmp_id}\n      index={index}\n      isDragDisabled={isReorderable === true ? false : true}\n      disableInteractiveElementBlocking={true}\n      shouldRespectForcePress={true}\n    >\n      {provided => (\n        <div\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n\n          key={subDefaultValue.tmp_id}\n          className={classes.row}\n        >\n          {/*\n            index !== 0\n            ? <div className={classes.middleActions}>\n              <div className={classes.trigger}></div>\n              <div className={classes.content}>\n                <button className={`green ${classes.inlineRowButton}`} data-index={index} onClick={handleAddRow}>+</button>\n              </div>\n            </div>\n            : null\n          */}\n\n        <div className={classes.form}>\n          {\n            isReorderable === true && showReorderControls === true\n              ? <button\n                  aria-label={reorderLabel}\n                  className={`text ${classes.inlineRowButton} ${classes.dragHandleButton}`}\n                  {...provided.dragHandleProps}\n                >\n                  <DragIndicatorIcon />\n                </button>\n              : null\n          }\n          {\n            render({\n              key: subDefaultValue.tmp_id,\n              defaultValue: subDefaultValue,\n              className: classes.item,\n              dataset: {\n                'data-index': index,\n                'data-id': subDefaultValue.tmp_id,\n              },\n              onChange: handleRowChange,\n              onRemoveRow: () => handleRemoveRow(index),\n              addRowBefore: (newValue) => addRowByIndex(index, 0, newValue),\n              addRowAfter: (newValue) => addRowByIndex(index, 1, newValue),\n              reorderHandle: <button\n                  aria-label={reorderLabel}\n                  className={`text ${classes.inlineRowButton} ${classes.dragHandleButton}`}\n                  {...provided.dragHandleProps}\n                >\n                  <DragIndicatorIcon />\n                </button>,\n              actionButton: (\n                hasOnlyOneRow\n                  ? <button className={`green ${classes.inlineRowButton}`} onClick={handleAddRow}>+</button>\n                  : <button className={`red ${classes.inlineRowButton}`} data-index={index} onClick={handleRemoveRow}></button>\n              ),\n            })\n          }\n          {\n            showActionButton === true\n            ? (\n            hasOnlyOneRow\n              ? <button className={`green ${classes.inlineRowButton}`} onClick={handleAddRow}>+</button>\n              : <button className={`red ${classes.inlineRowButton}`} data-index={index} onClick={handleRemoveRow}></button>\n            )\n            : null\n          }\n        </div>\n      </div>\n    )}\n  </Draggable>\n}\n\nfunction getIndex(eventOrIndex) {\n  let index = eventOrIndex // for if it is a number/index\n\n  if (typeof eventOrIndex === 'object') {\n    if (!!eventOrIndex.target) { // is event\n      eventOrIndex = eventOrIndex.target\n    }\n    if (!!eventOrIndex.dataset) { // is only the dataset\n      if (!!eventOrIndex.dataset.index) {\n        index = parseInt(eventOrIndex.dataset.index)\n        if (isNaN(index)) {\n          index = null\n        }\n      }\n    }\n  }\n\n  return index\n}\n\nfunction Repeater({\n  defaultValue,\n  addDefaultValue,\n  addButtonText,\n  hideAddButton = false,\n  reorderLabel = 'Reorder',\n  render,\n  style,\n  onChange,\n  prependNewItems,\n  showReorderControls = false,\n  showActionButton = true,\n  isReorderable = false\n}) {\n  if (!(!!addButtonText)) {\n    addButtonText = 'Add Row'\n  }\n\n  const [rows, setRows] = useState([])\n\n  const internalAddDefaultValue = useCallback(() => {\n    let tmp_defaultValue = {}\n    if (typeof addDefaultValue === 'function') {\n      const defaultValue = addDefaultValue()\n      if (typeof defaultValue === 'object' && defaultValue !== null) {\n        tmp_defaultValue = defaultValue\n        if (\n          typeof tmp_defaultValue.tmp_id !== 'string'\n          || tmp_defaultValue.tmp_id === ''\n        ) {\n          tmp_defaultValue.tmp_id = uuidv4()\n        }\n      }\n    }\n    return tmp_defaultValue\n  }, [addDefaultValue])\n\n  useEffect(() => {\n    let tmp_defaultValue = defaultValue\n    if (!Array.isArray(defaultValue) || defaultValue.length === 0) {\n      tmp_defaultValue = [internalAddDefaultValue()]\n    }\n    tmp_defaultValue = tmp_defaultValue.map(item => {\n      if (!item.tmp_id) {\n        return { ...item, tmp_id: uuidv4() }\n      }\n      return item\n    })\n    setRows(tmp_defaultValue)\n  }, [defaultValue, internalAddDefaultValue, setRows])\n\n  const handleRemoveRow = useCallback(eventOrIndex => {\n    const index = getIndex(eventOrIndex)\n\n    let new_rows = [...rows]\n    new_rows.splice(index, 1)\n    const rows_from_onChange = onChange(new_rows)\n    if (Array.isArray(rows_from_onChange)) {\n      new_rows = rows_from_onChange\n    }\n    setRows(new_rows)\n  }, [rows, setRows, onChange])\n\n  const handleRowChange = useCallback(event => {\n    const index = event.dataset.index || event.dataset['data-index']\n    const tmp_id = event.dataset.id || event.dataset['data-id']\n    const newValue = event.value\n\n    const new_rows = [...rows]\n    if (typeof newValue !== 'object' || newValue === null || Array.isArray(newValue)) {\n      new_rows[index] = {\n        tmp_id,\n        value: newValue\n      }\n    } else if (typeof newValue === 'object') {\n      new_rows[index] = {\n        tmp_id,\n        ...newValue\n      }\n    }\n    setRows(new_rows)\n    onChange(new_rows)\n  }, [rows, setRows, onChange])\n\n  const addRowByIndex = useCallback((index, offset = 0, newValue) => {\n    if (typeof newValue === 'object') {\n      newValue = {\n        ...(internalAddDefaultValue()),\n        ...newValue,\n      }\n    } else {\n      newValue = newValue || internalAddDefaultValue()\n    }\n\n    let new_rows = null\n    if (index !== null && index >= 0) {\n      new_rows = [...rows]\n      new_rows.splice(index + offset, 0, newValue)\n    }\n\n    setRows(new_rows)\n    onChange(new_rows)\n  }, [rows, internalAddDefaultValue, setRows, onChange])\n\n  const handleAddRow = useCallback(eventOrIndex => {\n    const newValue = internalAddDefaultValue()\n\n    const index = getIndex(eventOrIndex)\n\n    let new_rows = null\n    if (index !== null && index >= 0) {\n      new_rows = [...rows]\n      new_rows.splice(index, 0, newValue)\n    } else {\n      if (prependNewItems === true) {\n        new_rows = [newValue, ...rows]\n      } else {\n        new_rows = [...rows, newValue]\n      }\n    }\n\n    setRows(new_rows)\n    onChange(new_rows)\n  }, [rows, internalAddDefaultValue, setRows, onChange, prependNewItems])\n\n  function onDragEnd(result) {\n    if (!result.destination) {\n      return\n    }\n\n    if (result.destination.index === result.source.index) {\n      return\n    }\n\n    const new_rows = reorder(\n      rows,\n      result.source.index,\n      result.destination.index\n    )\n    setRows(new_rows)\n    onChange(new_rows)\n  }\n\n  const hasOnlyOneRow = rows.length === 1\n\n  const addButton = <div style={{ textAlign: 'right' }}>\n    <button className={`green ${classes.addRowButton}`} onClick={handleAddRow}>{addButtonText}</button>\n  </div>\n\n  return <div style={style}>\n    {hideAddButton === false && (!hasOnlyOneRow && prependNewItems) ? <div style={{ marginBottom: 'var(--basis)' }}>{addButton}</div> : null}\n\n    <DragDropContext onDragEnd={onDragEnd}>\n      <Droppable\n        droppableId=\"list\"\n        isDropDisabled={isReorderable === true ? false : true}\n      >\n        {provided => (\n          <div ref={provided.innerRef} {...provided.droppableProps}>\n            {\n              rows\n              .filter(subDefaultValue => subDefaultValue.tmp_id)\n              .map(\n                (subDefaultValue, index) => <Row\n                  key={subDefaultValue.tmp_id}\n                  {...{\n                    subDefaultValue,\n                    index,\n                    render,\n                    handleRowChange,\n                    isReorderable,\n                    handleAddRow,\n                    handleRemoveRow,\n                    showReorderControls,\n                    reorderLabel,\n                    showActionButton,\n                    hasOnlyOneRow,\n                    addRowByIndex,\n                  }}\n                />\n              )\n            }\n            {provided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    </DragDropContext>\n\n    {hideAddButton === false && (!hasOnlyOneRow && !prependNewItems) ? addButton : null}\n  </div>\n}\n\nexport default Repeater\n","import React, { useEffect, useState, useCallback } from 'react'\n\nimport {\n  Modal,\n} from '@mui/material'\n\nimport { Localized } from '../../fluent/Localized.js' // useLocalization\n\nimport classes from './TranslationEditor.module.css'\n\nimport HtmlInput from './HtmlInput.js'\nimport InputWithLocal from './InputWithLocal.js'\nimport ViewerAuto from '../view/ViewerAuto.js'\nimport LocaleSelect from './LocaleSelect.js'\nimport Repeater from '../Repeater.js'\n\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\nimport useLoadBlocks from '../../hooks/useLoadBlocks.js'\n\nfunction SimpleTranslationRepeater({ onSaveProperty, block, isFirst }) {\n\n  const addDefaultValue = () => ({\n    locale: null,\n    text: '',\n  })\n\n  let translations = block.properties.translations || []\n  if (translations.length === 0) {\n    translations = [addDefaultValue]\n  }\n\n  const onRepeaterChange = useCallback(newTranslations => {\n    newTranslations = newTranslations\n      .map(translation => ({\n        locale: translation.locale || null,\n        text: translation.text || '',\n      }))\n\n    onSaveProperty('translations', newTranslations)\n  }, [ onSaveProperty ])\n\n  const onBlockLocaleChange = useCallback(newLocale => {\n    onSaveProperty('locale', newLocale)\n  }, [ onSaveProperty ])\n\n  const block2display = { ...block }\n  if (isFirst === true && block2display.type === 'page') {\n    block2display.type = 'text'\n    block2display.properties.text_style = 'h1'\n  }\n\n  return <div style={{\n    width: '100%',\n  }}>\n\n    <div style={{\n      display: 'flex',\n      alignItems: 'flex-end',\n      marginBottom: 'var(--basis)',\n      gap: 'var(--basis)',\n    }}>\n      <LocaleSelect\n        onChange={onBlockLocaleChange}\n        defaultValue={block.properties.locale || null}\n      />\n\n      <ViewerAuto\n        block={block2display}\n        style={{\n          margin: '0',\n          minHeight: '30px',\n        }}\n        actions={{\n          click: false,\n        }}\n      />\n    </div>\n\n    <Repeater\n      onChange={onRepeaterChange}\n      defaultValue={translations}\n      addDefaultValue={addDefaultValue}\n      addButtonText=\"+\"\n      render={\n        ({ defaultValue, ...repeater_props }) => {\n          const {\n            onChange,\n            ...other_repeater_props\n          } = repeater_props\n\n          const locale = defaultValue.locale\n          const text = defaultValue.text\n          return <InputWithLocal\n            onBlur={onChange}\n            locale={locale}\n            defaultValue={text}\n            style={{\n              marginBottom: 'var(--basis)',\n            }}\n            {...other_repeater_props}\n          >\n            {InputWithLocal_props => <HtmlInput\n              {...InputWithLocal_props}\n              style={{\n                ...InputWithLocal_props.style,\n                margin: '0',\n              }}\n            />}\n          </InputWithLocal>\n        }\n      }\n    />\n  </div>\n}\n\nfunction TranslationEditor({\n  defaultBlock = {},\n  open = false,\n  onSaveProperty, // to not overwrite the translatins by the PageEditor\n  onClose,\n}) {\n\n  const [blocks, setBlocks] = useState([])\n\n  const loadBlocks = useLoadBlocks()\n  useEffect(() => {\n    async function loadContentBlocks () {\n      const ids2load = [\n        ...defaultBlock.content\n          .filter(contentConfig =>\n            contentConfig.hasOwnProperty('blockId')\n            && contentConfig.hasOwnProperty('block')\n          )\n          .map(contentConfig => contentConfig.blockId || contentConfig.block._id),\n      ]\n\n      let loadedBlocks = []\n      if (ids2load.length > 0) {\n        loadedBlocks = await loadBlocks({ ids: ids2load })\n      }\n\n      let contentBlocks = ids2load.map(id => { // map to the ids to keep the order\n        const block = loadedBlocks.find(block => block._id === id)\n        if (\n          block\n          && block.type !== 'divider'\n          && !!block.properties.text\n        ) {\n          return block\n        } else {\n          return null\n        }\n      })\n      .filter(Boolean) // remove null values\n\n      return contentBlocks\n    }\n\n    if (blocks.length === 0) {\n      loadContentBlocks()\n        .then(contentBlocks => {\n          const newBlocks = [\n            defaultBlock,\n            ...contentBlocks,\n          ]\n\n          setBlocks(newBlocks)\n        })\n    } else if (JSON.stringify(defaultBlock) !== JSON.stringify(blocks[0])) {\n      // replace the first block of blocks with defaultBlock\n      setBlocks([\n        defaultBlock,\n        ...blocks.slice(1),\n      ])\n    }\n  }, [ defaultBlock, loadBlocks, setBlocks, blocks ])\n\n  const saveBlock = useSaveBlock()\n  const onSaveChildProperty = useCallback((block, key, value) => {\n    const newBlock = {\n      ...block,\n      properties: {\n        ...block.properties,\n        [key]: value,\n      },\n    }\n\n    saveBlock(newBlock)\n      .then(gottenBlock => { // only the id changed in gottenBlock      \n        const blockId = newBlock._id\n\n        // find the block in the blocks array by _id\n        const blockIndex = blocks.findIndex(block => block._id === blockId)\n        \n        // replace the block at blockIndex in the blocks array by newBlock\n        const newBlocks = [\n          ...blocks.slice(0, blockIndex),\n          newBlock,\n          ...blocks.slice(blockIndex + 1),\n        ]\n\n        setBlocks(newBlocks)\n      })\n  }, [ saveBlock, blocks, setBlocks ])\n\n  if (!open) {\n    return null\n  }\n\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      hideBackdrop={true}\n      style={{\n        zIndex: '1000',\n      }}\n    >\n      <>\n        <div className={classes.backdrop} onClick={onClose}></div>\n\n        <div className={classes.dialog}>\n\n          \n          <div className={classes.actions}>\n            <h1 style={{ margin: '0 0 var(--basis_x4) 0' }}>\n              <Localized id=\"translate_dialog_title\" />\n            </h1>\n            <button onClick={onClose} className=\"green\" style={{ marginInlineEnd: '0' }}>\n              <Localized id=\"dialog_done\" />\n            </button>\n          </div>\n          <p>\n            <Localized id=\"translate_dialog_description\" />\n          </p>\n\n          <hr style={{ opacity: 0.2 }} />\n\n          {\n            blocks\n            .flatMap((block, index) => ([\n              <hr key={'hr-'+index} style={{ opacity: 0 }} />,\n              <div key={'div-'+index} style={{ margin: 'var(--basis_x4) 0' }}>\n                <SimpleTranslationRepeater\n                  onSaveProperty={\n                    block._id === defaultBlock._id\n                    ? onSaveProperty\n                    : (...attr) => onSaveChildProperty(block, ...attr)\n                  }\n                  block={block}\n                  isFirst={index === 0}\n                />\n              </div>\n            ]))\n          }\n\n          <hr style={{ opacity: 0.2 }} />\n\n          <div className={classes.actions}>\n            <div></div>\n            <button onClick={onClose} className=\"green\" style={{ marginInlineEnd: '0' }}>\n              <Localized id=\"dialog_done\" />\n            </button>\n          </div>\n        </div>\n      </>\n    </Modal>\n  )\n}\n\nexport default TranslationEditor\n","import { useState } from 'react'\n\nimport classes from './FancyInput.module.css'\n\nfunction FancyInput({ children, className, style, ...props }) {\n  const [error, setError] = useState('')\n\n  return <div\n    className={className}\n    style={style}\n  >\n    {children({ setError })}\n    {\n      error\n      ? <div className={classes.error}>\n          {error.split('\\n').map(error => <p key={error}>{error}</p>)}\n        </div>\n      : null\n    }\n  </div>\n}\n\nexport default FancyInput\n","import { useCallback } from 'react'\n\nconst email_regex = /^(?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?)$/gui // is surrounded by start and end tags\nconst emails_regex = /((?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?))/gui // is surrounded by a group\n\nfunction EmailInput({ multiple = false, onChange, onError, ...props }) {\n  const handleTextChange = useCallback((event) => {\n    if (onChange ||onError) {\n      let value = event.target.value ||''\n      let isSubmittable = false\n      let error = ''\n\n      if (value !== '') {\n        if (multiple === true) {\n          const emails = value.match(emails_regex)\n          if (emails) {\n            value = emails\n            isSubmittable = true\n          } else {\n            error = 'Invalid email(s) format'\n          }\n        } else {\n          if (value.match(email_regex)) {\n            isSubmittable = true\n          } else {\n            error = 'invalid_email'\n          }\n        }\n      }\n\n      if (onChange) {\n        if (isSubmittable) {\n          onChange(value)\n        } else {\n          if (multiple === true) {\n            onChange([])\n          } else {\n            onChange('')\n          }\n        }\n      }\n\n      if (onError) {\n        onError(error)\n      }\n    }\n  }, [multiple, onChange, onError])\n\n  return <input\n    type=\"email\"\n    onChange={handleTextChange}\n    {...props}\n  />\n}\n\nexport default EmailInput\n","import React, { useState, useCallback, useEffect } from 'react'\n\nimport {\n  Modal,\n  Menu,\n  MenuItem,\n  Divider,\n  ListItemIcon,\n  ListItemText,\n} from '@mui/material'\nimport {\n  KeyboardArrowDown as KeyboardArrowDownIcon,\n  Delete as DeleteIcon,\n  Close as CloseIcon,\n  Visibility as ViewerIcon,\n  Edit as EditorIcon,\n  Lock as NoAccessIcon,\n} from '@mui/icons-material'\nimport { v4 as uuidv4 } from 'uuid'\n\nimport { Localized, useLocalization } from '../../fluent/Localized.js'\n\nimport useUser from '../../hooks/useUser.js'\n\nimport FancyInput from './FancyInput.js'\nimport EmailInput from './EmailInput.js'\n\nimport classes from './PermissionsEditor.module.css'\n\nfunction addTmpIds(array) {\n  return [...array].map(obj => {\n    const obj_new = { ...obj }\n    obj_new.tmp_id = uuidv4()\n    return obj_new\n  })\n}\n\nfunction LocalizedRole({ role }) {\n  return <Localized id={'role_'+role} />\n}\n\nfunction RolesMenu({\n  role,\n  trigger,\n  changeRole,\n  removePermission,\n}){\n  const [anchorEl, setAnchorEl] = React.useState(null)\n  const open = Boolean(anchorEl)\n  const handleOpen = event => {\n    setAnchorEl(event.currentTarget)\n  }\n  const handleClose = () => {\n    setAnchorEl(null)\n  }\n\n  return <>\n    {trigger({\n      onClick: handleOpen,\n    })}\n\n    <Menu\n      anchorEl={anchorEl}\n      open={open}\n      onClose={handleClose}\n      MenuListProps={{\n        style: {\n          maxWidth: '100%',\n          background: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n        },\n      }}\n    >\n      <MenuItem\n        disabled={role === 'viewer'}\n        onClick={() => changeRole('viewer')}\n        className=\"roundMenuItem\"\n      >\n        <ListItemIcon>\n          <ViewerIcon />\n        </ListItemIcon>\n        <ListItemText>\n          <LocalizedRole role=\"viewer\" />\n        </ListItemText>\n      </MenuItem>\n      <MenuItem\n        disabled={role === 'editor'}\n        onClick={() => changeRole('editor')}\n        className=\"roundMenuItem\"\n      >\n        <ListItemIcon>\n          <EditorIcon />\n        </ListItemIcon>\n        <ListItemText>\n          <LocalizedRole role=\"editor\" />\n        </ListItemText>\n      </MenuItem>\n      <MenuItem\n        disabled={role === 'no_access'}\n        onClick={() => changeRole('no_access')}\n        className=\"roundMenuItem\"\n      >\n        <ListItemIcon>\n          <NoAccessIcon />\n        </ListItemIcon>\n        <ListItemText>\n          <LocalizedRole role=\"no_access\" />\n        </ListItemText>\n      </MenuItem>\n      \n        {\n          typeof removePermission === 'function'\n          ? <>\n            <Divider style={{ opacity: 0.2 }} />\n            <MenuItem\n              onClick={removePermission}\n              className=\"roundMenuItem\"\n            >\n              <ListItemIcon>\n                <DeleteIcon />\n              </ListItemIcon>\n              <ListItemText>\n                Remove\n              </ListItemText>\n            </MenuItem>\n          </>\n          : null\n        }\n\n        <Divider style={{opacity: 0.2}} />\n\n        <MenuItem\n          onClick={handleClose}\n          className=\"roundMenuItem\"\n        >\n          <ListItemIcon>\n            <CloseIcon />\n          </ListItemIcon>\n          <ListItemText>\n            Close\n          </ListItemText>\n        </MenuItem>\n    </Menu>\n  </>\n}\n\nfunction sortPermissions(permissions) {\n  const owner = permissions\n    .filter(p => p.role === 'owner')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  const special = permissions\n    .filter(p => p.email === '@volteuropa.org' || p.email === '@public')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  const other = permissions\n    .filter(p => p.role !== 'owner' && p.email !== '@volteuropa.org' && p.email !== '@public')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  return [\n    ...owner,\n    ...special,\n    ...other,\n  ]\n}\n\nfunction PermissionsEditor({\n  defaultPermissions,\n  open = false,\n  onChange,\n  onClose,\n}) {\n  const { getString } = useLocalization()\n\n  const user_data = useUser()\n  let user_email = ''\n  if (!!user_data) {\n    if (!!user_data.user) {\n      if (!!user_data.user.email) {\n        user_email = user_data.user.email\n      }\n    }\n  }\n\n  const [inputRepaintKey, setInputRepaintKey] = useState(0)\n  const [permissions, setPermissions] = useState([])\n  const [newEmails, setNewEmails] = useState([])\n  const [newRole, setNewRole] = useState('editor')\n\n  const setNewPermission = useCallback(newPermissions => {\n    newPermissions = addTmpIds(newPermissions || [])\n\n    if (user_email !== '') {\n      const doesNotHaveOwner = newPermissions.filter(permission => permission.role === 'owner').length === 0\n      if (doesNotHaveOwner) {\n        newPermissions.unshift({ tmp_id: uuidv4(), email: user_email, role: 'owner' })\n      }\n    }\n    \n    setPermissions(newPermissions)\n  }, [ user_email, setPermissions ])\n\n  useEffect(() => {\n    const blockPermissions = defaultPermissions['/']\n    if (Array.isArray(blockPermissions)) {\n      setNewPermission(blockPermissions)\n    } else {\n      setNewPermission([])\n    }\n  }, [ setNewPermission, defaultPermissions ])\n\n  const removePermission = useCallback(email => {\n    let newPermissions = permissions.filter(p => p.email !== email)\n    if (email === '@volteuropa.org') {\n      newPermissions = newPermissions.filter(p => p.email !== '@public')\n    }\n\n    const doesNotHaveOwner = newPermissions.filter(p => p.role === 'owner').length === 0\n    if (doesNotHaveOwner) {\n      newPermissions = newPermissions.filter(p => p.email !== user_email)\n      newPermissions.unshift({ tmp_id: uuidv4(), email: user_email, role: 'owner' })\n    }\n\n    setPermissions(newPermissions)\n    onChange({ '/': newPermissions })\n  }, [permissions, user_email, setPermissions, onChange])\n\n  const changeRole = useCallback((email, newRole) => {\n    const newPermissions = permissions.map(permission => {\n      if (permission.email === email) {\n        return {\n          ...permission,\n          role: newRole,\n        }\n      }\n      return permission\n    })\n\n    setPermissions(newPermissions)\n    onChange({ '/': newPermissions })\n  }, [permissions, setPermissions, onChange])\n\n  const addPermissions = useCallback((newEmails, newRole) => {\n    if (newEmails.includes('@public')) {\n      newEmails.push('@volteuropa.org')\n    }\n    let newPermissions = permissions.filter(permission => !newEmails.includes(permission.email))\n    for (const newEmail of newEmails) {\n      newPermissions.unshift({ tmp_id: uuidv4(), email: newEmail, role: newRole })\n    }\n\n    const doesNotHaveOwner = newPermissions.filter(p => p.role === 'owner').length === 0\n    if (doesNotHaveOwner) {\n      newPermissions = newPermissions.filter(p => p.email !== user_email)\n      newPermissions.unshift({ tmp_id: uuidv4(), email: user_email, role: 'owner' })\n    }\n\n    setPermissions(newPermissions)\n    onChange({ '/': newPermissions })\n  }, [permissions, user_email, setPermissions, onChange])\n\n  const addNewPermissionFromInput = useCallback(() => {\n    addPermissions(newEmails, newRole)\n    setNewEmails([]) // reset the email-input | don't reset the role-input so it can be reused when entering multiple emails after each other // setNewRole('editor')\n    setInputRepaintKey(oldInputRepaintKey => oldInputRepaintKey + 1) // redraw the email-input\n  }, [ newEmails, newRole, addPermissions ])\n\n  if (!open) {\n    return null\n  }\n\n  const doesNotHaveVoltEuropa = permissions.filter(permission => permission.email === '@volteuropa.org').length === 0\n  const doesNotHavePublic = permissions.filter(permission => permission.email === '@public').length === 0\n\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      hideBackdrop={true}\n    >\n      <>\n        <div className={classes.backdrop} onClick={onClose}></div>\n\n        <div className={classes.dialog}>\n          <h1 style={{ margin: '0 0 var(--basis_x4) 0' }}>\n            <Localized id=\"permissions_dialog_title\" />\n          </h1>\n          <p>\n            <Localized id=\"permissions_dialog_description\" />\n          </p>\n          <div className={classes.inputWrapper} key={inputRepaintKey}>\n            <FancyInput className={classes.input}>\n              {({ setError }) => (\n                <EmailInput\n                  multiple={true}\n                  onError={setError}\n                  defaultValue=\"\"\n                  onChange={setNewEmails}\n                  aria-label={getString('path_editor_permissions_edit_label')}\n                  placeholder={getString('path_editor_permissions_edit_placeholder')}\n                  style={{\n                    flexGrow: '1',\n                    // margin: '0',\n                    margin: 'var(--basis) 0',\n                    width: 'calc(100% - var(--basis_x2))',\n                  }}\n                />\n              )}\n            </FancyInput>\n            <RolesMenu\n              role={newRole}\n              changeRole={setNewRole}\n              trigger={triggerProps => <button className={classes.menuButton} {...triggerProps}><LocalizedRole role={newRole} /> <KeyboardArrowDownIcon/></button>}\n            />\n          </div>\n\n          {\n            newEmails.length > 0 && newEmails[0].length > 0\n            ? <>\n                <hr />\n\n                <div className={classes.actions}>\n                  <div></div>\n                  <button onClick={addNewPermissionFromInput} className=\"green\" style={{margin: '0'}}>\n                    {\n                      newEmails.length > 1\n                      ? \"Add People\"\n                      : \"Add Person\"\n                    }\n                  </button>\n                </div>\n              </>\n            : <>\n                {\n                  doesNotHaveVoltEuropa || doesNotHavePublic\n                  ? <div style={{ marginTop: 'var(--basis_x2)' }}>\n                    Make visible for\n                    {\n                      doesNotHaveVoltEuropa\n                      ? <button onClick={() => addPermissions(['@volteuropa.org'], 'viewer')}>Volt Europa</button>\n                      : null\n                    }\n                    {\n                      doesNotHavePublic\n                      ? <button onClick={() => addPermissions(['@public'], 'viewer')}>Public</button>\n                      : null\n                    }\n                  </div>\n                  : null\n                }\n\n                {\n                  permissions.length === 0\n                   ? null\n                   : <hr style={{ opacity: 0.2 }} />\n                }\n\n                {\n                  sortPermissions(permissions)\n                  .map(p => <div key={p.tmp_id} className={classes.permissionRow}>\n                    {\n                      p.email === '@public'\n                        ? <strong>Public</strong>\n                        : (\n                          p.email === '@volteuropa.org'\n                            ? <strong>Volt Europa</strong>\n                            : <span>{p.email}</span>\n                        )\n                    }\n\n                    {\n                      p.role === 'owner'\n                      ? <strong className={`type_button ${classes.ownerInfo}`}><LocalizedRole role={p.role} /></strong>\n                      : <RolesMenu\n                          role={p.role}\n                          removePermission={() => removePermission(p.email)}\n                          changeRole={(newRole) => changeRole(p.email, newRole)}\n                          trigger={triggerProps => <button className={classes.menuButton} {...triggerProps}><LocalizedRole role={p.role} /> <KeyboardArrowDownIcon/></button>}\n                        />\n                    }\n                  </div>)\n                }\n\n                <hr style={{ opacity: 0.2 }} />\n\n                <div className={classes.actions}>\n                  <div></div>\n                  <button onClick={onClose} className=\"green\" style={{margin: '0'}}>\n                    <Localized id=\"dialog_done\" />\n                  </button>\n                </div>\n              </>\n          }\n        </div>\n      </>\n    </Modal>\n  )\n}\n\nexport default PermissionsEditor\n","import { useCallback, useState } from 'react'\n\nimport {\n  CheckBox as CheckBoxIcon,\n  CheckBoxOutlineBlank as CheckBoxOutlineBlankIcon,\n} from '@mui/icons-material'\n\nfunction CheckboxInput({\n  defaultValue = '',\n  onChange,\n  onBlur,\n  style,\n  className,\n  disabled = false,\n}) {\n  // TODO: make ARIA compatible\n\n  const [ checked, setChecked ] = useState(Boolean(defaultValue))\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange(checked)\n    }\n    if (onBlur) {\n      onBlur(checked)\n    }\n  }, [ onChange, onBlur, checked ])\n\n  const checkBlock = useCallback(() => {\n    if (disabled === true) {\n      return\n    }\n    publishChanges()\n    setChecked(true)\n  }, [ disabled, publishChanges, setChecked ])\n\n  const uncheckBlock = useCallback(() => {\n    if (disabled === true) {\n      return\n    }\n    publishChanges()\n    setChecked(false)\n  }, [ disabled, publishChanges, setChecked ])\n\n  return <div\n    style={{\n      display: 'inline-block',\n      padding: 'var(--basis)',\n      cursor: disabled === true ? 'default' : 'pointer',\n      verticalAlign: 'middle',\n      ...style,\n    }}\n    className={className}\n  >\n    {\n      checked\n      ? <CheckBoxIcon onClick={uncheckBlock} />\n      : <CheckBoxOutlineBlankIcon onClick={checkBlock} />\n    }\n  </div>\n}\n\nexport default CheckboxInput\n","import { useState, useCallback, useEffect } from 'react'\n\nfunction MultiButton({ ariaLabel, items, defaultValue, onChange, style, className }) {\n  const [choosen, setChoosen] = useState()\n\n  useEffect(() => setChoosen(defaultValue), [defaultValue, setChoosen])\n\n  const handleClick = useCallback(event => {\n    const newValue = event.target.dataset.value\n    setChoosen(newValue)\n    if (onChange) {\n      onChange(newValue)\n    }\n  }, [setChoosen, onChange])\n\n  return <div\n    aria-label={ariaLabel}\n    className={'buttonRow ' + (className ||'')}\n    style={{\n      display: 'inline-block',\n      ...style\n    }}\n  >\n    {\n      items.map(item => {\n        const value = item.value\n        const title = item.title\n        const icon = item.icon || null\n        return <button\n          key={value+'_'+title}\n          className={`default ${choosen === value ? 'choosen' : ''} ${!!icon ? 'hasIcon' : ''}`}\n          onClick={handleClick}\n          data-value={value}\n        >\n          <span style={{pointerEvents: 'none'}}>\n            {!!icon ? icon : null}\n            {!!title ? <span style={{verticalAlign: 'middle'}}>{title}</span> : null}\n          </span>\n        </button>\n      })\n    }\n  </div>\n}\n\nexport default MultiButton\n","import { useCallback, useState } from 'react'\n\nconst url_regex = /^([A-Z0-9+-.]+:(?:\\/\\/)?)[\\w\\u00C0-\\u00FF_.-]+(?:\\.[\\w\\u00C0-\\u00FF_.-]+)+[\\w\\u00C0-\\u00FF_~:/?#[\\]!%$&'()@*+,;=.-]+$/gui\nconst email_regex = /^(?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?)$/gui\nconst is_email_not_url_regex = /^[^:/]+@.+$/gui\n\nfunction UrlInput({\n  defaultValue = '',\n  onChange,\n  onBlur,\n  onError,\n  placeholder = 'https://',\n  style,\n  className\n}) {\n  const [text, setText] = useState(defaultValue)\n\n  const handleTextChange = useCallback((event) => {\n    const value = event.target.value ||''\n    // let isSubmittable = false\n    let error = ''\n\n    if (value !== '') {\n      const schema_parts = value.split(':')\n      const schema = schema_parts.shift()\n      const after_schema = schema_parts.join(':')\n\n      if (schema === 'tel') {\n        // isSubmittable = true\n      } else if (schema === 'mailto' || value.match(is_email_not_url_regex)) {\n        if (after_schema.match(email_regex)) {\n          // isSubmittable = true\n        } else {\n          error = 'invalid_mailto_url'\n        }\n      } else {\n        if (value.match(url_regex)) {\n          // isSubmittable = true\n        } else {\n          error = 'invalid_url'\n        }\n      }\n    }\n\n    if (onChange) {\n      onChange(value)\n    }\n\n    if (onError) {\n      onError(error)\n    }\n\n    setText(value)\n  }, [onChange, onError])\n\n  const handleBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur(text)\n    }\n  }, [onBlur, text])\n\n  return <input\n    type=\"url\"\n    onChange={handleTextChange}\n    onBlur={handleBlur}\n    defaultValue={defaultValue}\n    placeholder={placeholder}\n    style={style}\n    className={className}\n  />\n}\n\nexport default UrlInput\n","export default __webpack_public_path__ + \"static/media/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.3f9289d0.png\";","export default __webpack_public_path__ + \"static/media/Aktion.89c1bcdf.png\";","export default __webpack_public_path__ + \"static/media/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.6824f6ef.png\";","export default __webpack_public_path__ + \"static/media/Welcome-to-Volt.39e04eca.png\";","export default __webpack_public_path__ + \"static/media/portugal.682fc2e3.jpg\";","\nimport classes from './CoverphotoPicker.module.css'\n\n// import { getImageUrl } from '../../functions.js'\n\nimport Popover from '../Popover.js'\n\nimport { Paper } from '@mui/material'\nimport {\n  RectangleSharp as CoverphotoIcon,\n} from '@mui/icons-material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n\nimport MultiButton from '../MultiButton.js'\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\n\nimport plakatschlange_thumb from '../../images/coverphotos/thumbs/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.png'\nimport aktion_thumb from '../../images/coverphotos/thumbs/Aktion.png'\nimport volt_bonn_thumb from '../../images/coverphotos/thumbs/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.png'\nimport welcome_to_volt_thumb from '../../images/coverphotos/thumbs/Welcome-to-Volt.png'\nimport portugal_thumb from '../../images/coverphotos/thumbs/portugal.jpg'\n\n\nfunction CoverphotoPicker({ getString, coverphotoValue, iconValue, onChange, className = '', style = {} }) {\n  \n  const onUrlChange = newUrl => {\n    onChange({\n      type: 'url',\n      url: newUrl,\n    })\n  }\n\n  const isAbsoluteUrlRegexp = new RegExp('^(?:[a-z]+:)?//', 'i')\n\n  // if (\n  //   typeof coverphotoValue === 'object'\n  //   && coverphotoValue !== null\n  //   && !Array.isArray(coverphotoValue)\n  // ) {\n  //   if (coverphotoValue.type === 'url') {\n  //     return coverphotoValue.url || ''\n  //   }\n  // }\n\n  let coverphotoValueUrl = ''\n  let coverphotoIsSet = false\n  let iconIsSet = false\n\n  if (\n    typeof coverphotoValue === 'object'\n    && coverphotoValue !== null\n    && !Array.isArray(coverphotoValue)\n  ) {\n    if (\n      coverphotoValue.type === 'url'\n      && typeof coverphotoValue.url === 'string'\n      && isAbsoluteUrlRegexp.test(coverphotoValue.url)\n    ) {\n      coverphotoIsSet = true\n      coverphotoValueUrl = coverphotoValue.url || ''\n    }\n  }\n\n  if (\n    typeof iconValue === 'object'\n    && iconValue !== null\n    && !Array.isArray(iconValue)\n  ) {\n    if (\n      iconValue.type === 'url'\n      && typeof iconValue.url === 'string'\n      && isAbsoluteUrlRegexp.test(iconValue.url)\n    ) {\n      iconIsSet = true\n    }\n  }\n\n  return <div\n    className={`\n      ${classes.root}\n      ${coverphotoIsSet ? classes.coverphotoIsSet : classes.coverphotoIsNotSet}\n      ${iconIsSet ? classes.iconIsSet : classes.iconIsNotSet}\n      ${className}\n    `}\n    style={style}\n  >\n    <Popover\n      trigger={(triggerProps) => (\n        <div\n          className={classes.coverphoto}\n          style={{\n            backgroundImage: coverphotoIsSet ? `url(${window.domains.backend}download_url?f=jpg&w=1400&h=400&url=${encodeURIComponent(coverphotoValue.url)})` : '',\n          }}\n        >\n          <div className={classes.button_wrapper}>\n            <button {...triggerProps} className={`text hasIcon ${classes.changeCoverphotoButton}`}>\n              <CoverphotoIcon className=\"icon\" />\n              <span style={{ marginInlineStart: 'var(--basis_x2)', verticalAlign: 'middle'}}>Set Coverphoto</span>\n            </button>\n          </div>\n        </div>\n      )}\n    >\n      {({closePopover, ...popoverProps}) => (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 'calc(calc(100vw - 32px) - var(--basis_x8))',\n            maxHeight: 'calc(calc(100vh - 32px) - var(--basis_x8))',\n            overflow: 'auto',\n            padding: 'var(--basis_x4)',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }}\n          elevation={8}\n        >\n          <h3 style={{ marginTop: '0' }}><Localized id=\"path_editor_coverphoto_label\" /></h3>\n\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}>\n            <Localized id=\"path_editor_coverphoto_info\" />\n          </em>\n\n          <FancyInput>\n            {({ setError }) => (\n              <UrlInput\n                onError={setError}\n                onChange={onUrlChange}\n                defaultValue={coverphotoValueUrl}\n                style={{\n                  marginRight: '0',\n                  marginLeft: '0',\n                  width: '100%'\n                }}\n              />\n            )}\n          </FancyInput>\n\n          <MultiButton\n            onChange={onUrlChange}\n            ariaLabel={getString('path_editor_coverphoto_label')}\n            defaultValue={coverphotoValueUrl}\n            items={[\n              {\n                value: '',\n                title: getString('path_editor_no_coverphoto'),\n              },\n              ...[\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_2880x/public/inline-images/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.jpg',\n                  icon: volt_bonn_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2020-11/Welcome-to-Volt.jpg',\n                  icon: welcome_to_volt_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-07/20200912_Plakatschlange_Ko%CC%88ln_Matteo%20Sant_Unione_011.jpeg',\n                  icon: plakatschlange_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/2021-11/portugal.jpg',\n                  icon: portugal_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-05/Aktion.jpeg',\n                  icon: aktion_thumb,\n                },\n                // 'https://www.volteuropa.org/stripes/hero-desktop-green.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-red.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-blue.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-yellow.jpg',\n                // 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-05/Colours-Background-Big.jpeg',\n                // 'https://www.volteuropa.org/stripes/intermediate-green.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-red.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-blue.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-yellow.jpg',\n                // 'https://www.volteuropa.org/og-default.png',\n                // 'https://www.volteuropa.org/hero-default.jpg',\n              ]\n              .map(({value = '', icon = ''}) => ({\n                value,\n                icon: <img alt=\"\" src={icon} className=\"icon image\" />\n              }))\n            ]}\n          />\n\n          <hr />\n\n          <button className=\"text\" onClick={closePopover} style={{ margin: 0 }}>\n            Close\n          </button>\n        </Paper>\n      )}\n    </Popover>\n  </div>\n}\n\nexport default withLocalization(CoverphotoPicker)\n","\nimport classes from './IconPicker.module.css'\n\nimport Popover from '../Popover.js'\n\nimport { Paper } from '@mui/material'\nimport {\n  CircleSharp as IconIcon,\n} from '@mui/icons-material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\n\nfunction IconPicker({ coverphotoValue, iconValue, onChange, className, style }) {\n\n  const onUrlChange = newUrl => {\n    onChange({\n      type: 'url',\n      url: newUrl,\n    })\n  }\n\n  const isAbsoluteUrlRegexp = new RegExp('^(?:[a-z]+:)?//', 'i')\n\n  let iconValueUrl = ''\n  let coverphotoIsSet = false\n  let iconIsSet = false\n\n  if (\n    typeof coverphotoValue === 'object'\n    && coverphotoValue !== null\n    && !Array.isArray(coverphotoValue)\n  ) {\n    if (\n      coverphotoValue.type === 'url'\n      && typeof coverphotoValue.url === 'string'\n      && isAbsoluteUrlRegexp.test(coverphotoValue.url)\n    ) {\n      coverphotoIsSet = true\n    }\n  }\n\n  if (\n    typeof iconValue === 'object'\n    && iconValue !== null\n    && !Array.isArray(iconValue)\n  ) {\n    if (\n      iconValue.type === 'url'\n      && typeof iconValue.url === 'string'\n      && isAbsoluteUrlRegexp.test(iconValue.url)\n    ) {\n      iconIsSet = true\n      iconValueUrl = iconValue.url || ''\n    }\n  }\n\n  return <div\n    className={`\n      ${classes.root}\n      ${iconIsSet ? classes.iconIsSet : classes.iconIsNotSet}\n      ${coverphotoIsSet ? classes.coverphotoIsSet : classes.coverphotoIsNotSet}\n      ${className}\n    `}\n    style={style}\n  >\n    <Popover\n      trigger={(triggerProps) => (<div className={classes.iconWrapper}>\n        <div\n          className={`${classes.icon} ${!iconIsSet ? classes.no_image : ''}`}\n          style={{\n            backgroundImage: iconIsSet ? `url(${window.domains.backend}download_url?f=${window.imageFormat || 'jpg'}&w=400&h=400&url=${encodeURIComponent(iconValueUrl)})` : '',\n          }}\n        ></div>\n        <button {...triggerProps} className={`text hasIcon ${classes.changeIconButton}`}>\n          <IconIcon className=\"icon\" />\n          <span style={{ marginInlineStart: 'var(--basis_x2)', verticalAlign: 'middle'}}>Set Icon</span>\n        </button>\n      </div>)}\n    >\n      {({closePopover, ...popoverProps}) => (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 'calc(calc(100vw - 32px) - var(--basis_x8))',\n            maxHeight: 'calc(calc(100vh - 32px) - var(--basis_x8))',\n            overflow: 'auto',\n            padding: 'var(--basis_x4)',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }}\n          elevation={8}\n        >\n          <h3 style={{ marginTop: '0' }}><Localized id=\"path_editor_icon_label\" /></h3>\n\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}>\n            <Localized id=\"path_editor_icon_info\" />\n          </em>\n\n          <FancyInput>\n            {({ setError }) => (\n              <UrlInput\n                onError={setError}\n                onBlur={onUrlChange}\n                defaultValue={iconValueUrl}\n                style={{\n                  marginRight: '0',\n                  marginLeft: '0',\n                  width: '100%'\n                }}\n              />\n            )}\n          </FancyInput>\n\n          <hr />\n\n          <button className=\"text\" onClick={closePopover} style={{ margin: 0 }}>\n            Close\n          </button>\n        </Paper>\n      )}\n    </Popover>\n  </div>\n}\n\nexport default withLocalization(IconPicker)\n","import { useRef, useCallback, useState, useEffect } from 'react'\n\nimport HtmlInput from './HtmlInput.js'\nimport useCheckPath from '../../hooks/useCheckPath.js'\n\nfunction PathInput({\n  defaultValue = '',\n  onChange,\n  onBlur,\n  onSubmit,\n  onError,\n  allowExisting = false,\n  placeholder = 'de-bonn',\n  ...props\n}) {\n  const mountedRef = useRef(false)\n  useEffect(() => {\n    mountedRef.current = true\n    return () => {\n      mountedRef.current = false\n    }\n  }, [])\n\n  const checkPath = useCheckPath()\n\n  const [text, setText] = useState('')\n\n  useEffect(() => {\n    if (mountedRef.current) {\n      setText(defaultValue)\n    }\n  }, [setText, defaultValue])\n\n  const handleTextChange = useCallback(async newText => {\n    newText = newText.toLowerCase()\n    setText(newText)\n\n    let isSubmittable = true\n    let error = ''\n    if (newText !== '') {\n      const {\n        isOkay,\n        errors\n      } = (await checkPath(newText)) || {}\n      \n      isSubmittable = isOkay\n      error = errors.join('\\n')\n    }\n\n    if (isSubmittable && onChange) {\n      onChange(newText)\n    }\n\n    if (onError) {\n      onError(error)\n    }\n  }, [\n    setText,\n    checkPath,\n    onChange,\n    onError,\n  ])\n\n  const handleBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur(text)\n    }\n  }, [onBlur, text])\n\n  return <HtmlInput\n    onChange={handleTextChange}\n    onBlur={handleBlur}\n    defaultValue={defaultValue}\n    placeholder={placeholder}\n    linebreaks={false}\n    {...props}\n  />\n}\n\nexport default PathInput\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { checkPath_Query } from '../graphql/queries'\n\nexport default function useCheckPath() {\n  const apollo_client = useApolloClient()\n\n  const handleCheckPath = useCallback((path = '') => {\n    return new Promise(resolve => {\n      apollo_client.query({\n        query: checkPath_Query,\n        variables: {\n          path,\n        },\n      })\n        .then(async ({ data }) => {\n          if (data.hasOwnProperty('checkPath')) {\n            resolve(data.checkPath)\n          } else {\n            resolve(null)\n          }\n        })\n        .catch(async error => {\n          console.error('error', error)\n          resolve(null)\n        })\n    })\n  }, [apollo_client])\n\n  return handleCheckPath\n}\n","import { useState, useCallback, useEffect } from 'react'\n\nimport FancyInput from './FancyInput.js'\nimport PathInput from './PathInput.js'\n// import HtmlInput from './HtmlInput.js'\n\nimport { useLocalization } from '../../fluent/Localized.js'\n\nfunction TriggerInput({\n  defaultValue,\n  className,\n  style,\n  onChange,\n}) {\n  const { getString } = useLocalization()\n\n  const [properties, setProperties] = useState({})\n\n  useEffect(() => {\n    defaultValue.type = 'path'\n    setProperties(defaultValue)\n  }, [\n    defaultValue,\n    setProperties,\n  ])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue) => {\n    const propertyTypes = {\n      type: 'string',\n      path: 'string',\n      url: 'string',\n      cron: 'string',\n      blockId: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n\n      if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n        setProperties(newProperties)\n        if (onChange) {\n          onChange(newProperties)\n        }\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const type = properties.type || ''\n\n  let morePropsInput = null\n  if (type === 'click') {\n    morePropsInput = null\n  } else if (type === 'path') {\n    morePropsInput = <>\n      <FancyInput\n        style={{\n          flexGrow: '1',\n        }}\n      >\n        {({ setError }) => (\n          <PathInput\n            onError={setError}\n            placeholder={getString('trigger_input_path_placeholder')}\n            defaultValue={properties.path}\n            onBlur={newValue => updateProperty('path', newValue)}\n            style={{\n              flexGrow: '1',\n              margin: '0',\n              minWidth: '300px',\n            }}\n            // className=\"show_border_on_active\"\n          />\n        )}\n      </FancyInput>\n    </>\n  // } else if (type === 'cron') {\n  //   morePropsInput = <>cron: String</>\n  // } else if (type === 'block_change') {\n  //   morePropsInput = <>blockId: ID</>\n  }\n\n  return <div\n    className={className}\n    style={{\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'flex-start',\n      maxWidth: '100%',\n      flexWrap: 'wrap',\n      gap: 'var(--basis)',\n      ...style\n    }}\n  >\n    {/*\n    <select\n      key={properties.type}\n      onChange={event => updateProperty('type', event.target.value)}\n      defaultValue={properties.type || ''}\n      style={{\n        margin: '0',\n      }}\n    >\n      <option value=\"\">No Trigger</option>\n      <option value=\"path\">Path</option>\n      <option value=\"click\">Click</option>\n      <option value=\"cron\">Cron</option>\n      <option value=\"block_change\">Block Change</option>\n    </select>\n    */}\n\n    {morePropsInput}\n  </div>\n}\n\nexport default TriggerInput\n","import { useState, useCallback, useEffect } from 'react'\n\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\nimport HtmlInput from './HtmlInput.js'\n\nimport { useLocalization } from '../../fluent/Localized.js'\n\nfunction ActionInput({\n  defaultValue,\n  className,\n  style,\n  onChange,\n}) {\n  const { getString } = useLocalization()\n\n  const [properties, setProperties] = useState({})\n\n  useEffect(() => {\n    defaultValue.type = 'open_url'\n    setProperties(defaultValue)\n  }, [\n    defaultValue,\n    setProperties,\n  ])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue) => {\n    const propertyTypes = {\n      type: 'string',\n      path: 'string',\n      url: 'string',\n      cron: 'string',\n      blockId: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n\n      if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n        setProperties(newProperties)\n        if (onChange) {\n          onChange(newProperties)\n        }\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const type = properties.type || ''\n\n  let morePropsInput = null\n  if (\n    type === 'open_url'\n    || type === 'send_payload'\n  ) {\n    morePropsInput = <>\n      <FancyInput\n        style={{\n          flexGrow: '1',\n          margin: '0',\n          minWidth: '300px',\n        }}\n      >\n        {({ setError }) => (\n          <UrlInput\n            onError={setError}\n            onBlur={newValue => updateProperty('url', newValue)}\n            defaultValue={properties.url}\n            placeholder={getString('action_input_url_placeholder')}\n            type=\"text\"\n            style={{\n              flexGrow: 1,\n              margin: '0',\n              width: '100%'\n            }}\n            // className=\"show_border_on_active\"\n          />\n        )}\n      </FancyInput>\n    </>\n  } else if (\n    type === 'render_block'\n    || type === 'run_block'\n  ) {\n    morePropsInput = <HtmlInput\n        placeholder=\"blockId\"\n        defaultValue={properties.blockId}\n        onBlur={newValue => updateProperty('blockId', newValue)}\n        linebreak={false}\n        style={{\n          flexGrow: '1',\n          margin: '0',\n          minWidth: '300px',\n        }}\n        // className=\"show_border_on_active\"\n      />\n  }\n\n  return <div\n    className={className}\n    style={{\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'flex-start',\n      maxWidth: '100%',\n      flexWrap: 'wrap',\n      gap: 'var(--basis)',\n      ...style\n    }}\n  >\n    {/*\n    <select\n      key={properties.type}\n      onChange={event => updateProperty('type', event.target.value)}\n      defaultValue={properties.type || ''}\n      style={{\n        margin: '0',\n      }}\n    >\n      <option value=\"\">No Action</option>\n      <option value=\"open_url\">Open URL</option>\n      <option value=\"render_block\">Render Block</option>\n      <option value=\"run_block\">Run Block</option>\n      <option value=\"send_payload\">Send Payload</option>\n    </select>\n    */}\n\n    {morePropsInput}\n  </div>\n}\n\nexport default ActionInput\n\n\n/*\n\n  let morePropsInput = null\n  if (\n    type === 'open_url'\n    || type === 'send_payload'\n  ) {\n    morePropsInput = <>\n      <UrlInput />\n    </>\n  } else if (\n    type === 'render_block'\n    || type === 'run_block'\n  ) {\n    morePropsInput = <>blockId: ID</>\n  }\n\n\n      <option key=\"editor\" value=\"\"></option>\n      <option key=\"editor\" value=\"open_url\">Open URL</option>\n      <option key=\"viewer\" value=\"render_block\">Render Block</option>\n      <option key=\"viewer\" value=\"run_block\">Run Block</option>\n      <option key=\"viewer\" value=\"send_payload\">Send Payload</option>\n      */\n","import { useState, useCallback, useEffect } from 'react'\n\n// import { v4 as uuidv4 } from 'uuid'\n\nimport classes from './PropertiesEditor.module.css'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n// import UrlInput from './UrlInput.js'\nimport CheckboxInput from './CheckboxInput.js'\nimport HtmlInput from './HtmlInput.js'\n// import FancyInput from './FancyInput.js'\nimport CoverphotoPicker from './CoverphotoPicker.js'\nimport IconPicker from './IconPicker.js'\nimport TriggerInput from './TriggerInput.js'\nimport ActionInput from './ActionInput.js'\n\n// function stripTmpIds(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\n// function addTmpIds(array) {\n//   return [...(array || [])].map(obj => {\n//     if (!obj.tmp_id) {\n//       const obj_new = { ...obj }\n//       obj_new.tmp_id = uuidv4()\n//       return obj_new\n//     }\n//\n//     return obj\n//   })\n// }\n\nfunction PropertiesEditor({ getString, type, defaultProperties = {}, onChange }) {\n  const [properties, setProperties] = useState({})\n\n  // const [coverphoto, setCoverphoto] = useState('')\n  // const [imprint, setImprint] = useState('')\n  // const [privacy_policy, setPrivacyPolicy] = useState('')\n  // const [link, setLink] = useState('')\n\n  // let [voltTeams, setVoltTeams] = useState([])\n  // voltTeams = voltTeams.map(({ id, name }) => ({ value: id, label: name }))\n\n  // const [voltTeamInfos, setVoltTeamInfos] = useState({\n  //   id: null,\n  //   name: ''\n  // })\n  // const setVoltTeamInfosFromSelect = useCallback((data) => {\n  //   setVoltTeamInfos({\n  //     id: data.value,\n  //     name: data.label,\n  //   })\n  // }, [setVoltTeamInfos])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue, silent = false) => {\n    const propertyTypes = {\n      text: 'string',\n      coverphoto: 'string',\n      icon: 'string',\n      imprint: 'string',\n      privacy_policy: 'string',\n      tags: 'string',\n      checked: 'boolean',\n      trigger: 'object',\n      action: 'object',\n      pronouns: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n    }\n\n    if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n      setProperties(newProperties)\n      if (silent === false && onChange) {\n        onChange(newProperties)\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const publishProperties = useCallback(() => {\n    if (onChange) {\n      onChange(properties)\n    }\n  }, [properties, onChange])\n\n  useEffect(() => {\n    setProperties({\n      ...defaultProperties,\n      text: defaultProperties.text || '',\n    })\n  }, [\n    defaultProperties,\n    setProperties,\n  ])\n\n\n  // useEffect(() => {\n  //   fetch(`${window.domains.backend}teams_simple.json`, {\n  //     mode: 'cors',\n  //     credentials: 'include',\n  //   })\n  //     .then(response => response.json())\n  //     .then(data => {\n  //       if (typeof data.error === 'string') {\n  //         setVoltTeams([])\n  //       } else {\n  //         setVoltTeams(data)\n  //       }\n  //     })\n  //     .catch(error => {\n  //       console.error(error)\n  //       setVoltTeams([])\n  //     })\n  // }, [ setVoltTeams ])\n\n  let propertiesFrameContent = null\n  // if (type === 'page') {\n  //   propertiesFrameContent = <>\n  //     <div className={classes.properties_row}>\n  //     <h3><Localized id=\"properties_editor_imprint_label\" /></h3>\n  //     <div>\n  //     <FancyInput>\n  //       {({ setError }) => (\n  //         <UrlInput\n  //           onError={setError}\n  //           onBlur={newValue => updateProperty('imprint', newValue)}\n  //           defaultValue={properties.imprint}\n  //           type=\"text\"\n  //           style={{\n  //             margin: '0',\n  //             width: '100%'\n  //           }}\n  //           // className=\"show_border_on_active\"\n  //         />\n  //       )}\n  //     </FancyInput>\n  //     </div>\n  //     </div>\n  //\n  //     <div className={classes.properties_row}>\n  //     <h3><Localized id=\"properties_editor_privacy_policy_label\" /></h3>\n  //     <div>\n  //     <FancyInput>\n  //       {({ setError }) => (\n  //         <UrlInput\n  //           onError={setError}\n  //           onBlur={newValue => updateProperty('privacy_policy', newValue)}\n  //           defaultValue={properties.privacy_policy}\n  //           type=\"text\"\n  //           style={{\n  //             margin: '0',\n  //             width: '100%'\n  //           }}\n  //           // className=\"show_border_on_active\"\n  //         />\n  //       )}\n  //     </FancyInput>\n  //     </div>\n  //     </div>\n  //   </>\n  // // } else if (type === 'redirect') {\n  // //   propertiesFrameContent = <>\n  // //     <div className={classes.properties_row}>\n  // //     <h3><Localized id=\"path_editor_redirect_label\" /></h3>\n  // //     <FancyInput>\n  // //       {({ setError }) => (\n  // //         <UrlInput\n  // //           onError={setError}\n  // //           onBlur={newValue => updateProperty('link', newValue)}\n  // //           type=\"text\"\n  // //           placeholder={getString('path_editor_redirect_placeholder')}\n  // //           aria-label={getString('path_editor_redirect_label')}\n  // //           defaultValue={properties.link}\n  // //           style={{\n  // //             marginRight: '0',\n  // //             marginLeft: '0',\n  // //             width: '100%'\n  // //           }}\n  // //           className=\"show_border_on_active\"\n  // //         />\n  // //       )}\n  // //     </FancyInput>\n  // //     </div>\n  // //   </>\n  // } else if (type === 'person') {\n  //   propertiesFrameContent = <>\n  //     <div className={classes.properties_row}>\n  //       <h3><Localized id=\"properties_editor_pronouns_label\" /></h3>\n  //       <HtmlInput\n  //         defaultValue={properties.pronouns}\n  //         onChange={newValue => updateProperty('pronouns', newValue, true)}\n  //         onBlur={publishProperties}\n  //         placeholder={''}\n  //         style={{\n  //           margin: '0',\n  //           width: '100%',\n  //         }}\n  //         linebreaks={false}\n  //         className={`type_text`}\n  //       />\n  //     </div>\n  //   </>\n  // } else\n  if (type === 'checkbox') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_checked_label\" /></h3>\n        <CheckboxInput\n          onChange={newValue => updateProperty('checked', newValue)}\n          defaultValue={Boolean(properties.checked)}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  } else if (type === 'button') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_action_label\" /></h3>\n        <ActionInput\n          onChange={newValue => updateProperty('action', newValue)}\n          defaultValue={properties.action || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  } else if (type === 'page' || type === 'person') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_trigger_path_label\" /></h3>\n        <TriggerInput\n          onChange={newValue => updateProperty('trigger', newValue)}\n          defaultValue={properties.trigger || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  } else if (type === 'redirect') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_trigger_path_label\" /></h3>\n        <TriggerInput\n          onChange={newValue => updateProperty('trigger', newValue)}\n          defaultValue={properties.trigger || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_action_url_label\" /></h3>\n        <ActionInput\n          onChange={newValue => updateProperty('action', newValue)}\n          defaultValue={properties.action || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  }\n  // else if (type === 'automation') {\n  //   propertiesFrameContent = <>\n  //     <div className={classes.properties_row}>\n  //       <h3><Localized id=\"properties_editor_trigger_label\" /></h3>\n  //       <TriggerInput\n  //         onChange={newValue => updateProperty('trigger', newValue)}\n  //         defaultValue={properties.trigger || {}}\n  //         style={{\n  //           marginRight: '0',\n  //           marginLeft: '0',\n  //           width: '100%'\n  //         }}\n  //       />\n  //     </div>\n  //     <div className={classes.properties_row}>\n  //       <h3><Localized id=\"properties_editor_action_label\" /></h3>\n  //       <ActionInput\n  //         onChange={newValue => updateProperty('action', newValue)}\n  //         defaultValue={properties.action || {}}\n  //         style={{\n  //           marginRight: '0',\n  //           marginLeft: '0',\n  //           width: '100%'\n  //         }}\n  //       />\n  //     </div>\n  //   </>\n  // }\n\n  return <>\n    {\n      type === 'page'\n      || type === 'person'\n      || type === 'redirect'\n      ? <>\n          <CoverphotoPicker\n            coverphotoValue={properties.coverphoto}\n            iconValue={properties.icon}\n            onChange={newValue => updateProperty('coverphoto', newValue)}\n          />\n          <IconPicker\n            iconValue={properties.icon}\n            coverphotoValue={properties.coverphoto}\n            onChange={newValue => updateProperty('icon', newValue)}\n          />\n        </>\n      : null\n    }\n\n    <div className={classes.main_headline} style={{\n      paddingLeft: 'calc(8 * var(--basis))',\n    }}>\n      <HtmlInput\n        defaultValue={properties.text}\n        onChange={newValue => updateProperty('text', newValue, true)}\n        onBlur={publishProperties}\n\n        placeholder={getString('placeholder_main_headline')}\n        style={{\n          padding: 'var(--basis) var(--basis_x2)',\n        }}\n        linebreaks={true}\n        className={`type_h1`}\n      />\n    </div>\n\n    <div className={classes.propertiesFrame} style={\n      propertiesFrameContent === null\n        ? { display: 'none' }\n        : null\n    }>\n      {propertiesFrameContent}\n\n      {/* <div className={classes.properties_row}>\n        <h3><Localized id=\"path_editor_tags_label\" /></h3>\n        <HtmlInput\n          onBlur={newValue => updateProperty('tags', newValue)}\n          type=\"text\"\n          placeholder={getString('path_editor_tags_placeholder')}\n          aria-label={getString('path_editor_tags_label')}\n          defaultValue={properties.tags}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: 'calc(100% - var(--basis_x2))'\n          }}\n        />\n      </div> */}\n\n      {/*\n        voltTeams && voltTeams.length > 0\n        ? <>\n          <h3><Localized id=\"path_editor_belongs_to_team_label\" /></h3>\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}><Localized id=\"path_editor_belongs_to_team_info\" /></em>\n          <Select\n            defaultValue={{\n              value: voltTeamInfos !== null ? voltTeamInfos.id || null : null,\n              label: voltTeamInfos !== null ? voltTeamInfos.name || '' : '',\n            }}\n            defaultInputValue={voltTeamInfos !== null ? voltTeamInfos.name || '' : ''}\n            onChange={setVoltTeamInfosFromSelect}\n            ariaLabel={getString('path_editor_belongs_to_team_search_placeholder')}\n            label={getString('path_editor_belongs_to_team_search_placeholder')}\n            placeholder={getString('path_editor_belongs_to_team_search_placeholder')}\n            options={voltTeams}\n            styles={custom_react_select_styles}\n            theme={custom_react_select_theme}\n          />\n        </>\n        : null\n      */}\n    </div>\n  </>\n}\n\nexport default withLocalization(PropertiesEditor)\n","import React, { useState, useEffect, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockTextRaw({\n  getString,\n  block = {},\n  onChange,\n  onSaveBlock,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  onAddRowAfter,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState('')\n\n  useEffect(() => {\n    setText(properties.text || '')\n  }, [properties.text, setText])\n\n  const publishTextChange = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  let text_style_class = 'type_text'\n  if (properties.hasOwnProperty('text_style')) {\n    text_style_class = 'type_'+properties.text_style\n  }\n\n  const {\n    color,\n  } = getBlockColor(block)\n\n  const colorStyles = {}\n  if (color) {\n    colorStyles.color = color\n  }\n\n  return <HtmlInput\n    defaultValue={text}\n    onChange={setText}\n    onBlur={publishTextChange}\n\n    placeholder={getString('placeholder_text')}\n    style={{\n      margin: '0',\n      backgroundColor: 'transparent',\n      ...colorStyles,\n    }}\n    linebreaks={true}\n    className={`hide_border ${text_style_class}`}\n\n    onInputRef={onInputRef}\n    onGoToPrevInput={onGoToPrevInput}\n    onGoToNextInput={onGoToNextInput}\n    onMergeToPrevInput={() => onMergeToPrevInput(block)}\n    onMergeFromNextInput={() => onMergeFromNextInput(block)}\n    onSplitText={onSplitText}\n  />\n}\n\nconst InlineEditorBlockText = withLocalization(InlineEditorBlockTextRaw)\n\nexport default InlineEditorBlockText\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport FancyInput from './FancyInput.js'\nimport HtmlInput from './HtmlInput.js'\nimport UrlInput from './UrlInput.js'\n\nfunction InlineEditorBlockButtonRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n  const {\n    action = {}\n  } = properties\n  const [link, setLink] = useState(action.url || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      const newBlock = {\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      }\n\n      if (link === '') {\n        if (newBlock.properties.hasOwnProperty('trigger')) {\n          delete newBlock.properties.trigger\n        }\n        if(newBlock.properties.hasOwnProperty('action')) {\n          delete newBlock.properties.action\n        }\n      } else {\n        newBlock.properties.trigger = {\n          type: 'click'\n        }\n        newBlock.properties.action = {\n\t\t\t\t  type: 'open_url',\n\t\t\t\t  url: link,\n\t\t\t  }\n      }\n\n      onChange(newBlock)\n    }\n  }, [onChange, block, text, link])\n  \n  const {\n    color,\n    colorRGB,\n    contrastingColor,\n  } = getBlockColor(block)\n\n  const colorStyles = {}\n  if (color) {\n    colorStyles['--on-background-rgb'] = colorRGB\n    colorStyles['--button-background'] = color\n    colorStyles['--button-color'] = contrastingColor\n  }\n\n  return <div style={{\n    margin: '0 0 var(--basis) 0',\n    cursor: 'auto',\n    ...colorStyles,\n  }}\n  className=\"clickable_card active\"\n  >\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_button')}\n      style={{\n        margin: '0',\n        ...colorStyles,\n      }}\n      linebreaks={true}\n      className=\"hide_border type_button default\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n\n    <FancyInput>\n      {({ setError }) => (\n        <UrlInput\n          onError={setError}\n          onChange={setLink}\n          onBlur={publishChanges}\n          type=\"text\"\n          defaultValue={link}\n          placeholder={getString('action_input_url_placeholder')}\n          style={{\n            margin: 'var(--basis) 0 0 0',\n            width: '100%',\n          }}\n        />\n      )}\n    </FancyInput>\n  </div>\n}\n\nconst InlineEditorBlockButton = withLocalization(InlineEditorBlockButtonRaw)\n\nexport default InlineEditorBlockButton\n","import React, { useRef, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport {\n  // AutoAwesomeSharp as ActionIcon,\n  LinkSharp as RedirectIcon,\n  ArrowForward as ToIcon,\n} from '@mui/icons-material'\n\nimport FancyInput from './FancyInput.js'\nimport HtmlInput from './HtmlInput.js'\nimport UrlInput from './UrlInput.js'\nimport PathInput from './PathInput.js'\n\n\nfunction InlineEditorBlockRedirectRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  style = {},\n}) {\n  const properties = block.properties || {}\n  const {\n    trigger = {},\n    action = {}\n  } = properties\n\n  const textRef = useRef(properties.text || '')\n  const text = textRef.current\n  const setText = newValue => textRef.current = newValue\n\n  const triggerPathRef = useRef(trigger.path || '')\n  const triggerPath = triggerPathRef.current\n  const setTriggerPath = newValue => triggerPathRef.current = newValue\n\n  const linkRef = useRef(action.url || '')\n  const link = linkRef.current\n  const setLink = newValue => linkRef.current = newValue\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      const text = textRef.current\n      const triggerPath = triggerPathRef.current\n      const link = linkRef.current\n\n      const newBlock = {\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      }\n\n      if (triggerPath === '') {\n        if (newBlock.properties.hasOwnProperty('trigger')) {\n          delete newBlock.properties.trigger\n        }\n      } else {\n        newBlock.properties.trigger = {\n          type: 'path',\n          path: triggerPath,\n        }\n      }\n\n      if (link === '') {\n        if(newBlock.properties.hasOwnProperty('action')) {\n          delete newBlock.properties.action\n        }\n      } else {\n        newBlock.properties.action = {\n\t\t\t\t  type: 'open_url',\n\t\t\t\t  url: link,\n\t\t\t  }\n      }\n\n      onChange(newBlock)\n    }\n  }, [ onChange, block ])\n  \n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  return <div style={{\n    ...style,\n    margin: '0 0 var(--basis) 0',\n    cursor: 'auto',\n    '--on-background-rgb': colorRGB,\n  }}\n  className=\"clickable_card active\"\n  >\n    <div style={{ width: '100%', display: 'flex', alignItems: 'center', color }}>\n      <RedirectIcon\n        style={{\n          margin: 'var(--basis)',\n        }}\n      />\n\n      <HtmlInput\n        defaultValue={text}\n        onChange={setText}\n        onBlur={publishChanges}\n\n        placeholder={getString('placeholder_headline_main')}\n        style={{\n          flexGrow: '1',\n          width: '100%',\n          margin: '0',\n          fontWeight: 'bold',\n          backgroundColor: 'transparent',\n          color,\n        }}\n        linebreaks={true}\n        className=\"hide_border type_text\"\n\n        onInputRef={onInputRef}\n        onGoToPrevInput={onGoToPrevInput}\n        onGoToNextInput={onGoToNextInput}\n        onMergeToPrevInput={() => onMergeToPrevInput(block)}\n        onMergeFromNextInput={() => onMergeFromNextInput(block)}\n        onSplitText={onSplitText}\n      />\n    </div>\n\n    <div style={{ paddingInlineStart: 'var(--basis_x8)', width: '100%', display: 'flex', alignItems: 'center', }}>\n      volt.link/\n      <FancyInput style={{ width: '100%', marginInlineStart: 'var(--basis)' }}>\n        {({ setError }) => (\n          <PathInput\n            onError={setError}\n            onChange={setTriggerPath}\n            onBlur={publishChanges}\n            defaultValue={triggerPath}\n            placeholder={getString('trigger_input_path_placeholder')}\n            style={{\n              margin: 'var(--basis) 0',\n              width: '100%',\n            }}\n          />\n        )}\n      </FancyInput>\n    </div>\n\n    <div style={{ paddingInlineStart: 'var(--basis_x8)', width: '100%', display: 'flex', alignItems: 'center', }}>\n      <ToIcon\n        style={{\n          flexShrink: 0,\n          margin: '0 var(--basis) 0 0',\n        }}\n      />\n\n      <FancyInput style={{ width: '100%' }}>\n        {({ setError }) => (\n          <UrlInput\n            onError={setError}\n            onChange={setLink}\n            onBlur={publishChanges}\n            type=\"text\"\n            defaultValue={link}\n            placeholder={getString('path_editor_item_link_label')}\n            style={{\n              margin: 'var(--basis) 0',\n              width: '100%',\n            }}\n          />\n        )}\n      </FancyInput>\n    </div>\n  </div>\n}\n\nconst InlineEditorBlockRedirect = withLocalization(InlineEditorBlockRedirectRaw)\n\nexport default InlineEditorBlockRedirect\n","import { getBlockColor } from '../../functions.js'\n\nexport default function InlineEditorBlockDivider({ block }) {\n  const {\n    color,\n  } = getBlockColor(block)\n\n  const styles = {}\n  if (color) {\n    styles['--on-background'] = color\n  }\n\n  return <hr style={styles} />\n}\n","import React, { useState, useCallback, useRef } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport HtmlInput from './HtmlInput.js'\nimport CheckboxInput from './CheckboxInput.js'\n\nfunction InlineEditorBlockCheckboxRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n  const checked = useRef(Boolean(properties.checked))\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n          checked: checked.current,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  const saveChecked = useCallback(newValue => {\n    checked.current = newValue\n    publishChanges()\n  }, [ publishChanges ])\n\n  return <div style={{ display: 'flex' }}>\n    <CheckboxInput\n      checked={checked.current}\n      onChange={saveChecked}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_text')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n        backgroundColor: 'transparent',\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockCheckbox = withLocalization(InlineEditorBlockCheckboxRaw)\n\nexport default InlineEditorBlockCheckbox\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\n\nimport {\n  Face as PersonPlaceholderIcon,\n} from '@mui/icons-material'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockPersonRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n  \n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  return <div\n    style={{\n      display: 'flex',\n      margin: '0 0 var(--basis) 0',\n      cursor: 'auto',\n      '--on-background-rgb': colorRGB,\n      color: color,\n    }}\n    className=\"clickable_card active\"\n  >\n    <PersonPlaceholderIcon\n      style={{\n        margin: 'var(--basis)',\n      }}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_text')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n        fontWeight: 'bold',\n        backgroundColor: 'transparent',\n        color,\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockPerson = withLocalization(InlineEditorBlockPersonRaw)\n\nexport default InlineEditorBlockPerson\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nimport {\n  InsertDriveFile as PagePlaceholderIcon,\n} from '@mui/icons-material'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockPageRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n  \n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  return <div\n    style={{\n      display: 'flex',\n      margin: '0 0 var(--basis) 0',\n      cursor: 'auto',\n      '--on-background-rgb': colorRGB,\n      color: color,\n    }}\n    className=\"clickable_card active\"\n  >\n    <PagePlaceholderIcon\n      style={{\n        margin: 'var(--basis)',\n      }}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_headline_main')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n        fontWeight: 'bold',\n        backgroundColor: 'transparent',\n        color,\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockPage = withLocalization(InlineEditorBlockPageRaw)\n\nexport default InlineEditorBlockPage\n","import React, { useState, useCallback, useEffect } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport BlockMenu from './BlockMenu.js'\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\n\nimport InlineEditorBlockText from './InlineEditorBlockText.js'\nimport InlineEditorBlockButton from './InlineEditorBlockButton.js'\nimport InlineEditorBlockRedirect from './InlineEditorBlockRedirect.js'\nimport InlineEditorBlockDivider from './InlineEditorBlockDivider.js'\nimport InlineEditorBlockCheckbox from './InlineEditorBlockCheckbox.js'\nimport InlineEditorBlockPerson from './InlineEditorBlockPerson.js'\nimport InlineEditorBlockPage from './InlineEditorBlockPage.js'\n// import InlineEditorBlockCode from './InlineEditorBlockCode.js'\n\nimport classes from './InlineEditorBlock.module.css'\n\n// function addIds(array){\n//   if (Array.isArray(array)) {\n//     return array.map(item => {\n//       let new_item = { ...item }\n//       if (!new_item.hasOwnProperty('_id')) {\n//         new_item._id = uuidv4()\n//       }\n//       return new_item\n//     })\n//   }\n//   return array\n// }\n\n// function stripIDs(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\nfunction InlineEditorBlockInbetweenComponent({ type = 'text', ...props }){\n  let component = null\n\n  switch (type) {\n    case 'button':\n      component = <InlineEditorBlockButton {...props} />\n    break;\n    case 'redirect':\n      component = <InlineEditorBlockRedirect {...props} />\n    break;\n    case 'divider':\n      component = <InlineEditorBlockDivider {...props} />\n    break;\n    case 'checkbox':\n      component = <InlineEditorBlockCheckbox {...props} />\n    break;\n    case 'person':\n      component = <InlineEditorBlockPerson {...props} />\n    break;\n    case 'page':\n      component = <InlineEditorBlockPage {...props} />\n    break;\n    // case 'code':\n    //   component = <InlineEditorBlockCode {...props} />\n    // break;\n    default:\n      component = <InlineEditorBlockText {...props} />\n  }\n\n  return component\n}\n\nfunction InlineEditorBlockRaw({\n  fluentByObject,\n  getString,\n  contentConfig = {},\n  className,\n  onChange,\n  reorderHandle,\n  onRemoveRow,\n  actionButton,\n  dataset = {},\n  addRowBefore,\n  addRowAfter,\n  permissions = [],\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n  onRemoveSelf,\n}) {\n  const saveBlock = useSaveBlock()\n\n  // const defaultLocale = getString('default_locale')\n\n  const [block, setBlock] = useState({\n    ...(contentConfig.block || { type: 'text' }),\n    _id: contentConfig.blockId || null,\n  })\n  const properties = block.properties || {}\n  const active = typeof properties.active === 'boolean' ? properties.active : true\n\n  useEffect(() => {\n    if (contentConfig.block) {\n      setBlock(contentConfig.block)\n    }\n  }, [contentConfig.block])\n\n  const saveBlockCallback = useCallback(newBlock => {\n    saveBlock(newBlock)\n      .then(gottenBlock => {\n        setBlock(gottenBlock)\n        if (!block._id || block._id !== gottenBlock._id) {\n          onChange({\n            blockId: gottenBlock._id,\n            block: gottenBlock,\n          })\n        }\n      })\n  }, [block, onChange, saveBlock])\n\n  const changeType = useCallback(newValue => {\n    const newBlock = {\n      ...block,\n      type: newValue,\n    }\n\n    saveBlockCallback(newBlock)\n  }, [ block, saveBlockCallback])\n\n  const saveProperty = useCallback((propertyName, newValue) => {\n    if (typeof propertyName === 'string') {\n      const newProperties = { ...block.properties }\n      if (newValue === null) {\n        delete newProperties[propertyName]\n      } else {\n        newProperties[propertyName] = newValue\n      }\n\n      if (newProperties !== block.properties) {\n        const newBlock = {\n          ...block,\n          properties: newProperties,\n        }\n\n        saveBlockCallback(newBlock)\n      }\n    }\n  }, [ block, saveBlockCallback ])\n\n  // const handleChange = useCallback(newBlock => {\n  //   setBlock(newBlock)\n\n  //   if (onChange) {\n  //     const target = wrapperDiv.current\n  //     target.value = newBlock\n  //     onChange({ target })\n  //   }\n  // }, [setBlock, onChange])\n\n  const handleBlockChange = useCallback(newBlock => {\n    if (JSON.stringify(newBlock) !== JSON.stringify(block)) {\n      saveBlock(newBlock)\n        .then((newBlock) => {\n          setBlock(newBlock)\n          if (!block._id || block._id !== newBlock._id) {\n            onChange({\n              blockId: newBlock._id,\n              block: newBlock,\n            })\n          }\n        })\n    }\n  }, [saveBlock, block, onChange])\n\n  const handleSaveBlock = useCallback((newBlock, callback) => {\n    saveBlock(newBlock)\n      .then(newBlock => {\n        if (callback) {\n          callback(newBlock)\n        }\n      })\n      .catch(console.error)\n  }, [ saveBlock ])\n\n  const onArchiveToggle = useCallback(newArchivedValue => {\n    if (typeof onRemoveSelf === 'function') {\n      onRemoveSelf()\n    }\n  }, [onRemoveSelf])\n\n  return <div\n    className={`${classes.block} ${className}`}\n    {...dataset}\n  >\n\n    <BlockMenu\n      {...{\n        block,\n        setType: changeType,\n        setProperty: saveProperty,\n        onRemoveRow,\n        addRowBefore,\n        addRowAfter,\n      }}\n\n      onArchivedToggle={onArchiveToggle}\n\n      trigger={props => (\n        <div\n          {...props}\n          className={classes.reorderHandle}\n        >\n          {reorderHandle}\n        </div>\n      )}\n    />\n\n    <div className={`${classes.block_input} ${(active ? classes.form_active : classes.form_deactivated)}`}>\n      <InlineEditorBlockInbetweenComponent\n        type={block.type}\n        block={block}\n        onChange={handleBlockChange}\n        onSaveBlock={handleSaveBlock}\n\n        onInputRef={onInputRef}\n        onGoToPrevInput={onGoToPrevInput}\n        onGoToNextInput={onGoToNextInput}\n        onSplitText={onSplitText}\n        onMergeToPrevInput={onMergeToPrevInput}\n        onMergeFromNextInput={onMergeFromNextInput}\n\n        onAddRowAfter={addRowAfter}\n      />\n    </div>\n\n  </div>\n}\n\nconst InlineEditorBlock = withLocalization(InlineEditorBlockRaw)\n\nexport default InlineEditorBlock\n","import { useState, useRef, useEffect, useCallback } from 'react'\n\nimport { v4 as uuidv4 } from 'uuid'\n\nimport {\n  Add as AddIcon,\n} from '@mui/icons-material'\nimport {\n  Tooltip,\n} from '@mui/material'\n\nimport { Localized } from '../../fluent/Localized.js'\nimport InlineEditorBlock from './InlineEditorBlock.js'\nimport useLoadBlocks from '../../hooks/useLoadBlocks.js'\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\nimport useArchiveBlock from '../../hooks/useArchiveBlock.js'\n// import { useTranslatedInputContext } from './TranslatedInput.js'\n\nimport AddMenu from './AddMenu.js'\n\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\nimport DragIndicatorIcon from '@mui/icons-material/DragIndicator'\n\nimport classes from './ContentEditor.module.css'\n\n// function stripTmpIds(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\nfunction addTmpIds(array) {\n  return [...array].map(obj => {\n    const obj_new = { ...obj }\n    obj_new.tmp_id = uuidv4()\n    return obj_new\n  })\n}\n\nfunction getFirstLineStartNode(element){\n  element.normalize()\n\n  const childNodes = element.childNodes\n  if (childNodes.length > 0) {\n    return childNodes[0]\n  }\n\n  return element\n}\n\nfunction getLastLineStartNode(element) {\n  element.normalize()\n\n  const childNodes = [...element.childNodes].reverse()\n  if (childNodes.length > 0) {\n    let lastLineNode = element\n    if (childNodes[0].nodeType === 3) {\n      for (const childNode of childNodes) {\n        if (childNode.nodeType === 3) {\n          lastLineNode = childNode\n        } else if (childNode.nodeType === 1) {\n          break\n        }\n      }\n    } else {\n      if (childNodes.length > 1) {\n        if (childNodes[1].nodeType === 3) {\n          const thisChildNodes = childNodes.slice(1)\n          for (const childNode of thisChildNodes) {\n            if (childNode.nodeType === 3) {\n              lastLineNode = childNode\n            } else if (childNode.nodeType === 1) {\n              break\n            }\n          }\n        }\n      }\n    }\n\n    return lastLineNode\n  }\n\n  return element\n}\n\nfunction moveCursorToOffsetInLine(contentEditableElement, lastLineStartNode, offset = 0) {\n  contentEditableElement.focus()\n\n  // If this function exists... (IE 9+)\n  if (window.getSelection) {\n    const lastLineStartNodeLength = (\n      lastLineStartNode.nodeType === 3\n        ? lastLineStartNode.length\n        : lastLineStartNode.innerText.length\n    )\n\n    if (offset === -1 || offset > lastLineStartNodeLength) {\n      offset = lastLineStartNodeLength\n    }\n\n    const range = document.createRange()\n    range.setStart(lastLineStartNode, 0)\n    range.setEnd(lastLineStartNode, offset)\n    range.collapse(false) // false = collapse to end\n    const sel = window.getSelection()\n    sel.removeAllRanges()\n    sel.addRange(range)\n  }\n}\n\nfunction reorder(list, startIndex, endIndex) {\n  const result = Array.from(list)\n  const [removed] = result.splice(startIndex, 1)\n  result.splice(endIndex, 0, removed)\n\n  return result\n}\n\nfunction ContentEditor({ parentId, defaultValue = [], onChange }) {\n  // const [contentConfigs, setContentConfigs] = useState([])\n  const contentConfigs_Ref = useRef([])\n  const contentConfigs = contentConfigs_Ref.current\n\n  // const [inputRefs, setInputRefs] = useState({})\n  const inputRefs_Ref = useRef({})\n  const inputRefs = inputRefs_Ref.current\n\n  const [updateCounter, setUpdateCounter] = useState(0)\n\n  const loadBlocks = useLoadBlocks()\n  const saveBlock = useSaveBlock()\n  const archiveBlock = useArchiveBlock()\n\n  const [autoFocus, setAutoFocus] = useState(null)\n  useEffect(()=>{\n    if (typeof autoFocus === 'object' && autoFocus !== null) {\n      if (\n        inputRefs.hasOwnProperty(autoFocus.tmp_id)\n      ) {\n        const inputRef = inputRefs[autoFocus.tmp_id]\n        if (\n          typeof inputRef === 'object'\n          && inputRef !== null\n        ) {\n          if (autoFocus.inFirstLine === true) {\n            const firstLineStartNode = getFirstLineStartNode(inputRef.current)\n            moveCursorToOffsetInLine(inputRef.current, firstLineStartNode, autoFocus.positionFromLineStart)\n          } else if (autoFocus.inLastLine === true) {\n            const lastLineStartNode = getLastLineStartNode(inputRef.current)\n            moveCursorToOffsetInLine(inputRef.current, lastLineStartNode, autoFocus.positionFromLineStart)\n          }\n          setAutoFocus(null)\n        }\n      }\n    }\n  }, [\n    autoFocus,\n    setAutoFocus,\n    inputRefs,\n  ])\n\n  useEffect(()=>{\n    async function loadMissingBlocks () {\n      let newContentConfigs = [...addTmpIds(defaultValue)]\n\n      const ids2load = newContentConfigs\n        .filter(contentConfig => !contentConfig.hasOwnProperty('block'))\n        .map(contentConfig => contentConfig.blockId)\n\n      let loadedBlocks = []\n      if (ids2load.length > 0) {\n        loadedBlocks = await loadBlocks({ ids: ids2load })\n      }\n      \n      newContentConfigs = newContentConfigs\n        .map(contentConfig => {\n          if (!contentConfig.hasOwnProperty('block')) {\n            contentConfig.block = loadedBlocks.find(block => block._id === contentConfig.blockId)\n          }\n          return contentConfig\n        })\n\n      contentConfigs_Ref.current = newContentConfigs\n      setUpdateCounter(old => old + 1)\n    }\n\n    if (contentConfigs.length === 0) {\n      if (defaultValue.length > 0) {\n        loadMissingBlocks()\n      }\n    }\n  }, [contentConfigs, defaultValue, loadBlocks, contentConfigs_Ref, setUpdateCounter])\n\n  const saveInputRef = useCallback((keys, inputRef) => {\n    const newInputRefs = {...inputRefs_Ref.current}\n\n    if (\n      !newInputRefs.hasOwnProperty(keys.tmp_id)\n      || newInputRefs[keys.tmp_id] !== inputRef\n    ) {\n      newInputRefs[keys.tmp_id] = inputRef\n      inputRefs_Ref.current = newInputRefs\n    }\n  }, [ inputRefs_Ref ])\n\n  const goToPrevInput = useCallback((keys, { caret }) => {\n    const index = keys.index\n\n    let prevInputRef = null\n    for (let thisIndex = contentConfigs.length-1; thisIndex >= 0; thisIndex--) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (thisIndex < index && inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        prevInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (prevInputRef) {\n      const lastLineStartNode = getLastLineStartNode(prevInputRef.current)\n      moveCursorToOffsetInLine(prevInputRef.current, lastLineStartNode, caret.positionFromLineStart)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const goToNextInput = useCallback((keys, { caret }) => {\n    const index = keys.index\n\n    let nextInputRef = null\n    for (let thisIndex = 0; thisIndex < contentConfigs.length; thisIndex++) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (thisIndex > index && inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        nextInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (nextInputRef) {\n      const firstLineStartNode = getFirstLineStartNode(nextInputRef.current)\n      moveCursorToOffsetInLine(nextInputRef.current, firstLineStartNode, caret.positionFromLineStart)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const focusLastLine = useCallback(() => {\n    let lastInputRef = null\n    for (let thisIndex = contentConfigs.length-1; thisIndex >= 0; thisIndex--) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        lastInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (lastInputRef) {\n      const lastLineStartNode = getLastLineStartNode(lastInputRef.current)\n      moveCursorToOffsetInLine(lastInputRef.current, lastLineStartNode, -1)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const handleRowChange = useCallback((keys, newContentConfig) => {\n    const newContentConfigs = [...contentConfigs]\n    for (const index in newContentConfigs) {\n      const oldContentConfig = newContentConfigs[index]\n      if (oldContentConfig.tmp_id === keys.tmp_id) {\n        newContentConfigs[index] = {\n          ...oldContentConfig,\n          ...newContentConfig,\n        }\n        break\n      }\n    }\n\n    contentConfigs_Ref.current = newContentConfigs\n    onChange(newContentConfigs)\n\n    return new Promise(resolve => {\n      resolve(newContentConfigs)\n    })\n  }, [contentConfigs, contentConfigs_Ref, onChange])\n\n  const addRowByIndex = useCallback((index, offset = 0, newContentConfig) => {\n    if (typeof newContentConfig === 'object') {\n      newContentConfig = {\n        tmp_id: uuidv4(),\n        ...newContentConfig,\n      }\n    } else {\n      newContentConfig = newContentConfig || { tmp_id: uuidv4() }\n    }\n\n    const newBlock = newContentConfig.block || null\n\n    if (\n      newBlock !== null\n      && typeof index === 'number'\n      && !isNaN(index)\n    ) {\n      saveBlock(newBlock)\n        .then(async gottenBlock => {\n          const loadedBlocks = await loadBlocks({ ids: [gottenBlock._id] })\n\n          if (loadedBlocks.length > 0) {\n            const loadedBlock = loadedBlocks[0]\n\n            newContentConfig.block = loadedBlock\n            newContentConfig.blockId = loadedBlock._id\n\n            let new_rows = [...contentConfigs]\n            new_rows.splice(index + offset, 0, newContentConfig)\n            contentConfigs_Ref.current = new_rows\n            onChange(new_rows)\n          }\n        })\n        .catch(console.error)\n    }\n  }, [contentConfigs, contentConfigs_Ref, saveBlock, loadBlocks, onChange])\n\n  const createBlockByType = useCallback(({ type, close }) => {\n    const newBlock = { type }\n\n    if (typeof parentId === 'string' && parentId.length > 0) { // a valid parentId should be 24 char long\n      newBlock.parent = parentId\n    }\n\n    addRowByIndex(0, 0, { block: newBlock })\n\n    if (typeof close === 'function') {\n      close()\n    }\n  }, [addRowByIndex, parentId])\n\n  const onMergeToPrevInput = useCallback(keys => {\n    const {\n      index,\n    } = keys\n\n    const clonedContentConfigs = [...contentConfigs]\n    if (index > 0) {\n      const prev_index = index - 1\n      const prev_contentConfig = clonedContentConfigs[prev_index]\n      const prev_tmp_id = prev_contentConfig.tmp_id\n\n      const this_block = clonedContentConfigs[index].block\n      const prev_block = clonedContentConfigs[prev_index].block\n\n      let prev_text = ''\n      if (prev_block && prev_block.hasOwnProperty('properties')) {\n        prev_text = prev_block.properties.text || ''\n      }\n\n      let this_text = ''\n      if (this_block && this_block.hasOwnProperty('properties')) {\n        this_text = this_block.properties.text || ''\n      }\n\n      const new_prev_block = {\n        ...prev_block,\n        properties: {\n          ...prev_block.properties,\n          text: prev_text + this_text,\n        },\n      }\n\n      const thisRef = inputRefs_Ref.current[prev_tmp_id]\n      const textLength = thisRef.current.textContent.length\n\n      saveBlock(new_prev_block)\n        .then(savedPrevBlock => {\n          const new_tmp_id = uuidv4()\n          handleRowChange({\n            index: prev_index,\n            tmp_id: prev_tmp_id,\n          }, {\n            ...prev_contentConfig,\n            tmp_id: new_tmp_id,\n            blockId: savedPrevBlock._id,\n            block: savedPrevBlock,\n          })\n            .then(newContentConfigs => {\n              const this_block = newContentConfigs[index].block\n              newContentConfigs.splice(index, 1) // delete the block\n\n              archiveBlock({ _id: this_block._id, archive: true })\n                .then(() => {\n                  contentConfigs_Ref.current = newContentConfigs\n                  setAutoFocus({\n                    tmp_id: new_tmp_id,\n                    positionFromLineStart: textLength,\n                    inFirstLine: false,\n                    inLastLine: true,\n                  })\n                  onChange(newContentConfigs)\n                })\n            })\n        })\n        .catch(console.error)\n    } else {\n      // This is the first row. Nothing to merge into.\n    }\n  }, [ contentConfigs, inputRefs_Ref, saveBlock, handleRowChange, archiveBlock, contentConfigs_Ref, setAutoFocus, onChange ])\n\n  const onMergeFromNextInput = useCallback(keys => {\n    const {\n      index,\n      tmp_id,\n    } = keys\n\n    const clonedContentConfigs = [...contentConfigs]\n    if (index < clonedContentConfigs.length - 1) {\n\n      const next_index = index + 1\n\n      const this_old_contentConfig = clonedContentConfigs[index]\n      const this_block = clonedContentConfigs[index].block\n      const next_block = clonedContentConfigs[next_index].block\n\n      let this_text = ''\n      if (this_block && this_block.hasOwnProperty('properties')) {\n        this_text = this_block.properties.text || ''\n      }\n\n      let next_text = ''\n      if (next_block && next_block.hasOwnProperty('properties')) {\n        next_text = next_block.properties.text || ''\n      }\n\n      const new_block = {\n        ...this_block,\n        properties: {\n          ...this_block.properties,\n          text: this_text + next_text,\n        },\n      }\n\n      const thisRef = inputRefs_Ref.current[tmp_id]\n      const textLength = thisRef.current.textContent.length\n\n      saveBlock(new_block)\n        .then(savedBlock => {\n          const new_tmp_id = uuidv4()\n          handleRowChange(keys, {\n            ...this_old_contentConfig,\n            tmp_id: new_tmp_id,\n            blockId: savedBlock._id,\n            block: savedBlock,\n          })\n            .then(newContentConfigs => {\n              const next_block = newContentConfigs[next_index].block\n              newContentConfigs.splice(next_index, 1) // delete the block\n\n              archiveBlock({ _id: next_block._id, archive: true })\n                .then(() => {\n                  contentConfigs_Ref.current = newContentConfigs\n                  setAutoFocus({\n                    tmp_id: new_tmp_id,\n                    positionFromLineStart: textLength,\n                    inFirstLine: false,\n                    inLastLine: true,\n                  })\n                  onChange(newContentConfigs)\n                })\n            })\n        })\n        .catch(console.error)\n\n\n\n\n      // // const firstBlock = rows[index]\n      // // const secondBlock = rows[index + 1]\n\n      // // get current text length (we know the caret is at the end of the text)\n      // const thisRef = inputRefs[tmp_id]\n      // const textLength = thisRef.current.textContent.length\n\n      // // refocus the input at the last caret position\n      // const lastLineStartNode = getLastLineStartNode(thisRef.current)\n      // moveCursorToOffsetInLine(thisRef.current, lastLineStartNode, textLength) // we can't use a text length of -1, as the text length will be changed after the merge\n    } else {\n      // This is the last row. Nothing to merge into.\n    }\n  }, [ contentConfigs, inputRefs_Ref, saveBlock, handleRowChange, archiveBlock, contentConfigs_Ref, setAutoFocus, onChange ])\n\n  const splitText = useCallback((keys, { texts }) => {\n    const {\n      index,\n      tmp_id,\n    } = keys\n\n    const newContentConfigs = [...contentConfigs]\n\n    const block = (newContentConfigs.find(block => block.tmp_id === tmp_id)).block || {}\n\n    const firstBlock = {\n      ...block,\n      properties: {\n        ...block.properties,\n        text: texts[0],\n      },\n    }\n\n    const secondBlock = {\n      ...block,\n      properties: {\n        ...block.properties,\n        text: texts[1],\n      },\n    }\n    delete secondBlock._id\n\n    saveBlock(firstBlock)\n      .then(savedFirstBlock => {\n        saveBlock(secondBlock)\n          .then(savedSecondBlock => {\n            newContentConfigs[index] = {\n              ...newContentConfigs[index],\n              tmp_id: uuidv4(),\n              blockId: savedFirstBlock._id,\n              block: savedFirstBlock,\n            }\n\n            const nextContentConfig = {\n              tmp_id: uuidv4(),\n              blockId: savedSecondBlock._id,\n              block: savedSecondBlock,\n            }\n            newContentConfigs.splice(index + 1, 0, nextContentConfig)\n\n            contentConfigs_Ref.current = newContentConfigs\n            onChange(newContentConfigs)\n            setAutoFocus({\n              tmp_id: nextContentConfig.tmp_id,\n              positionFromLineStart: 0,\n              inFirstLine: true,\n              inLastLine: false,\n            })\n          })\n          .catch(console.error)\n        })\n      .catch(console.error)\n  }, [\n    contentConfigs,\n    saveBlock,\n    contentConfigs_Ref,\n    onChange,\n    setAutoFocus,\n  ])\n\n  const handleRemoveSelf = useCallback(keys => {\n    const {\n      index,\n    } = keys\n\n    const newContentConfigs = [...contentConfigs]\n    newContentConfigs.splice(index, 1) // delete the block\n\n    contentConfigs_Ref.current = newContentConfigs\n\n    onChange(newContentConfigs)\n  }, [ contentConfigs, onChange ])\n\n  function onDragEnd(result) {\n    if (!result.destination) {\n      return\n    }\n\n    if (result.destination.index === result.source.index) {\n      return\n    }\n\n    const newContentConfigs = reorder(\n      contentConfigs,\n      result.source.index,\n      result.destination.index\n    )\n\n    contentConfigs_Ref.current = newContentConfigs\n    onChange(newContentConfigs)\n  }\n\n  const filteredContentConfigs = contentConfigs\n    .filter(Boolean)\n    .filter(contentConfig => contentConfig.tmp_id)\n\n  return <>\n  <div\n    key={updateCounter}\n    style={{\n      position: 'relative',\n      width: '1000px',\n      maxWidth: '100%',\n      margin: 'var(--basis_x8) auto 0 auto',\n    }}\n  >\n    <div>\n      <AddMenu\n        types={[\n          'button',\n          'text',\n          // 'checkbox',\n          // 'code',\n          'divider',\n          'page',\n          'redirect',\n        ]}\n        createBlock={createBlockByType}\n        trigger={triggerProps => \n          <button\n            {...triggerProps}\n            className=\"text hasIcon\"\n            style={{\n              margin: '0 0 var(--basis_x2) 0',\n            }}\n          >\n            <span style={{pointerEvents: 'none'}}>\n              <AddIcon className=\"icon\" />\n              <span style={{marginInlineStart: 'var(--basis_x2)', verticalAlign: 'middle'}}>\n                <Localized id=\"add_content_before\" />\n              </span>\n            </span>\n          </button>\n        }\n      />\n    </div>\n\n    <DragDropContext onDragEnd={onDragEnd}>\n      <Droppable\n        droppableId=\"list\"\n        isDropDisabled={false}\n      >\n        {provided => (\n          <div\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n            className=\"inputBorder\"\n            style={{\n              '--input-box-shadow': 'inset var(--basis_x8) 0 0 0 var(--background), inset var(--basis_x8) 0 0 var(--basis_x0_2) var(--on-background-contrast), inset 0 0 0 var(--basis_x0_2) var(--on-background-contrast)',\n              boxShadow: 'var(--input-box-shadow)',\n              paddingTop: filteredContentConfigs.length > 0 ? 'var(--basis)' : '',\n              paddingRight: 'var(--basis)',\n            }}\n          >\n            {\n              filteredContentConfigs\n              .map(\n                (contentConfig, index) => {\n                  const tmp_id = contentConfig.tmp_id\n                  const keys = {\n                    index,\n                    tmp_id,\n                  }\n\n                  return <Draggable\n                    key={tmp_id}\n                    draggableId={tmp_id}\n                    index={index}\n                    isDragDisabled={false}\n                    disableInteractiveElementBlocking={true}\n                    shouldRespectForcePress={true}\n                  >\n                    {provided => (\n                      <div\n                        ref={provided.innerRef}\n                        {...provided.draggableProps}\n\n                        key={tmp_id}\n                        className={classes.row}\n                      >\n                      <div className={classes.form}>\n                        <InlineEditorBlock\n                          key={tmp_id}\n                          className={classes.item}\n                          dataset={{\n                            'data-index': index,\n                            'data-id': tmp_id,\n                          }}\n                          contentConfig={contentConfig}\n\n                          reorderHandle={\n                            <Tooltip title={<div style={{ textAlign: 'center' }}>\n                              <strong>Drag</strong> to move.<br />\n                              <strong>Click</strong> to open menu.\n                            </div>}>\n                              <button\n                                className={`text ${classes.inlineRowButton} ${classes.dragHandleButton}`}\n                                {...provided.dragHandleProps}\n                              >\n                                <DragIndicatorIcon />\n                              </button>\n                            </Tooltip>\n                          }\n\n                          onRemoveSelf={ () => handleRemoveSelf(keys) }\n                          addRowBefore={ (newValue) => addRowByIndex(index, 0, newValue) }\n                          addRowAfter={ (newValue) => addRowByIndex(index, 1, newValue) }\n\n                          onInputRef={(inputRef) => saveInputRef(keys, inputRef)}\n                          onGoToPrevInput={(attr) => goToPrevInput(keys, attr)}\n                          onGoToNextInput={(attr) => goToNextInput(keys, attr)}\n                          onSplitText={(attr) => splitText(keys, attr)}\n                          onChange={(attr) => handleRowChange(keys, attr)}\n                          onMergeToPrevInput={(attr) => onMergeToPrevInput(keys, attr)}\n                          onMergeFromNextInput={(attr) => onMergeFromNextInput(keys, attr)}\n                          // {...repeater_props}\n                        />\n                      </div>\n                    </div>\n                    )}\n                  </Draggable>\n                }\n              )\n            }\n            {provided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    </DragDropContext>\n  </div>\n\n  <div\n    style={{\n      position: 'relative',\n      height: '50vh',\n      cursor: (filteredContentConfigs.length === 0 ? 'default' : 'text'),\n    }}\n    onClick={filteredContentConfigs.length === 0 ? null : focusLastLine}\n  ></div>\n  </>\n}\n\nexport default ContentEditor\n","import { useState, useCallback } from 'react'\n\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\n\nimport { Helmet } from 'react-helmet'\n\n// import Select from 'react-select'\n\nimport {\n  // TranslateSharp as TranslateIcon,\n  IosShareSharp as ShareIcon,\n  SaveSharp as SaveIcon,\n  MoreHorizSharp as BlockMenuIcon,\n} from '@mui/icons-material'\n\nimport MdiIcon from '@mdi/react'\nimport {\n  mdiTranslate,\n  mdiLockAlert, // mdiLock\n  mdiAccountLockOpen, // mdiAccountGroup\n  mdiEarth, // mdiLockOpen mdiEarth mdiLockOpenVariant\n} from '@mdi/js'\n\nimport classes from './PageEditor.module.css'\n\nimport { Localized, useLocalization } from '../../fluent/Localized.js'\n// import { useTranslatedInputContext, LocalesMenu } from '../edit/TranslatedInput.js'\n\nimport Header from '../Header.js'\nimport BlockMenu from '../edit/BlockMenu.js'\nimport SharingEditor from '../edit/SharingEditor.js'\nimport TranslationEditor from '../edit/TranslationEditor.js'\nimport PermissionsEditor from '../edit/PermissionsEditor.js'\nimport PropertiesEditor from '../edit/PropertiesEditor.js'\nimport ContentEditor from '../edit/ContentEditor.js'\n\n// const custom_react_select_styles = {\n//   menu: (provided, state) => ({\n//     ...provided,\n//     background: 'var(--purple)',\n//   }),\n// }\n// const custom_react_select_theme = theme => ({\n//   ...theme,\n//   borderRadius: 0,\n//   colors: {\n//     ...theme.colors,\n//     primary: 'var(--green)',\n//     primary25: 'var(--purple-dark)',\n//   },\n// })\n\nfunction PageEditor({\n  block,\n  onSaveBlock,\n}) {\n  const { getString } = useLocalization()\n\n  const saveBlock = useSaveBlock()\n\n  // const { currentLocale, setLocales } = useTranslatedInputContext()\n\n  const [ isSharingEditorOpen, setIsSharingEditorOpen ] = useState(false)\n  const openSharingEditor = useCallback(() => setIsSharingEditorOpen(true), [ setIsSharingEditorOpen ])\n  const closeSharingEditor = useCallback(() => setIsSharingEditorOpen(false), [ setIsSharingEditorOpen ])\n\n  const [ isTranslationEditorOpen, setIsTranslationEditorOpen ] = useState(false)\n  const openTranslationEditor = useCallback(() => setIsTranslationEditorOpen(true), [ setIsTranslationEditorOpen ])\n  const closeTranslationEditor = useCallback(() => setIsTranslationEditorOpen(false), [ setIsTranslationEditorOpen ])\n\n  const [ isPermissionsEditorOpen, setIsPermissionsEditorOpen ] = useState(false)\n  const openPermissionsEditor = useCallback(() => setIsPermissionsEditorOpen(true), [ setIsPermissionsEditorOpen ])\n  const closePermissionsEditor = useCallback(() => setIsPermissionsEditorOpen(false), [ setIsPermissionsEditorOpen ])\n\n  // const [block, setBlock] = useState({\n  //   type: defaultType || 'page',\n  //   properties: defaultProperties || {},\n  //   content: defaultContent || [],\n  //   ...defaultBlockRest,\n  // })\n  const type = block.type\n  const properties = block.properties\n  const content = block.content\n  const permissions = block.permissions\n\n  const saveType = useCallback(newType => {\n    if (newType !== block.type) {\n      const newBlock = {\n        ...block,\n        type: newType,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          onSaveBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, onSaveBlock])\n\n  const saveProperties = useCallback(newProperties => {\n    if (newProperties !== block.properties) {\n      const newBlock = {\n        ...block,\n        properties: newProperties,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          onSaveBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, onSaveBlock])\n\n  const saveProperty = useCallback((propertyName, newValue) => {\n    if (\n      typeof propertyName === 'string'\n    ) {\n      const newProperties = { ...properties }\n      if (newValue === null) {\n        delete newProperties[propertyName]\n      } else {\n        newProperties[propertyName] = newValue\n      }\n      \n      saveProperties(newProperties)\n    }\n  }, [properties, saveProperties])\n\n  const saveContent = useCallback(newContent => {\n    if (newContent !== block.content) {\n      const newBlock = {\n        ...block,\n        content: newContent,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          onSaveBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, onSaveBlock])\n\n  const savePermissions = useCallback(newPermissions => {\n    if (newPermissions !== block.permissions) {\n      const newBlock = {\n        ...block,\n        permissions: newPermissions,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          onSaveBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, onSaveBlock])\n\n  const manuallySaveEverything = useCallback(() => {\n    saveBlock(block)\n      .then(gottenBlock => {\n        if (gottenBlock._id !== block._id) {\n          onSaveBlock(gottenBlock)\n        }\n      })\n  }, [saveBlock, block, onSaveBlock])\n\n  // const isFirstRun = useRef(true)\n  // useEffect(() => {\n  //   if (isFirstRun.current) {\n  //     isFirstRun.current = false\n  //     return;\n  //   }\n  //\n  //   if (\n  //     Object.keys(block).length > 0\n  //     && JSON.stringify(initialBlock) !== JSON.stringify(block)\n  //   ) {\n  //   }\n  // }, [isFirstRun, initialBlock, block])\n\n\n\n  // START permissions icon\n  let PermissionsIcon = mdiLockAlert\n  if (\n    !!block\n    && !!block.computed\n    && !!block.computed.inherited_block_permissions\n    && Array.isArray(block.computed.inherited_block_permissions)\n  ) {\n    const inherited_block_permissions_obj = block.computed.inherited_block_permissions\n      .reduce((acc, curr) => {\n        acc[curr.email] = curr.role\n        return acc\n      }, {})\n\n    if (\n      inherited_block_permissions_obj['@public'] === 'viewer'\n      || inherited_block_permissions_obj['@public'] === 'editor'\n      || inherited_block_permissions_obj['@public'] === 'owner'\n    ) {\n      PermissionsIcon = mdiEarth\n    } else if (\n      inherited_block_permissions_obj['@volteuropa.org'] === 'viewer'\n      || inherited_block_permissions_obj['@volteuropa.org'] === 'editor'\n      || inherited_block_permissions_obj['@volteuropa.org'] === 'owner'\n    ) {\n      PermissionsIcon = mdiAccountLockOpen\n    }\n  }\n  // END permissions icon\n\n\n\n  const rightHeaderActions = <div className=\"buttonRow\" style={{ whiteSpace: 'nowrap' }}>\n    {/* <button className=\"text\"><Localized id=\"path_editor_share\"/></button> */}\n\n\n    {/*\n    <LocalesMenu\n      trigger={triggerProps => (\n        <button {...triggerProps} className=\"text hasIcon\">\n          <TranslateIcon className=\"icon\" />\n          <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}>\n            <Localized id=\"path_editor_translate\" />\n            {getString('locale_'+currentLocale)}\n          </span>\n        </button>\n      )}\n    />\n    */}\n\n    {\n      isSharingEditorOpen\n      ? <SharingEditor\n          defaultBlock={block}\n          open={isSharingEditorOpen}\n          onClose={closeSharingEditor}\n          onChange={saveProperties}\n        />\n      : null\n    }\n    <button className=\"text hasIcon\" onClick={openSharingEditor}>\n      <ShareIcon className=\"icon\" />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_share\" /></span>\n    </button>\n\n    {\n      type !== 'divider'\n      ? <>\n        {\n          isTranslationEditorOpen\n          ? <TranslationEditor\n              defaultBlock={block}\n              open={isTranslationEditorOpen}\n              onClose={closeTranslationEditor}\n              onSaveProperty={saveProperty}\n            />\n          : null\n        }\n        <button className=\"text hasIcon\" onClick={openTranslationEditor}>\n          <MdiIcon\n            path={mdiTranslate}\n            className=\"icon\"\n          />\n          <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_translate\" /></span>\n        </button>\n      </>\n      : null\n    }\n\n    {\n      isPermissionsEditorOpen\n      ? <PermissionsEditor\n          defaultPermissions={permissions}\n          open={isPermissionsEditorOpen}\n          onClose={closePermissionsEditor}\n          onChange={savePermissions}\n        />\n      : null\n    }\n    <button className=\"text hasIcon\" onClick={openPermissionsEditor}>\n      <MdiIcon\n        path={PermissionsIcon}\n        className=\"icon\"\n      />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_permissions\" /></span>\n    </button>\n\n    <button className=\"text hasIcon\" onClick={manuallySaveEverything}>\n      <SaveIcon className=\"icon\" />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_publish\" /></span>\n    </button>\n\n    <BlockMenu\n      {...{\n        block,\n        setType: saveType,\n        setProperty: saveProperty,\n      }}\n\n      typeOptions={[\n        'page',\n        'redirect',\n      ]}\n\n      trigger={props => (\n        <button\n          {...props}\n          className=\"default hasIcon\"\n        >\n          <BlockMenuIcon className=\"icon\" />\n        </button>\n      )}\n    />\n  </div>\n\n  const title = block.properties.text || getString('placeholder_main_headline')\n  const helmet_title = ` ${title}`\n\n  return <div key={block._id} className={`hasHeader ${classes.editor} ${typeof type === 'string' && type !== '' ? classes['type_'+type] : ''}`}>\n    <Helmet>\n      <title>{helmet_title}</title>\n      <meta name=\"title\" content={helmet_title} />\n      <meta name=\"og:title\" content={helmet_title} />\n      <meta name=\"twitter:title\" content={helmet_title} />\n\n      <meta name=\"description\" content=\"\" />\n      <meta property=\"og:description\" content=\"\" />\n      <meta name=\"twitter:description\" content=\"\" />\n\n      <meta property=\"og:image\" content=\"\" />\n      <meta name=\"twitter:image\" content=\"\" />\n\n      <meta property=\"twitter:card\" content=\"summary\" />\n    </Helmet>\n    \n    <Header\n      block={block}\n      // title={<a href={`https://volt.link/${slug}`} target=\"_blank\" rel=\"noopener noreferrer\"><span className=\"hideOnSmallScreen\">volt.link</span>/{slug}</a>}\n      title={title}\n      rightActions={rightHeaderActions}\n    />\n\n    <PropertiesEditor\n      type={type}\n      defaultProperties={properties}\n      onChange={saveProperties}\n    />\n\n    <ContentEditor\n      parentId={block._id || null}\n      onChange={saveContent}\n      defaultValue={content}\n    />\n  </div>\n}\n\nexport default PageEditor\n","import { useRef, useState, useEffect, useCallback } from 'react'\n\nimport {\n  useParams,\n} from 'react-router-dom'\n\nimport classes from './Editor.module.css'\n\nimport useLoadBlock from '../hooks/useLoadBlock.js'\nimport useBlockMatchesRoles from '../hooks/useBlockMatchesRoles.js'\n\nimport Header from '../components/Header.js'\nimport { ErrorPage } from '../components/ErrorPages.js'\n\nimport PageEditor from '../components/apps/PageEditor.js'\n\nfunction Editor() {\n  const loadBlock = useLoadBlock()\n\n  const loadedTheBlock = useRef(false)\n  let { id = '' } = useParams()\n\n  const [block, setBlockInternal] = useState({\n    type: 'page',\n    properties: {},\n    content: [],\n  })\n\n  const setBlock = useCallback(newBlock => {\n    setBlockInternal(newBlock)\n  }, [ setBlockInternal ])\n\n  const [ canEdit, setCanEdit ] = useState(null)\n  const blockMatchesRoles = useBlockMatchesRoles()\n  useEffect(() => {\n    blockMatchesRoles(id, ['editor', 'owner'])\n      .then(matchesRoles => {\n        setCanEdit(matchesRoles)\n      })\n      .catch(error => {\n        console.error(error)\n        setCanEdit(false)\n      })\n  }, [ id, blockMatchesRoles, setCanEdit ])\n\n  useEffect(() => {\n    if (\n      canEdit\n      && typeof id === 'string'\n      && id !== ''\n      && (\n        !loadedTheBlock.current\n        || id !== block._id\n      )\n    ) {\n      loadBlock(id)\n        .then(loadedBlock => {\n          loadedTheBlock.current = true\n\n          setBlock(loadedBlock)\n        })\n    }\n  }, [\n    canEdit,\n    id,\n    block,\n    loadBlock,\n    setBlock,\n    // setLocales,\n  ])\n\n  // const isFirstRun = useRef(true)\n  // useEffect(() => {\n  //   if (isFirstRun.current) {\n  //     isFirstRun.current = false\n  //     return;\n  //   }\n  //\n  //   if (\n  //     Object.keys(block).length > 0\n  //     && JSON.stringify(initialBlock) !== JSON.stringify(block)\n  //   ) {\n  //   }\n  // }, [isFirstRun, initialBlock, block])\n\n  if (canEdit === false) {\n    return <div className={classes.editor}>\n      <Header\n        block={null}\n        title=\"Error\"\n        rightActions={null}\n      />\n      <div className={`basis_x1 ${classes.app} ${classes.spine_aligned}`} dir=\"auto\">\n        <main className={`${classes.contentWrapper}`}>\n          <ErrorPage errorName=\"no_access\" />\n        </main>\n      </div>\n    </div>\n  } else if (canEdit === true) {\n    return <PageEditor\n      block={block}\n      onSaveBlock={setBlock}\n    />\n  } else {\n    return null\n  }\n}\n\nexport default Editor\n"],"sourceRoot":""}